<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 12 Correlação e Regressão | Bioestatística aplicada aos ecossistemas agrícolas e naturais</title>
<meta name="author" content="João B. Tolentino Jr.">
<meta name="description" content="Muitos estudos estatísticos analisam a relação entre duas variáveis. As relações estatísticas são tendências gerais, não regras rígidas, e permitem exceções individuais. Por exemplo, embora os...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Capítulo 12 Correlação e Regressão | Bioestatística aplicada aos ecossistemas agrícolas e naturais">
<meta property="og:type" content="book">
<meta property="og:url" content="https://biostat.tolentino.pro.br/correlação-e-regressão.html">
<meta property="og:description" content="Muitos estudos estatísticos analisam a relação entre duas variáveis. As relações estatísticas são tendências gerais, não regras rígidas, e permitem exceções individuais. Por exemplo, embora os...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 12 Correlação e Regressão | Bioestatística aplicada aos ecossistemas agrícolas e naturais">
<meta name="twitter:description" content="Muitos estudos estatísticos analisam a relação entre duas variáveis. As relações estatísticas são tendências gerais, não regras rígidas, e permitem exceções individuais. Por exemplo, embora os...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/_Montserrat-0.4.1/font.css" rel="stylesheet">
<link href="libs/_Signika-0.4.1/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.23/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 1em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="assets/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Bioestatística aplicada aos ecossistemas agrícolas e naturais</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Sumário</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefácio</a></li>
<li class="book-part">O ecossistema R</li>
<li><a class="" href="intro-r.html">Introdução - O ecossistema R</a></li>
<li><a class="" href="procurando-e-pedindo-ajuda-para-o-r.html"><span class="header-section-number">1</span> Procurando (e pedindo) ajuda para o R</a></li>
<li><a class="" href="comeco.html"><span class="header-section-number">2</span> Começando com o R</a></li>
<li><a class="" href="rmarkdown-1.html"><span class="header-section-number">3</span> RMarkdown</a></li>
<li class="book-part">(bio)Estatística</li>
<li><a class="" href="bio.html">Introdução - (bio)Estatística</a></li>
<li><a class="" href="alguns-conceitos-b%C3%A1sicos.html"><span class="header-section-number">4</span> Alguns conceitos básicos</a></li>
<li><a class="" href="graf.html"><span class="header-section-number">5</span> Gráficos estatísticos</a></li>
<li><a class="" href="estbas.html"><span class="header-section-number">6</span> Estatística Básica</a></li>
<li><a class="" href="introdu%C3%A7%C3%A3o-%C3%A0-infer%C3%AAncia.html"><span class="header-section-number">7</span> Introdução à inferência</a></li>
<li><a class="" href="produ%C3%A7%C3%A3o-de-dados.html"><span class="header-section-number">8</span> Produção de dados</a></li>
<li><a class="" href="testes-para-duas-amostras.html"><span class="header-section-number">9</span> Testes para duas amostras</a></li>
<li><a class="" href="anova.html"><span class="header-section-number">10</span> Análise de Variância</a></li>
<li><a class="" href="an%C3%A1lise-de-vari%C3%A2ncia-para-2-fatores.html"><span class="header-section-number">11</span> Análise de Variância para 2 fatores</a></li>
<li><a class="active" href="correla%C3%A7%C3%A3o-e-regress%C3%A3o.html"><span class="header-section-number">12</span> Correlação e Regressão</a></li>
<li><a class="" href="dados-categ%C3%B3ricos.html"><span class="header-section-number">13</span> Dados categóricos</a></li>
<li class="book-part">Apêndices</li>
<li><a class="" href="conjunto-de-dados-do-r.html"><span class="header-section-number">A</span> Conjunto de dados do R</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/joaobtj/biostat_ebook">Código fonte do livro <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><link href="assets/style.css" rel="stylesheet">
<div class="hero-image-container"> 
  <img class="hero-image" src="../image/biostat.png">
</div>
<div id="correlação-e-regressão" class="section level1" number="12">
<h1>
<span class="header-section-number">Capítulo 12</span> Correlação e Regressão<a class="anchor" aria-label="anchor" href="#correla%C3%A7%C3%A3o-e-regress%C3%A3o"><i class="fas fa-link"></i></a>
</h1>
<p>Muitos estudos estatísticos analisam a relação entre duas variáveis. As relações estatísticas são tendências gerais, não regras rígidas, e permitem exceções individuais. Por exemplo, embora os fumantes, em média, morram mais jovens que os não fumantes, algumas pessoas vivem até os 90 anos fumando três maços de cigarros por dia.</p>
<div id="variável-resposta-e-variável-explicativa" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Variável resposta e Variável explicativa<a class="anchor" aria-label="anchor" href="#vari%C3%A1vel-resposta-e-vari%C3%A1vel-explicativa"><i class="fas fa-link"></i></a>
</h2>
<p>Uma variável resposta mede o resultado de um estudo.</p>
<p>Uma variável explicativa esclarece ou influencia as mudanças em uma variável resposta.</p>
<p>Muitas vezes, variáveis explicativas são chamadas de variáveis independentes e variáveis resposta são chamadas de variáveis dependentes.</p>
<ul>
<li>Estudantes voluntários beberam números diferentes de latas de cerveja. Trinta minutos depois, um policial mediu o teor de álcool no sangue dos voluntários. O número de latas consumidas é a variável explicativa, e o percentual de álcool no sangue é a variável resposta.</li>
<li>Uma pesquisa coletou informações sobre altura, idade, gênero e uma longa lista de atributos, com o objetivo de documentar as características da população. Não há variável reposta ou explicativa nesse contexto.</li>
<li>Um pediatra observou os mesmos dados anteriores com foco em idade e gênero, juntamente com outras variáveis, como etnia, para discutir o crescimento de uma criança. Neste caso, idade e gênero são variáveis explicativas, e altura é a variável resposta.</li>
</ul>
<p>Nem sempre fica claro quais são as variáveis explicativa e resposta em um estudo. Pode depender da forma como o estudo foi montado e como as variávveis foram coletadas. Muitas vezes, somente é possível explorar a relação entre as variáveis consideradas.</p>
</div>
<div id="diagrama_dispersao" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> Diagrama de dispersão<a class="anchor" aria-label="anchor" href="#diagrama_dispersao"><i class="fas fa-link"></i></a>
</h2>
<p>A maneira mais eficiente de se mostrar a relação entre duas variáveis quantitativas é por meio de um diagrama de dispersão.</p>
<p>Um diagrama de dispersão mostra a relação entre duas variáveis quantitativas, medidas nos mesmos indivíduos.</p>
<p>Os valores de uma variável aparecem no eixo horizontal, e os valores da outra, no eixo vertical.</p>
<p>Cada indivíduo nos dados aparece como um ponto no gráfico determinado pelos valores de ambas as variáveis para tal indivíduo.</p>
<p>Sempre represente graficamente a variável explicativa, se houver, no eixo horizontal (eixo x) de um diagrama de dispersão.</p>
<div class="example">
<p><span id="exm:dispers" class="example"><strong>Exemplo 12.1  (Diagrama de dispersão) </strong></span>Os peixes-boi são mamíferos aquáticos grandes e herbívoros, encontrados principalmente nos rios e estuários da Flórida. Essa espécie ameaçada sofre com a coabitação com populações humanas, e muitos peixes-boi morrem a cada ano em consequência de colisões com barcos a motor.</p>
<p>O arquivo <a href="data/pboi.xlsx">pboi.xlsx</a> traz o número de barcos a motor resgistrados, entre 1977 e 2008, e sua influência nas mortes de peixes-boi em consequência de colisões.</p>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pboi</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/pboi.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pboi</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">barco</span>, y <span class="op">=</span> <span class="va">morte</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Barcos a motor registrados (x 1000)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mortes por colisão"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="019-reg_files/figure-html/unnamed-chunk-2-1.png" width="672"></div>
<ul>
<li>O “número de barcos registrados” é a variável explicativa.</li>
<li>O “número de mortes de peixes-boi por colisão” é a variável resposta.</li>
<li>O tempo (ano em que os dados foram coletados) não é uma variável relevante aqui (indivíduos).</li>
</ul>
<p>O diagrama acima mostra uma direção nítida: uma subida, da parte de baixo, à esquerda, para a parte de cima, à direita.</p>
<p>Os anos com maior registro de barcos tendem a ter contagem mais alta de mortes de peixes-boi por colisões. Chamamos de associação positiva entre as duas variáveis <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Quando uma variável aumenta e a outra diminui, chamamos de associação negativa.&lt;/p&gt;"><sup>30</sup></a>.</p>
<p>A forma da relação é linear, isto é, o padrão geral segue uma reta, da esquerda para a direita, de baixo para cima.</p>
<p>A intensidade de uma relação em um diagrama de dispersão é determinada pela proximidade com que os pontos seguem uma forma clara. A relação geral é forte.</p>
<p>O número de registros de barcos a motor explica grande parte da variação entre mortes de peixes-boi por colisões. Anos com menos barcos registrados tendem a ter menos mortes de peixes-boi. Para preservar essa espécie ameaçada, a restrição no número de barcos registrados pode ser útil.</p>
<p>No entanto, não consideramos outros fatores, como limites de velocidade, multas ou educação dos pilotos, que poderiam também ser influentes. Nossas conclusões se limitam aos dados disponíveis e ao que eles dizem sobre a relação entre registros de barcos a motor e acidentes com peixes-boi.</p>
</div>
</div>
<div id="correlação" class="section level2" number="12.3">
<h2>
<span class="header-section-number">12.3</span> Correlação<a class="anchor" aria-label="anchor" href="#correla%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h2>
<p>É uma medida de associação linear que elimina a subjetividade da interpretação gráfica. Alguns programas se referem a r como coeficiente de correlação de Pearson, ou r de Pearson.</p>
<div class="inline-figure"><img src="019-reg_files/figure-html/unnamed-chunk-3-1.png" width="672"></div>
<p>Os dois diagramas de dispersão representam exatamente os mesmos dados, porém o gráfico à direita foi desenhado em tamanho menor em um grande espaço. O gráfico à direita parece mostrar uma relação linear mais forte.</p>
<div class="example">
<p><span id="exm:cor" class="example"><strong>Exemplo 12.2  (Correlação) </strong></span>Qual a correlação entre número de barcos e morte de peixe-boi?</p>
<div class="sourceCode" id="cb364"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">pboi</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">morte</span>, <span class="va">barco</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.9501555</code></pre>
<p>A correlação é de 0,95 ou 95%.</p>
</div>
<p>Fatos sobre a correlação:</p>
<p>Não faz distinção entre as variáveis explicativa e resposta.
Não se altera quando mudamos as unidades de medida de x, de y ou de ambas.
A correlação r é sempre um número entre –1 e 1.
Positiva indica uma associação positiva.
Negativa indica uma associação negativa.
Valores próximos de zero indicam uma relação linear muito fraca.
A intensidade da relação linear cresce à medida que r se afasta de zero em direção a -1 ou a 1.</p>
</div>
<div id="regressão" class="section level2" number="12.4">
<h2>
<span class="header-section-number">12.4</span> Regressão<a class="anchor" aria-label="anchor" href="#regress%C3%A3o"><i class="fas fa-link"></i></a>
</h2>
<p>Uma reta de regressão resume a relação entre duas variáveis. Usamos uma reta de regressão para predizer o valor de <em>y</em> para determinado valor de <em>x</em>.</p>
<p>A reta da regressão linear simples tem o seguinte formato:</p>
<p><span class="math display">\[y = a + b \cdot x\]</span></p>
<p>Nessa equação, b é a inclinação, ou seja, a alteração de <em>y</em> quando <em>x</em> aumenta uma unidade. O número <em>a</em> é o intercepto, ou seja, o valor de <em>y</em> quando <em>x</em> = 0.</p>
<div class="example">
<p><span id="exm:reg" class="example"><strong>Exemplo 12.3  (Regressão) </strong></span>Qual é a reta de regressão linear simples que descreve a relação entre o número de barcos e a quantidade de barcos a motor rsgistrados?</p>
<div class="sourceCode" id="cb366"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_pboi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">morte</span> <span class="op">~</span> <span class="va">barco</span>, data <span class="op">=</span> <span class="va">pboi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">reg_pboi</span><span class="op">)</span></span></code></pre></div>
<pre><code>## (Intercept)       barco 
##  -41.204687    0.126052</code></pre>
<p><span class="math display">\[
morte = -41.2047 + 0.1261 \cdot barcos
\]</span></p>
<p>Cuidado com a extrapolação! O que aconteceria se tivéssemos 0 (zero) barcos registrados?</p>
<p>Uma forma muito comum de representar a regressão é por meio de uma reta ajustada no diagrama de dispersão, junto com a equação ajustada e o coeficiente de detemrinação ajustado (R<sup>2</sup><sub>adj</sub><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Pode ser entendido como um coeficiente de qualidade do ajuste.&lt;/p&gt;"><sup>31</sup></a>)</p>
<div class="sourceCode" id="cb368"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pboi</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">barco</span>, y <span class="op">=</span> <span class="va">morte</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Barcos a motor registrados (x 1000)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mortes por colisão"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggpmisc</span><span class="fu">::</span><span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_poly_eq.html">stat_poly_eq</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"atop("</span>, <span class="va">..eq.label..</span>, <span class="st">","</span>, <span class="va">..adj.rr.label..</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure">
<img src="019-reg_files/figure-html/unnamed-chunk-6-1.png" width="672">
.</div>
</div>
</div>
<div id="inferência-para-regressão" class="section level2" number="12.5">
<h2>
<span class="header-section-number">12.5</span> Inferência para Regressão<a class="anchor" aria-label="anchor" href="#infer%C3%AAncia-para-regress%C3%A3o"><i class="fas fa-link"></i></a>
</h2>
<p>O estudo da inferência para regressão pode responder a algumas questões:</p>
<ul>
<li><p>Há realmente uma relação entre <em>x</em> e <em>y</em> na população ou pode ser que o padrão que vemos no diagrama de dispersão tenha surgido apenas pelo acaso?</p></li>
<li><p>Qual é a inclinação (taxa de variação) que relaciona <em>y</em> com <em>x</em> na população, incluindo a margem de erro para nossa estimativa da inclinação?</p></li>
<li><p>Se usarmos a reta de mínimos quadrados para predizer <em>y</em> para dado valor de <em>x</em>, quão precisa será nossa predição (novamente, com margem de erro)?</p></li>
</ul>
<p>A reta de regressão para a população assume o seguinte formato:</p>
<p><span class="math display">\[y = \alpha + \beta \cdot x\]</span></p>
<p>A inferencia testa as hipóteses</p>
<ul>
<li>H<sub>0</sub>: β = 0</li>
<li>H<sub>1</sub>: β ≠ 0</li>
</ul>
<p>Uma reta de regressão com inclinação zero é horizontal.</p>
<div class="example">
<p><span id="exm:reginfer" class="example"><strong>Exemplo 12.4  (Inferência para Regressão) </strong></span>.</p>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">reg_pboi</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = morte ~ barco, data = pboi)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -15.2507  -5.7731   0.2498   4.3090  18.5815 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -41.204687   5.679767  -7.255 4.47e-08 ***
## barco         0.126052   0.007552  16.692  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 7.864 on 30 degrees of freedom
## Multiple R-squared:  0.9028, Adjusted R-squared:  0.8996 
## F-statistic: 278.6 on 1 and 30 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Há evidência muito forte de que as mortes de peixe-boi aumentam à medida que o número de barcos aumenta.</p>
</div>
</div>
<div id="inferência-sobre-predição" class="section level2" number="12.6">
<h2>
<span class="header-section-number">12.6</span> Inferência sobre predição<a class="anchor" aria-label="anchor" href="#infer%C3%AAncia-sobre-predi%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h2>
<p>Outro contexto para inferência na regressão é quando desejamos não simplesmente uma predição, mas uma com margem de erro que descreva quão precisa, provavelmente, a predição é.</p>
<div class="example">
<p><span id="exm:pred" class="example"><strong>Exemplo 12.5  (Inferência sobre predição) </strong></span>Dezesseis estudantes voluntários consumiram um número de latas de cerveja aleatoriamente designado. Trinta minutos depois, um oficial de polícia mediu o teor alcoólico no sangue (TAS) deles, em gramas de álcool por decilitro de sangue <a href="data/cerveja.xlsx">cerveja.xlsx</a>. O limite legal para direção é TAS 0,08. Desejamos predizer o TAS de uma pessoa usando apenas a informação de que bebeu cinco cervejas.</p>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cerv</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/cerveja.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">reg_cerv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">TAS</span><span class="op">~</span><span class="va">numero</span>, data<span class="op">=</span><span class="va">cerv</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">reg_cerv</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = TAS ~ numero, data = cerv)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.027118 -0.017350  0.001773  0.008623  0.041027 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.012701   0.012638  -1.005    0.332    
## numero       0.017964   0.002402   7.480 2.97e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.02044 on 14 degrees of freedom
## Multiple R-squared:  0.7998, Adjusted R-squared:  0.7855 
## F-statistic: 55.94 on 1 and 14 DF,  p-value: 2.969e-06</code></pre>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">cerv</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">numero</span>, y <span class="op">=</span> <span class="va">TAS</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"gold2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Número de cervejas"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"TAS (g/dL)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggpmisc</span><span class="fu">::</span><span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_poly_eq.html">stat_poly_eq</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"atop("</span>, <span class="va">..eq.label..</span>, <span class="st">","</span>, <span class="va">..adj.rr.label..</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="019-reg_files/figure-html/unnamed-chunk-8-1.png" width="672"></div>
<div class="sourceCode" id="cb374"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#intervalo de confiança dos parâmetros</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">reg_cerv</span><span class="op">)</span></span></code></pre></div>
<pre><code>##                   2.5 %     97.5 %
## (Intercept) -0.03980535 0.01440414
## numero       0.01281262 0.02311490</code></pre>
<div class="sourceCode" id="cb376"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#predição para 5 cervejas</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">reg_cerv</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>numero<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, interval<span class="op">=</span><span class="st">"predict"</span><span class="op">)</span> </span></code></pre></div>
<pre><code>##          fit        lwr       upr
## 1 0.07711821 0.03191712 0.1223193</code></pre>
</div>
<p>Conclusão: Estamos 95% confiantes de que o TAS, depois de beber cinco cervejas, está entre 0,032 e 0,122.</p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="an%C3%A1lise-de-vari%C3%A2ncia-para-2-fatores.html"><span class="header-section-number">11</span> Análise de Variância para 2 fatores</a></div>
<div class="next"><a href="dados-categ%C3%B3ricos.html"><span class="header-section-number">13</span> Dados categóricos</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>Nesta página</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#correla%C3%A7%C3%A3o-e-regress%C3%A3o"><span class="header-section-number">12</span> Correlação e Regressão</a></li>
<li><a class="nav-link" href="#vari%C3%A1vel-resposta-e-vari%C3%A1vel-explicativa"><span class="header-section-number">12.1</span> Variável resposta e Variável explicativa</a></li>
<li><a class="nav-link" href="#diagrama_dispersao"><span class="header-section-number">12.2</span> Diagrama de dispersão</a></li>
<li><a class="nav-link" href="#correla%C3%A7%C3%A3o"><span class="header-section-number">12.3</span> Correlação</a></li>
<li><a class="nav-link" href="#regress%C3%A3o"><span class="header-section-number">12.4</span> Regressão</a></li>
<li><a class="nav-link" href="#infer%C3%AAncia-para-regress%C3%A3o"><span class="header-section-number">12.5</span> Inferência para Regressão</a></li>
<li><a class="nav-link" href="#infer%C3%AAncia-sobre-predi%C3%A7%C3%A3o"><span class="header-section-number">12.6</span> Inferência sobre predição</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/joaobtj/biostat_ebook/blob/main/019-reg.Rmd">Código fonte desta página<i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/joaobtj/biostat_ebook/edit/main/019-reg.Rmd">Editar esta página <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Bioestatística aplicada aos ecossistemas agrícolas e naturais</strong>" foi escrito por João B. Tolentino Jr.. Última atualização em 2023-03-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
