[{"path":"index.html","id":"prefácio","chapter":"Prefácio","heading":"Prefácio","text":"Este é um livro utilizado como texto-base para disciplina de Bioestatística Programa de Pós-Graduação em Ecossistemas Agrícolas e Naturais da Universidade Federal de Santa Catarina (UFSC) Campus de Curitibanos.Este material está em elaboração, sujeito alterações!","code":""},{"path":"index.html","id":"sessão","chapter":"Prefácio","heading":"Sessão","text":"version book built R version 4.2.3 (2023-03-15) following packages:","code":""},{"path":"intro-r.html","id":"intro-r","chapter":"Introdução - O ecossistema R","heading":"Introdução - O ecossistema R","text":"O R (www.r-project.org) é uma linguagem de programação open-source, distribuído sob licença GNU, e multiplataforma, disponível para Windows, MacOS e algumas distribuições Linux. Embora esteja se tornando cada vez mais de uso geral, ele foi originalmente concebido como uma linguagem de programação estatística. Dessa forma, além de análises estatísticas, é capaz de produzir representações gráficas de altíssima qualidade, além de relatórios.Foi criado por Ross Ihaka e Robert Gentleman1 na Universidade de Auckland, Nova Zelândia. Atualmente, é desenvolvido pela R Foundation.É amplamente utilizado pelas grandes empresas, órgãos governamentais e, claro, na pesquisa acadêmica.popularidade R nas ciências tem sido demonstrada por diversos estudos, como o de LAI et al. (2019), em que os autores analisaram mais de 60 mil artigos publicados nos principais periódicos da área de Ecologia e observaram um aumento linear uso R como ferramenta principal para análise de dados.","code":""},{"path":"intro-r.html","id":"pacotes-do-r","chapter":"Introdução - O ecossistema R","heading":"Pacotes do R","text":"O R conta com uma comunidade grande e ativa (useR!) que está sempre contribuindo com melhoria programa por meio desenvolvimento de pacotes que estendem funções originais da linguagem R. Atualmente, 2 o site CRAN (Comprehensive R Archive Network) conta com mais de 18 mil3 pacotes para o R.Os pacotes disponíveis CRAN são facilmente instalados por meio de funções disponiveis próprio R. Também há possibilidade de instalar pacotes diretamente GitHub, local em que muitos dos desenvolvedores de pacotes open-source hospedam seus trabalhos.","code":""},{"path":"intro-r.html","id":"rstudio","chapter":"Introdução - O ecossistema R","heading":"RStudio","text":"O RStudio é um ambiente de desenvolvimento integrado - IDE4 com versão open-source e comercial.Foi desenvolvido para aumentar produtividade dos usuários. Inclui um console, um editor com destaque visual com suporte execução direta código, e ferramentas para manejar arquivos, plotagens, histórico, entre outros.","code":""},{"path":"intro-r.html","id":"rcloud","chapter":"Introdução - O ecossistema R","heading":"RStudio Cloud","text":"É uma versão RStudio que pode ser acessado via navegador, de modo que nada precisa ser instalado na máquina localmente.Além de poder utilizar todas funcionalidades R e RStudio, com o RStudio Cloud é mais fácil compartilhar os projetos com sua equipe.Para começar utilizar, basta criar uma conta site rstudio.cloud. Existe uma conta gratuita que pode ser suficiente para usuários ocasionais. Para quem necessitar, existem também planos pagos.","code":""},{"path":"intro-r.html","id":"tidyverse","chapter":"Introdução - O ecossistema R","heading":"Tidyverse","text":"O universo Tidyverse é uma coleção de pacotes para o R elaborados para ciência dos dados (data science). Todos os pacotes compartilham uma filosofia, gramática e estrutura de dados. funções facilitam comunicação entre humanos e máquina em comparação com funções básicas R.Para instalar todos os pacotes tidyverse:Entre os principais pacotes tidyverse estão:ggplot2: criar gráficos de altíssima qualidade;dplyr: manipulação de dados;tidyr: organização de dados;readr: leitura de arquivos externos, como csv;purrr: programação funcional, permite substituir os loops convencionais;tibble: reinterpretação quadro de dados (data-frame) original;stringr: trabalhar com textos (strings);forcats: trabalhar com fatores (factor).Existem ainda muitos outros pacotes que podem ser consultados aqui: www.tidyverse.org/packages","code":"\ninstall.packages(\"tidyverse\")"},{"path":"intro-r.html","id":"rmarkdown","chapter":"Introdução - O ecossistema R","heading":"RMarkdown","text":"O Markdown é uma linguagem de marcação em texto puro (plain text), em que são utilizadas marcações (muito sutis) para títulos, links e formatações em geral. Seu resultado é bastante legível mesmo sem processamento, diferente de outras linguagens, como HTML ou Latex que requerem muitas tags para formatar o texto.Uma extensão Markdown original é linguagem RMarkdown. Esta é uma poderosa ferramenta que permite combinar análises e os relatórios em um mesmo documento, pois permite incluir códigos em R ao longo documento.De modo geral, o pacote knitr executa os códigos em R e converte o documento de RMarkdown para Markdown. O pacote pandoc renderiza o documento Markdown para o formato desejado, que pode ser HTML, PDF, Word, entre muitos outros.\nMais informações podem ser encontradas em: R Markdown: Definitive Guide e R Markdown Cookbook","code":""},{"path":"procurando-e-pedindo-ajuda-para-o-r.html","id":"procurando-e-pedindo-ajuda-para-o-r","chapter":"Capítulo 1 Procurando (e pedindo) ajuda para o R","heading":"Capítulo 1 Procurando (e pedindo) ajuda para o R","text":"Antes de pedir ajuda, é sempre uma boa prática estudar para tentar resolver por si mesmo. grande maioria dos pacotes e funções R possuem uma boa documentação com exemplos de utilização. Também há diversos fóruns na web especializados com respostas para perguntas mais frequente e sites com tutoriais detalhados.Infelizmente, muitos dos textos de ajuda estão na língua inglesa. Aproveite esta chance para treinar e melhorar sua leitura em inglês.","code":""},{"path":"procurando-e-pedindo-ajuda-para-o-r.html","id":"as-funções-help-e","chapter":"Capítulo 1 Procurando (e pedindo) ajuda para o R","heading":"1.1 As funções help e ?","text":"funções help e ? fornecem acesso à documentação próprio R e são equivalentes entre si.Experimente digitar ?sum para ver documentação desta função:\nFigura 1.1: Ajuda da função sum\nNa documentação, é usual haver uma parte com exemplos de uso da função. Estes exemplos podem ser executados com função example:","code":"\nexample(sum) ## \n## sum> ## Pass a vector to sum, and it will add the elements together.\n## sum> sum(1:5)\n## [1] 15\n## \n## sum> ## Pass several numbers to sum, and it also adds the elements.\n## sum> sum(1, 2, 3, 4, 5)\n## [1] 15\n## \n## sum> ## In fact, you can pass vectors into several arguments, and everything gets added.\n## sum> sum(1:2, 3:5)\n## [1] 15\n## \n## sum> ## If there are missing values, the sum is unknown, i.e., also missing, ....\n## sum> sum(1:5, NA)\n## [1] NA\n## \n## sum> ## ... unless  we exclude missing values explicitly:\n## sum> sum(1:5, NA, na.rm = TRUE)\n## [1] 15"},{"path":"procurando-e-pedindo-ajuda-para-o-r.html","id":"stack-overflow","chapter":"Capítulo 1 Procurando (e pedindo) ajuda para o R","heading":"1.2 Stack Overflow","text":"O stackoverflow.com é um site bem organizado especializado na discussão de assuntos relativos à programação. Tópicos marcados com tag “r” chegam mais de 440 mil 5. Para acessar todos os tópicos com tag “r”, acesse stackoverflow.com/questions/tagged/r.Este site tem vantagem de ser bem fácil de fazer buscas. Tente digitar, na caixa de buscas, seguinte expressão: [r] logistic regression fit6\nFigura 1.2: Busca site (stackoverflow.com)[(https://stackoverflow.com]\n","code":""},{"path":"procurando-e-pedindo-ajuda-para-o-r.html","id":"ajuda-professor","chapter":"Capítulo 1 Procurando (e pedindo) ajuda para o R","heading":"1.3 Pedir ajuda ao seu professor","text":"Antes de tudo, vou mostrar um exemplo de como não pedir ajuda ao professor (Figura 1.3:\nFigura 1.3: É difícil ajudar com uma foto da tela com baixa qualidade\nÉ muito difícil conseguir ajudar baseado apenas em uma foto da tela, ainda mais de baixa qualidade e difícil de ler/entender.7Formular uma boa pergunta é 90% desafio e, muitas vezes, o processo de formular pergunta já fornece própria resposta.Para conseguir ajuda mais rápida e com maior chance de ser adequadamente respondida, siga alguma destas recomendações:Compacte8 e compartilhe todo o diretório seu projeto;Compartilhe seu projeto RStudio Cloud;Utilize o pacote reprex (Seção 1.4).","code":""},{"path":"procurando-e-pedindo-ajuda-para-o-r.html","id":"reprex","chapter":"Capítulo 1 Procurando (e pedindo) ajuda para o R","heading":"1.4 O pacote reprex","text":"Reprex é sigla para reproducible example, ou exemplo reproduzível. O código que você deseja compartilhar deve ser renderizado dentro da função reprex::reprex, como código completo dentro de chaves { }.Esta função cria um arquivo renderizado com o exemplo e também envia o resultado direto para área de transferência para poder ser colado com o Ctrl + V.O resultado da função acima pode ser visto abaixo:","code":"\nreprex::reprex({\n  y <- c(1,2,3,4,\"a\")\n  mean(y)\n})\ny <- c(1,2,3,4,\"a\")\nmean(y)\n#> Warning in mean.default(y): argumento não é numérico nem lógico: retornando NA\n#> [1] NA"},{"path":"comeco.html","id":"comeco","chapter":"Capítulo 2 Começando com o R","heading":"Capítulo 2 Começando com o R","text":"Neste capítulo, vamos iniciar com o uso R e RStudio.","code":""},{"path":"comeco.html","id":"a-interface-do-rstudio","chapter":"Capítulo 2 Começando com o R","heading":"2.1 A interface do RStudio","text":"O RStudio possui uma interface simples mas bastante funcional para trabalhar com códigos R.São quatro janelas principais como pode ser visto na Figura 2.1.\nFigura 2.1: Interface RStudio\nSource (Editor) (canto superior esquerdo): local para editar scripts, que são sequências de comandos que podem ser salvos e utilizados repetidamente. Os comandos desta janela são executados clicando botão Run ou pelo atalho teclado Ctrl+Enter. Caso o editor não esteja aparecendo, clique em File -> New File -> R Script, ou pelo atalho Ctrl+Shift+NSource (Editor) (canto superior esquerdo): local para editar scripts, que são sequências de comandos que podem ser salvos e utilizados repetidamente. Os comandos desta janela são executados clicando botão Run ou pelo atalho teclado Ctrl+Enter. Caso o editor não esteja aparecendo, clique em File -> New File -> R Script, ou pelo atalho Ctrl+Shift+NConsole (canto inferior esquerdo): local para digitar e executar os comandos, assim como obter o resultado destes. Também mostra o resutado dos comando executados partir editor.Console (canto inferior esquerdo): local para digitar e executar os comandos, assim como obter o resultado destes. Também mostra o resutado dos comando executados partir editor.Environment (Ambiente) (canto superior direito): local que mostra variáveis definidas, entre outros.Environment (Ambiente) (canto superior direito): local que mostra variáveis definidas, entre outros.Files/Plots/Packages/Help/Viewer (canto inferior direito): local multiuso com várias abas, que mostra e configura várias opções, como arquivos, gráficos, pacotes, ajuda e visualização.Files/Plots/Packages/Help/Viewer (canto inferior direito): local multiuso com várias abas, que mostra e configura várias opções, como arquivos, gráficos, pacotes, ajuda e visualização.","code":""},{"path":"comeco.html","id":"criar-um-projeto-no-rstudio","chapter":"Capítulo 2 Começando com o R","heading":"2.2 Criar um projeto no RStudio","text":"Um projeto RStudio mantem todos os arquivos relevantes para análise, como banco de dados, scripts, resultados e figuras. É uma excelente maneira de evitar ter de lidar com caminhos e diretórios.Para começar um novo projeto, clique em File -> New Project e siga os passos nas janelas conforme aparecerem:Dê um bom nome para seu novo projeto e cuide local em que este será salvo.","code":""},{"path":"comeco.html","id":"primeiros-códigos","chapter":"Capítulo 2 Começando com o R","heading":"2.3 Primeiros códigos","text":"Após o projeto criado, vamos digitar os primeiros códigos na janela Script. Tente digitar o seguinte:Em seguida, posicione o cursor na linha que acabou de digitar, aperte o botao Run ou Ctrl + Enter e veja o resultado.Esta foi uma operação muito simples, então vamos ver alguns códigos mais interessantes.Para criar um objeto e atribuir um valor ele, primeiro precisamos dar um nome9 ao objeto, seguido símbolo de atribuição <- (atalho: Alt + - ) 10 e valor que desejamos atribuir ao objeto:Neste exemplo, o objeto denominado xrecebeu o valor 10. Notem que ao executar este comando, o objeto recém criado aparece na janela Environment, confirmando criação objeto.Este exemplo também mostrou como usar um comentário, que é um texto não interpretado pelo programa. Os comentários são bastante úteis para explicar linhas de código. Os comentários são escritos após o símbolo #. Para comentar uma ou várias linhas, selecione o texto e aperte Ctrl+Shift+C.Para verificar o valor que está atribuído um objeto, basta digitar o nome objeto11:Um objeto pode ter seu valor modificado ou copiado com uma nova atribuição:Observe que ordem de execução dos comandos é importante resultado.Um dos objetos mais útil na programação em R é o vetor, que pode ser entendido como uma série de valores armazenada em um objeto. Para criar um vetor, utilizamos função c():função str nos mostra estrutura vetor:indicando que o objeto primos6 é um vetor numérico (num).Uma parte vetor pode ser extraída como uso de colchetes [ ]:operações com vetores são aplicadas todos os elementos dele:Calcular média dos valores deste vetor com função mean:Muitas funções são disponibilizadas em pacotes. Para acessar uma função de um pacote usamos sintaxe pacote::função. Por exemplo, para acessar funções first e last pacote dplyr:Alternativamente, é possível carregar o pacote com função library e depois usar funções diretamente:Para criar uma gráfico, podemos usar várias das funções base R para esse fim. Neste exemplo, função hist cria um gráfico tipo histograma para um conjunto de 10.000 valores gerados aleatoriamente pela função rnorm.Na seção 5 veremos como utilizar o pacote ggplot2 para criar gráficos mais elaborados.","code":"\n1 + 1\n1 + 1## [1] 2\nx <- 10 # leia-se: x recebe o valor 10\nx## [1] 10\ny <- x\nx <- x * 2\nz <- x + y\n\ny## [1] 10\nx## [1] 20\nz## [1] 30\nprimos6 <- c(2, 3, 5, 7, 11, 13)\nprimos6## [1]  2  3  5  7 11 13\nstr(primos6)##  num [1:6] 2 3 5 7 11 13\nprimos6[3] # acessa o terceiro elemento do vetor## [1] 5\nprimos6[4:6] # acessa do 4° ao 6° elemento do vetor## [1]  7 11 13\nprimos6^2## [1]   4   9  25  49 121 169\nmean(primos6)## [1] 6.833333\ndplyr::first(primos6)## [1] 2\ndplyr::last(primos6)## [1] 13\nlibrary(dplyr)## \n## Attaching package: 'dplyr'## The following objects are masked from 'package:stats':\n## \n##     filter, lag## The following objects are masked from 'package:base':\n## \n##     intersect, setdiff, setequal, union\nfirst(primos6)## [1] 2\nlast(primos6)## [1] 13\nr <- rnorm(10000)\nhist(r)"},{"path":"comeco.html","id":"criar-uma-função-no-r","chapter":"Capítulo 2 Começando com o R","heading":"2.4 Criar uma função no R","text":"Funções são usadas para dividir o código em partes mais simples, mas fáceis de manter e de entender. funções também são facilmente reutilizadas.Para criar uma função R, sintaxe é seguinte:Como exemplo, vamos criar uma função que simula o lançamento dado: dado6Esta função retorna n valores entre 1 e 6 com substituição.Para utilizar função recém criada, chamamos ela pelo nome e passamos um valor para os argumentos:","code":"\nnome_funcao <- function (argumentos) {\ndeclaração\n}\ndado6 <- function(n) {\n  sample(1:6, size = n, replace = TRUE)\n}\ndado6(n = 1)## [1] 1\ndado6(n = 3)## [1] 4 3 2"},{"path":"comeco.html","id":"data-frame","chapter":"Capítulo 2 Começando com o R","heading":"2.5 Data-frame","text":"O data frame é uma estrutura bidimensional em que cada componente forma uma coluna e o conteúdo de cada componente forma linhas. Em um data frame, é importante que todas colunas tenham o mesmo commprimento, de modo que estrutura de dados resulte em um formato retangular. Também podemos imaginá-lo como um agrupamento de vetores de mesmo tamanho.Para criá-lo, usamos função data.frameIdem ao anterior, mas com os vetores sendo criado anteriormente e separadamenteO pacote tibble foi criado como uma atualização12 data-frame, e pode ser utilizado de maneira similar:O data-frame é o formato adequado para armazenar os dados formato Tidy Data, junto com o tibble (seção 2.8)","code":"\ndf <- data.frame(\n  x = c(\"a\", \"b\", \"c\"),\n  y = c(16, 32, 64)\n)\ndf##   x  y\n## 1 a 16\n## 2 b 32\n## 3 c 64\nx <- c(\"a\", \"b\", \"c\")\ny <- c(16, 32, 64)\ndf <- data.frame(x, y)\ndf##   x  y\n## 1 a 16\n## 2 b 32\n## 3 c 64\ntb <- tibble::tibble(\n  x = c(\"a\", \"b\", \"c\"),\n  y = c(16, 32, 64)\n)\ntb## # A tibble: 3 × 2\n##   x         y\n##   <chr> <dbl>\n## 1 a        16\n## 2 b        32\n## 3 c        64"},{"path":"comeco.html","id":"data-frames-nativos-no-r","chapter":"Capítulo 2 Começando com o R","heading":"2.5.1 Data-frames nativos no R","text":"Existe uma grande quantidade de data-frames pré instalados R que não necessitam de importação. Alguns dos nossos exemplos irão usar alguns destes data-frames, por exemplo, o data-frame iris, que contém medidas, em centímetros, comprimento e largura das pétalas e sépalas de três espécies de plantas: Iris setosa, . versicolor e . virginica.","code":""},{"path":"comeco.html","id":"importando-dados-para-o-r","chapter":"Capítulo 2 Começando com o R","heading":"2.6 Importando dados para o R","text":"É muito comum que os dados que utilizaremos em nossas análises estejam armazenadas em fontes externas ao R, como arquivos de texto (*.csv, *.tsv, *.txt), planilhas (*.xlsx, *.ods) ou mesmo grandes bases de dados da internet. importação consiste na leitura destas fontes para um data-frame R.Apesar de existirem vários pacotes e funções para importação de arquivos, vamos apresentar aqueles que fazem parte tidyverse","code":""},{"path":"comeco.html","id":"importar-arquivos-.csv","chapter":"Capítulo 2 Começando com o R","heading":"2.6.1 Importar arquivos .csv","text":"Os arquivos *.csv (comma-separated values) estão entre os mais populares para distribuição de dados. É um arquivo de texto, cujos valores são delimitador por vírgula.O pacote readr possui função read_csv para importação destes arquivos, cujo delimitador entre valores é vírgula e o separador de decimal é o ponto. Outra função semelhante, read_csv2 importa arquivos .csv cujo delimitador entre valores é o ponto e vírgula e o separador de decimal é vírgula13, mais comum em alguns países como o Brasil.O arquivo cbs_jul19.csv (Figura 2.2) contém temperaturas mínimas e máximas diárias para cidade de Curitibanos-SC registradas nos primeiros 15 dias mês de julho de 2019.\nFigura 2.2: Arquivo *.csv cujo delimitador entre valores é vírgula e o separador de decimal é o ponto.\nOs mesmos dados, mas em um arquivo (cbs2_jul19.csv - Figura 2.3) cujo delimitador de valores é o ponto e vírgula e o separador de decimal é vírgula:\nFigura 2.3: Arquivo *.csv cujo delimitador entre valores é o ponto e vírgula e o separador de decimal é vírgula\nimportação com função read_csv é feita como exemplo abaixo:E com função csv2:","code":"\ntemperaturas <- readr::read_csv(\"data/cbs_jul19.csv\")## Rows: 14 Columns: 3\n## ── Column specification ────────────────────────────────────────────────────────\n## Delimiter: \",\"\n## dbl  (2): temp_min, temp_max\n## date (1): data\n## \n## ℹ Use `spec()` to retrieve the full column specification for this data.\n## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\ntemperaturas## # A tibble: 14 × 3\n##    data       temp_min temp_max\n##    <date>        <dbl>    <dbl>\n##  1 2019-07-01     10.7     17.1\n##  2 2019-07-02     11       15  \n##  3 2019-07-03      5.9     14.8\n##  4 2019-07-04     -0.3     12.1\n##  5 2019-07-05     -0.8      7.1\n##  6 2019-07-06     -3.3      8.6\n##  7 2019-07-07     -4.4     13.6\n##  8 2019-07-08      2.1     19.2\n##  9 2019-07-09      0       22.5\n## 10 2019-07-10      2       19.5\n## 11 2019-07-11      4.3     21.4\n## 12 2019-07-12      8.7     23.3\n## 13 2019-07-13     12.9     23.1\n## 14 2019-07-14     13       17.4\ntemperaturas <- readr::read_csv2(\"data/cbs2_jul19.csv\")## ℹ Using \"','\" as decimal and \"'.'\" as grouping mark. Use `read_delim()` for more control.## Rows: 14 Columns: 3\n## ── Column specification ────────────────────────────────────────────────────────\n## Delimiter: \";\"\n## dbl  (2): temp_min, temp_max\n## date (1): data\n## \n## ℹ Use `spec()` to retrieve the full column specification for this data.\n## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\ntemperaturas## # A tibble: 14 × 3\n##    data       temp_min temp_max\n##    <date>        <dbl>    <dbl>\n##  1 2019-07-01     10.7     17.1\n##  2 2019-07-02     11       15  \n##  3 2019-07-03      5.9     14.8\n##  4 2019-07-04     -0.3     12.1\n##  5 2019-07-05     -0.8      7.1\n##  6 2019-07-06     -3.3      8.6\n##  7 2019-07-07     -4.4     13.6\n##  8 2019-07-08      2.1     19.2\n##  9 2019-07-09      0       22.5\n## 10 2019-07-10      2       19.5\n## 11 2019-07-11      4.3     21.4\n## 12 2019-07-12      8.7     23.3\n## 13 2019-07-13     12.9     23.1\n## 14 2019-07-14     13       17.4"},{"path":"comeco.html","id":"importando-arquivos-do-excel","chapter":"Capítulo 2 Começando com o R","heading":"2.6.2 Importando arquivos do Excel","text":"Para importar arquivos Excel, existem função read_excel pacote readxl.","code":"\nbflor <- readxl::read_excel(\"data/bflor.xlsx\")\nbflor## # A tibble: 54 × 3\n##    especie     n comprimento\n##    <chr>   <dbl>       <dbl>\n##  1 Hb          1        47.1\n##  2 Hb          2        46.8\n##  3 Hb          3        46.8\n##  4 Hb          4        47.1\n##  5 Hb          5        46.7\n##  6 Hb          6        47.4\n##  7 Hb          7        46.4\n##  8 Hb          8        46.6\n##  9 Hb          9        48.1\n## 10 Hb         10        48.3\n## # … with 44 more rows"},{"path":"comeco.html","id":"o-operador-pipe","chapter":"Capítulo 2 Começando com o R","heading":"2.7 O operador pipe: %>%","text":"O operador pipe %>% é uma ferramenta muito útil para expressar uma sequência de ações sobre um objeto. Foi introduzido pela primeira vez pacote magrittr com o objetivo de facilitar programação e melhorar e legibilidade código. Sempre carregue o pacote magrittr antes de usar o pipe.exemplo abaixo, duas linhas de código são equivalentes: aplica-se função f ao objeto x.Veja abaixo o pipe em ação:caso de uma função com vários argumentos, o pipe passa o objeto para primeira posição da função, o argumento mais à esquerda:caso de ser necessário que o objeto seja passado para outro argumento à direita, que não seja o primeiro, utilizamos um . como marcador:","code":"\nlibrary(magrittr)\nf(x)\nx %>% f() # O pipe passa o objeto x para dentro da função f\nx <- c(1, 2, 3, 5, 8, 13, 21) # criar um vetor x\nx %>% add(2) # somar 2 a cada elemento do vetor x## [1]  3  4  5  7 10 15 23\nx %>% \"+\"(2) # equivalente à operação anterior## [1]  3  4  5  7 10 15 23\nx %>%\n  \"*\"(3) %>%\n  \"+\"(1) %>%\n  \"^\"(2) # várias operações aplicadas sequencialmente ao vetor x## [1]   16   49  100  256  625 1600 4096\nx %>% sum() # soma os elementos do vetor## [1] 53\nsample(x, size = 1)## [1] 1\nx %>% sample(size = 1) # idem ao anterior com o pipe passando o objeto x para a função sample## [1] 5\niris %>%\n  lm(Petal.Length ~ Species, data = .) # o objeto iris é passado para o argumento data com um .## \n## Call:\n## lm(formula = Petal.Length ~ Species, data = .)\n## \n## Coefficients:\n##       (Intercept)  Speciesversicolor   Speciesvirginica  \n##             1.462              2.798              4.090"},{"path":"comeco.html","id":"tidydata","chapter":"Capítulo 2 Começando com o R","heading":"2.8 Organização dos dados: Tidy data","text":"Para facilitar análises, é importante que os dados estejam organizados em um formato consistente, chamado de Tidy Data (WICKHAM (2014)). regras gerais para este formato são:Cada variável deve estar em uma coluna;Cada observação deve estar em uma linha;Cada valor deve ter sua própria célula.Uma função bastante útil para organizar os dados fomato tidy é função tidyr::pivot_longer14.Considere o conjunto de dados presente nesta planilha Excel: liquido.xlsx (Figura 2.4)\nFigura 2.4: Exemplo de dados não organizados formato tidy em uma planilha Excel.\nOs dados foram digitados de modo que os valores da variável tempo estão espalhados por 4 colunas. variável repetição (implícita) está em uma linha (cabeçalho das colunas) e o nome das colunas (Tempo) está em uma célula mesclada.Ao importar este arquivo com função readxl::read_excel temos como resultado:Observamos que primeira linha (células mescladas) da planilha bagunçou ainda mais o resultado. Vamos importar novamente exlcuindo primeira linha com o argumento skip = 1.Para transformar o data-frame formato tidy, utilizamos função tidyr::pivot_longer:cols: colunas serem transformadas para o formato tidy;names_to: nome da nova coluna criada partir das informações armazenadas originalmente nos cabeçalhos das colunas;values_to: nome da nova coluna criada partir dos valores armazenados nas células.O caminho inverso também pode ser feito, transformando um data-frame formato longo para o formato wide com função tidyr::pivot_wider","code":"\nmessy_data <- readxl::read_excel(\"data/liquido.xlsx\")## New names:\n## • `` -> `...1`\n## • `` -> `...3`\n## • `` -> `...4`\n## • `` -> `...5`\nmessy_data## # A tibble: 4 × 5\n##   ...1    Tempo  ...3  ...4  ...5\n##   <chr>   <dbl> <dbl> <dbl> <dbl>\n## 1 Líquido     1     2     3     4\n## 2 Água       12    15    14    11\n## 3 Óleo       29    26    24    23\n## 4 Álcool      6     7     9     4\nmessy_data <- readxl::read_xlsx(\"data/liquido.xlsx\", skip = 1)\nmessy_data## # A tibble: 3 × 5\n##   Líquido   `1`   `2`   `3`   `4`\n##   <chr>   <dbl> <dbl> <dbl> <dbl>\n## 1 Água       12    15    14    11\n## 2 Óleo       29    26    24    23\n## 3 Álcool      6     7     9     4\ntidy_data <- tidyr::pivot_longer(messy_data, cols = 2:5, names_to = \"rep\", values_to = \"tempo\")\ntidy_data## # A tibble: 12 × 3\n##    Líquido rep   tempo\n##    <chr>   <chr> <dbl>\n##  1 Água    1        12\n##  2 Água    2        15\n##  3 Água    3        14\n##  4 Água    4        11\n##  5 Óleo    1        29\n##  6 Óleo    2        26\n##  7 Óleo    3        24\n##  8 Óleo    4        23\n##  9 Álcool  1         6\n## 10 Álcool  2         7\n## 11 Álcool  3         9\n## 12 Álcool  4         4"},{"path":"rmarkdown-1.html","id":"rmarkdown-1","chapter":"Capítulo 3 RMarkdown","heading":"Capítulo 3 RMarkdown","text":"","code":""},{"path":"rmarkdown-1.html","id":"criando-um-arquivo-rmd","chapter":"Capítulo 3 RMarkdown","heading":"3.1 Criando um arquivo Rmd","text":"Para criar um arquivo tipo Rmd, clique em File -> New File -> R Markdown.\nFigura 3.1: Criando um arquivo R Markdown.\nVárias opções estão disponíveis por padrão. Escolha aquela que julgar mais adequada ou então clique botão Create Empty Document.Um arquivo Rmd é composto por três componentes básicos: Cabeçalho, Texto e Código.Abaixo, um exemplo cabeçalho de um arquivo Rmd que exporta formato HTML:Este cabeçalho deve ser escrito entre --- (traço triplo) e utiliza síntaxe YAML (pt.wikipedia.org/wiki/YAML).O texto (ou narrativa) inicia logo após o cabeçalho e segue síntaxe demonstrada na seção 3.2.O código inicia com ```{r} (aspas triplas) em que r indica linguagem utilizada e termina com ``` (aspas triplas) novamente. Opções código podem ser escritas dentro das chaves: ```{r, .width=\"90%\"}.Para renderizar o arquivo, basta clicar botão Knit ou então utilizar o atalho Ctrl + Shift + K","code":"---\ntitle: \"Olá R Markdown\"\nauthor: \"Fulano\"\ndate: \"2022-04-19\"\noutput: html_document\n---"},{"path":"rmarkdown-1.html","id":"rmdsintaxe","chapter":"Capítulo 3 RMarkdown","heading":"3.2 Síntaxe da linguagem R Markdown","text":"síntaxe da linguagem RMarkdown é bastante simples mas poderosa. Neste capítulo, serão apresentados os principais elementos.separação entre os parágrafos deve ser feita com dois espaços verticais (enter).Para deixar um texto em itálico, este deve ser escrito entre * (asterisco simples): *itálico* = itálico. Já para deixar o texto em negrito, este deve ser escrito entre ** (asterisco duplo): **negrito** = negrito. E para itálico e negrito? adivinhem, *** (asterisco triplo): ***itálico e negrito*** = itálico e negrito.Sobrescrito deve ficar entre ^ (circunflexo): m^3^/s = m3/s. Já o subscrito é escrito entre ~ (til): H~2~O = H2O.Um link para uma página externa: [Site da UFSC](https://ufsc.br) = Site da UFSCUma lista marcada deve ter cada item precedido por um * (asterisco):* item 1* item 2Retorna:item 1item 2Uma lista numerada dever ter cada item precedido por um número:1. item 11. item 21. item 3Retorna:item 1item 2item 3Os títulos das seções são escritos após # (sustenido ou hashtag).Mais opções podem ser encontradas na folha de dicas RStudio: R Markdown Cheat SheetMuito mais informações podem ser encontradas neste livro bastante completo: R Markdown: Definitive Guide","code":"# Título nível 1\n\n## Título nível 2\n\n### Título nível 3"},{"path":"rmarkdown-1.html","id":"formatos-de-saída","chapter":"Capítulo 3 RMarkdown","heading":"3.3 Formatos de saída","text":"Os principais formatos de saída para documentos 15 são:html_document - saída em formato HTMLpdf_document - saída em formato PDFword_document - saída em formato Word (.doc)odt_document - saída em formato OpenDocument (.odt) para OpenOffice e LibreOfficertf_document - saída em formato Rich Text Format (.rtf)","code":""},{"path":"bio.html","id":"bio","chapter":"Introdução - (bio)Estatística","heading":"Introdução - (bio)Estatística","text":"","code":""},{"path":"alguns-conceitos-básicos.html","id":"alguns-conceitos-básicos","chapter":"Capítulo 4 Alguns conceitos básicos","heading":"Capítulo 4 Alguns conceitos básicos","text":"","code":""},{"path":"alguns-conceitos-básicos.html","id":"população-e-amostra","chapter":"Capítulo 4 Alguns conceitos básicos","heading":"4.1 População e amostra","text":"PopulaçãoÉ coleção inteira de indivíduos ou objetos ser considerada ou estudada. Em geral, há infinitos objetos em uma população ou, então, tantos que não podemos olhar para todos eles.AmostraÉ um subconjunto da população inteira, uma pequena seleção de indivíduos ou objetos extraídos da coleção inteira. seleção de uma amostra envolve utilização de procedimentos específicos.\nFigura 4.1: População vs Amostra\n","code":""},{"path":"alguns-conceitos-básicos.html","id":"variável","chapter":"Capítulo 4 Alguns conceitos básicos","heading":"4.2 Variável","text":"É uma característica de um indivíduo em uma população de interesse. Pode assumir valores diferentes para indivíduos diferentes. Esta característica pode ser observada ou mensurada nos indivíduos que compõem amostra ou população.Exemplo 4.1  (Nível de potássio em bananas) Muitos estudos de pesquisa sugerem que bananas podem ser uma cura natural para diferentes doenças. bananas tem alto teor de ferro, que pode ajudar pessoas que sofrem de anemia, e há um antiácido nas bananas que pode ajudar aos que sofrem de azia. Um novo estudo se refere ao nível de potássio em uma banana típica. Cem bananas são selecionadas de todas partes mundo e mede-se e registra-se cuidadosamente o nível de potássio em cada uma delas. Descreva população, amostra e variável nesse problema.SOLUÇÃOA população consiste em todas bananas em todo o mundo. Embora essa população não seja infinita, certamente não podemos examinar cada banana unitariamente.amostra são 100 bananas selecionadas aleatoriamente. Esse é um sub-conjunto ou seleção (ou, bem, um cacho) da população.variável nesse problema é o nível de potássio. Essa característica será cuidadosamente medida para cada banana, e os dados serão resumidos ou usados para se tirar uma conclusão.","code":""},{"path":"alguns-conceitos-básicos.html","id":"tipos-de-variáveis","chapter":"Capítulo 4 Alguns conceitos básicos","heading":"4.2.1 Tipos de variáveis","text":"Qualitativa ou Categórica: Posiciona um indivíduo em um de diversos grupos ou categorias. Também podemos dizer que expressa uma qualidade indivíduo.\nNominais: São puramente qualitativas e não ordenadas, como cor de uma flor, gênero de um mamífero, formato de uma folha, etc.\nOrdinais: Podem ser colocados em ordem, como escalas de Likert (por exemplo, classifique de 0 5, com 0 para realmente não gosto e 5 para realmente gosto), comportamento de um animal (agressivo, neutro, submissivo), etc.\nNominais: São puramente qualitativas e não ordenadas, como cor de uma flor, gênero de um mamífero, formato de uma folha, etc.Ordinais: Podem ser colocados em ordem, como escalas de Likert (por exemplo, classifique de 0 5, com 0 para realmente não gosto e 5 para realmente gosto), comportamento de um animal (agressivo, neutro, submissivo), etc.Quantitativa ou Numérica: Assume valores numéricos e operações aritméticas (adição e cálculo de médias) fazem sentido.\nContínuas: Podem assumir qualquer valor em um intervalo, como o comprimento caule de uma planta, temperatura corporal de um primata, etc.\nDiscretas: Podem assumir apenas um número limitado de valores, como o número de pétalas de uma flor, número de filhotes de uma ave, etc.\nContínuas: Podem assumir qualquer valor em um intervalo, como o comprimento caule de uma planta, temperatura corporal de um primata, etc.Discretas: Podem assumir apenas um número limitado de valores, como o número de pétalas de uma flor, número de filhotes de uma ave, etc.Exemplo 4.2  (Tipos e variáveis) Dados de um estudo podem conter valores de muitas variáveis para cada um dos sujeitas estudo. Quais das seguintes variáveis são categóricas e quais são quantitativas?GêneroIdadeCorFumantePressão sanguínea sistólicaNível de cálcio sangueSOLUÇÃOCategóricas: gênero (masculino ou feminino), cor (asiática, negra, branca, outra), fumante (sim ou não).Quantitativas: idade (em anos), pressão sanguínea (milímetros de mercúrio), nível de cálcio (microgramas por mililitro).Em algumas situações, variáveis categóricas podem ser transformadas em variáveis quantitativas e vice-versa.","code":""},{"path":"alguns-conceitos-básicos.html","id":"variáveis-derivadas","chapter":"Capítulo 4 Alguns conceitos básicos","heading":"4.2.2 Variáveis derivadas","text":"maior parte das variáveissão obtidas por meio de medidas e observações diretas. entanto, há uma importante classe de variáveis denominadas derivadas, que são baseadas em duas ou mais medições obtidas independentemente. Alguns exemplos são: razão, porcentagem, índice e taxa.","code":""},{"path":"alguns-conceitos-básicos.html","id":"estatística-descritiva-vs-estatística-inferencial","chapter":"Capítulo 4 Alguns conceitos básicos","heading":"4.3 Estatística descritiva vs Estatística inferencial","text":"Estatística descritiva: Utiliza métodos gráficos e numéricos para descrever, organizar e resumir dados. É uma Análise exploratória.Estatística descritiva: Utiliza métodos gráficos e numéricos para descrever, organizar e resumir dados. É uma Análise exploratória.Estatística inferencial: Utiliza técnicas e métodos para análise de um conjunto de dados pequeno e específico para se extrair uma conclusão sobre uma coleção maior, mais geral, de dados. Os procedimentos da inferência estatística nos permitem usar os dados para tirar conclusões e avaliar riscos.Estatística inferencial: Utiliza técnicas e métodos para análise de um conjunto de dados pequeno e específico para se extrair uma conclusão sobre uma coleção maior, mais geral, de dados. Os procedimentos da inferência estatística nos permitem usar os dados para tirar conclusões e avaliar riscos.Exemplo 4.3  (Descritiva vs Inferencial) Determine se cada um dos seguintes problemas é uma estatística descritiva ou inferencial.O Departamento de Transporte mantém registros referentes todos os caminhões parados para inspeção. Um relatório sobre essas inspeções lista, por carga, proporção de todos os caminhões parados.Um pesquisador obtém uma amostra aleatória de corujas selvagens e mede o quanto elas podem virar o pescoço. Os dados são usados para se concluir que uma coruja pode virar seu pescoço mais de 120 graus partir da posição de frente.Uma instalação de pesquisa da Marinha faz vários testes para verificar integridade estrutural de um novo submarino. Um relatório laboratório afirma que embarcação pode suportar pressão profundidades de, máximo, 800 pés (243,84 m).Um inspetor de segurança seleciona uma amostra de prédios de apartamentos e verifica escadas de incêndio em cada um deles. proporção de escadas quebradas na amostra é usada para estimar proporção de escadas quebradas em toda cidade.SOLUÇÃODescritivoInferencialInferencialInferencial","code":""},{"path":"alguns-conceitos-básicos.html","id":"estudo-observacional-vs-estudo-experimental","chapter":"Capítulo 4 Alguns conceitos básicos","heading":"4.4 Estudo observacional vs Estudo experimental","text":"Estudo observacional: Observamos resposta para variáveis específicas para cada individuo. O objetivo de um estudo observacional é descrever algum grupo ou situação.Estudo experimental: Investigamos os efeitos de certas condições sobre indivíduos ou objetos na amostra. Os indivíduos são associados aleatoriamente grupos específicos e certos fatores são sistematicamente controlados, ou impostos, para se investigar ou isolar efeitos específicos. O pesquisador impõe deliberadamente algum tratamento aos indivíduos para observar suas respostas.Exemplo 4.4  (Um estudo observacional) Um estudo acompanhou 130 mil pessoas, que bebiam cerveja, vinho ou licor, durante 12 anos. Foram documentados os casos de infarto miocárdio. O estudo mostrou que ocorriam 35% menos mortes por infarto entre os que tomavam vinho (tinto ou branco) comparado aos que bebiam cerveja.Exemplo 4.5  (Um estudo experimental) Um agrônomo afirma que um novo fertilizante orgânico, em comparação com marca líder, aumenta produção e o tamanho dos tomates. Para o teste dessa afirmativa, pês de tomate são associados aleatoriamente um de dois grupos: m grupo é cultivado com o fertilizante líder e o outro grupo, com o novo produto. tempo da colheita, registram-se o tamanho e o peso de cada tomate, juntamente com o total de tomates por pé. Os dados coletados desse experimento são usados para comparar os dois fertilizantes.","code":""},{"path":"alguns-conceitos-básicos.html","id":"confundimento","chapter":"Capítulo 4 Alguns conceitos básicos","heading":"4.4.1 Confundimento","text":"O confundimento ocorre quando vários fatores juntos contribuem para um efeito, mas nenhuma causa única pode ser isolada.Estudos observacionais falham, em geral, porque variável explicativa se confunde com variáveis ocultas.Voltando ao exemplo vinho…pessoas que preferem vinho são diferentes daquelas que bebem cerveja. Os bebedores de vinho, como um grupo, são mais ricos e mais bem educados, comem mais frutas e vegetais e menos frituras. Sua dieta contém menos gordura e menos colesterol.variável explicativa (Qual tipo de bebida alcoólica você bebe com mais frequência?) é confundida com muitas variáveis ocultas (educação, riqueza, alimnetação e outras).Voltando ao exemplo tomate…Suponha que os pés de tomate em um dos grupos sejam regados com mais frequência e/ou expostos mais luz sol.Se os pés de tomate que receberam o novo fertilizante forem sujeitos essas condições diferentes (favoráveis) de crescimento, uma diferença na produção não poderá ser atribuída ao novo produto.Exemplo 4.6  (Aquecimento global) Registros instrumentais mostram um aumento nas temperaturas médias globais da superfície aérea e oceano da ordem de 0,5°C durante o século XX. Essa tendência é também evidente na redução da extensão da capa de neve, da taxa acelerada aumento nível mar e dos tempos de chegada e acasalamento de pássaros migratórios, que estão ocorrendo mais cedo. Esse aquecimento global coincide com mudanças dramáticas na composição gás atmosférico devido à atividade humana, por exemplo, queima de combustíveis fósseis.Os registros clima estão sujeitos um grande e incerto nível de variabilidade.evidência aquecimento global é experimental ou observacional?Qual variável explicativa influencia mudança climática?Qual variável oculta pode estar confundida com essa variável explicativa?SOLUÇÃOObservacional.Explicativa: atividade humana.Oculta: variabilidade natural ambiente (por exemplo, idades glaciais anteriores).O Comitê da Ciência da Mudança Climática afirma: “Por causa grande e ainda incerto nível de variabilidade natural inerente ao registro clima…, uma ligação de causalidade entre o lançamento de gases efeito estufa na atmosfera e mudanças climáticas observadas durante o século XX não pode ser estabelecida sem equívocos.”","code":""},{"path":"graf.html","id":"graf","chapter":"Capítulo 5 Gráficos estatísticos","heading":"Capítulo 5 Gráficos estatísticos","text":"Uma imagem vale mais que mil palavrasOs gráficos estatísticos são utilizados para fazer uma representação visual dos dados. São elaborados para serem vistos por você e por outras pessoas, por isso, sempre haverá um certo nível de subjetividade na interpretação gráfico.Não há (muitas) regras na elaboração dos gráficos, pelo contrário, temos liberdade para elaborá-los das forma que melhor nos convém. entanto, existem guias gerais bem estabelecidas que facilitam o processo de escolha tipo de gráfico mais adequado para o seu conjunto de dados. Em outras palavras, uma boa metodologia aplicada na construção dos gráficos é extremamente útil para seu correto entendimento e interpretação, seja qual o público alvo.Figura 5.1 vemos um exemplo de um gráfico ruim. Há uma quantidade considerável de poluição visual; barras são difíceis de comparar devido à perspectiva “3D”; os rótulos estão duplicados, na legenda e eixo vertical; sombras não acrescentam nenhuma informação; escolha das cores não foi muito bem feita.\nFigura 5.1: Um gráfico com poluição visual e de gosto duvidoso.\n","code":""},{"path":"graf.html","id":"o-pacote-ggplot2","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.1 O pacote ggplot2","text":"O pacote ggplot2 foi criado por Hadley Wickham baseado em um conceito denominado “Gramática de Gráficos” (Grammar Graphics).De um modo geral, criação de gráficos com o ggplot2 executa o mapeamento (mapping) dos dados para propriedades estéticas (aes) e geométricas (geom_*). Ainda, podem ser executadas transformações estatísticas (stat_*) e divisões (facet_*).\nTodas essas camadas combinadas irão resultar gráfico final.O primeiro passo é chamar funçao ggplot (sem o número 2 final!). O argumento data recebe o conjunto de dados (data.frame) que contém os valores. Para este primeiro exemplo, vamos utilizar o conjunto de dados gapminder.\nAinda, vamos mapear o eixo x para variável gdpPercap (inglês, PIB per capita, em US Dollar) e o eixo y para variável lifeExp (inglês, expectativa de vida ao nascer, em anos). Fica assim:\nFigura 5.2: “Pano de fundo” para um gráfico criado com o ggplot2\nOps, o gráfico resultante está vazio! O que aconteceu? Esta função cria apenas o “pano de fundo” para o gráfico, uma vez que ainda não definimos nenhuma geometria para preenchê-lo.Para completar o gráfico, basta digitar o sinal de adição + e chamar alguma função tipo geom_*, por exemplo, geom_point para um gráfico de pontos 16. Na prática, estamos adicionando (+) mais uma camada ao gráfico.\nFigura 5.3: Gráfico de dispersão entre o PIB per capita (USS$) e expectativa de vida ao nascer (anos).\nEm geral, todos os gráficos produzidos com o ggplot seguem praticamente mesma receita:Para simplificar ainda mais o código, é possível suprimir o nome dos argumentos data e mapping, pois são argumentos muito comuns em todos os gráficos criados com o ggplot2. Por isso, de agora em diante, neste livro, estes nomes não serão mais escritos.\nFigura 5.4: Outro código que produz um gráfico idêntico ao da Figura 5.3\n","code":"\nlibrary(gapminder) # carregar os dados gapminder\nggplot(\n  data = gapminder,\n  mapping = aes(x = gdpPercap, y = lifeExp)\n)\nggplot(\n  data = gapminder,\n  mapping = aes(x = gdpPercap, y = lifeExp)\n) +\n  geom_point()ggplot(\n  data = <data>,\n  mapping = aes(x = <variável x>, \n                y = <variável y>,\n                <...> = <...>)\n) +\n  geom_*(<...>) +\n  <...>\nggplot(\n  gapminder,\n  aes(x = gdpPercap, y = lifeExp)\n) +\n  geom_point()"},{"path":"graf.html","id":"criando-gráficos-do-ggplot-como-objetos","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.1.1 Criando gráficos do ggplot como objetos","text":"Uma forma bastante conveniente de trabalhar com os gráficos é armazenar em objetos.Neste código, criamos um objeto denominado p 17 que contém informações básicas gráfico. Na sequência, podemos adicionar mais elementos neste mesmo gráfico apenas adicionando (+) alguma função ao objeto.\nFigura 5.5: Adicionando uma camada geom_point() ao objeto p\n\nFigura 5.6: Adicionando uma camada geom_smooth() ao objeto p\n\nFigura 5.7: Adicionando várias camadas ao objeto p\n","code":"\np <- ggplot(\n  gapminder,\n  aes(x = gdpPercap, y = lifeExp)\n)\np +\n  geom_point()\np +\n  geom_smooth()## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = \"cs\")'\np +\n  geom_point() +\n  geom_smooth()## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = \"cs\")'"},{"path":"graf.html","id":"personalizando-os-eixos","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.1.2 Personalizando os eixos","text":"Muitas vezes precisamos personalizar os eixos gráfico para aprimorar visualização.\nfunção labs permite alterar vários argumentos, como visto exemplo seguir:\nFigura 5.8: Personalizando o gráfico alterando o rótulo dos eixos e adicionando título e subtítulo.\nx altera o rótulo eixo xy altera o rótulo eixo ytitle adiciona um título na parte superiorsubtitle adiciona um subtítulo logo abaixo títulocaption rótulo que aparece canto inferior direito","code":"\np +\n  geom_point() +\n  labs(\n    x = \"PIB per capita (US$)\",\n    y = \"Expectativa de vida ao nascer (anos)\",\n    title = \"Economia vs Expectativa de Vida\",\n    subtitle = \"Cada ponto representa um país e um ano\",\n    caption = \"Fonte: Gapminder\"\n  )"},{"path":"graf.html","id":"aes","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.1.3 Mapeando atributos estéticos","text":"Nesta seção, vamos estudar mais sobre os atributos estéticos. Em nosso primeiro gráfico, já utilizamos dois atributos de posição cartesiana: os eixos x e y.\nEntre vários outros atributos estéticos, vamos trabalhar com color e fill, que alteram cores.\nFigura 5.9: Mapeamento de cores diferentes para cada continente.\nVejam que ao mapear color para uma variável, foram atribuídas cores aos pontos, uma cor diferente para cada continente. Também foi adicionada uma legenda explicativa.Na figura seguinte, vamos adicionar mais uma camada ao gráfico, linha ajustada com geom_smooth.Veja que foi criada uma linha de ajuste para cada continente. Isso acontece porque foi mapeado o atributo color para os continentes. entanto, faixa interval de confiança não acompanhou cores, permanecendo na cor cinza. Isso acontece porque, para o ggplot, há dois tipos de objetos: color serve para linhas e pontos e fill serve para preenchimento de áreas e políogonos. Assim, para colorir faixa intervalo de confiança, os continentes deve ser mapeada para o atributo fill, como exemplo seguir.","code":"\nggplot(\n  gapminder,\n  aes(\n    x = gdpPercap,\n    y = lifeExp,\n    color = continent\n  )\n) +\n  geom_point() +\n  scale_x_log10()\nggplot(\n  gapminder,\n  aes(\n    x = gdpPercap,\n    y = lifeExp,\n    color = continent\n  )\n) +\n  geom_point() +\n  geom_smooth(method = \"lm\", formula = y ~ x) +\n  scale_x_log10()\nggplot(\n  gapminder,\n  aes(\n    x = gdpPercap,\n    y = lifeExp,\n    color = continent,\n    fill = continent\n  )\n) +\n  geom_point() +\n  geom_smooth(method = \"lm\", formula = y ~ x) +\n  scale_x_log10()"},{"path":"graf.html","id":"mapeando-atributos-em-cada-geom_","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.1.4 Mapeando atributos em cada geom_*","text":"Mas cinco linhas ajustadas podem ser demais. Queremos ajustar apenas uma! E ainda queremos manter os pontos coloridos para cada continente. Para resolver esta situação, podemos mapear os atributos dentro de cada geometria.Por padrão, funções geom_* herdam seus mapeamentos da funçao ggplot. Podemos alterar este comportamento mapeando estética apenas dentro da função geom_* que queremos que se aplique.Também é possível mapear variáveis numéricas, por exemplo, o logaritmo da população em cada país e ano. Quando fazemos isso, escala de cor produzida é um gradiente contínuo. função scale_color_viridis_c() especifica utilização da paleta de cor viridis.","code":"\nggplot(\n  gapminder,\n  aes(\n    x = gdpPercap,\n    y = lifeExp\n  )\n) +\n  geom_point(aes(color = continent)) +\n  geom_smooth(method = \"lm\", formula = y ~ x) +\n  scale_x_log10()\nggplot(\n  gapminder,\n  aes(\n    x = gdpPercap,\n    y = lifeExp\n  )\n) +\n  geom_point(aes(color = log(pop))) +\n  geom_smooth(method = \"lm\", formula = y ~ x) +\n  scale_x_log10() +\n  scale_color_viridis_c()"},{"path":"graf.html","id":"definindo-atributos-estéticos","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.1.5 Definindo atributos estéticos","text":"Em algumas situações nós apenas queremos definir atributos estéticos, como cores, em vez de mapeá-los para alguma variável. Para isso, devemos definir estes atributos fora da função aes().","code":"\np <- ggplot(\n  data = gapminder,\n  mapping = aes(\n    x = gdpPercap,\n    y = lifeExp\n  )\n)\n\n\np + \n  geom_point(color = \"purple\") +\n  scale_x_log10()\np + \n  geom_point(shape = 8, size = 2, color = \"tomato\") +\n  scale_x_log10()\np + \n  geom_point(alpha = 0.3) +\n  geom_smooth(color = \"orange\", size = 8, method = \"lm\", formula = y ~ x) +\n  scale_x_log10()"},{"path":"graf.html","id":"gráfico-de-barras","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.2 Gráfico de barras","text":"O gráfico de barras, que também pode ser chamado de gráfico de colunas, é um gráfico em que altura das barras é proporcional ao valor por elas representado.\nQuando ordenado, também pode ser chamado de Gráfico de ParetoEste tipo de gráfico é utilizado para representar os dados quando uma das variáveis é categórica ou numérica discreta. 18A maior parte dos exemplos de gráficos de barras utilizará o conjunto de dados mpg.","code":""},{"path":"graf.html","id":"gráfico-de-barras-para-uma-variável","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.2.1 Gráfico de barras para uma variável","text":"ggplot2, geometrias deste tipo de gráfico são: geom_bar ou geom_col. diferença entre elas é que geom_bar tem como padrão função stat_count que representa o número de casos em cada grupo (contagem) e geom_col tem como padrão função stat_identity que mantém os dados como estão e pode ser usada para representa valores numéricos de outra variável.Quando há apenas uma variável categórica, altura das barras é proprocional ao número (contagem) de indivíduos em cada categoria. Neste caso, usamos geom_bar, cuja função padrão é stat_count, que realiza contagem das observações em cada classe.\nFigura 5.10: Número de automóveis (contagem) em cada classe.\nPara ordenar barras, precisamos organizar o data.frame original. Para isso, utilizamos algumas funções auxiliares presentes pacote tidyverse 19. Adicionamos uma coluna adicional contendo contagem de cada grupo e depois procedemos com reordenação com função fct_reorder. Observem também utilização operador %>% (pipe) que também é carregado junto com o pacote tidyverse. Por fim, geometria é alterada para geom_col.\nFigura 5.11: Número de automóveis (contagem) em cada classe. categorias estão ordenadas em ordem crescente (menor para maior).\nPor padrão, o ordenamento é crescente, ou seja, menor para o maior. Para inverter, adicionamos o argumento .desc=TRUE à função fct_reorder, que faz o ordenamento decrescente.\nFigura 5.12: Número de automóveis (contagem) em cada classe. categorias estão ordenadas em ordem decrescente.\ncaso de uma variável numérica discreta, o código é essencialmente o mesmo, assim como suas variações.\nFigura 5.13: Número de automóveis com 4, 5, 6 ou 8 cilindros.\nPor existir uma ordem natural na variável discreta, ordenação pelo tamanho das barras não é recomendada (na maioria dos casos).","code":"\nggplot(mpg, aes(x = class)) +\n  geom_bar()\nmpg %>%\n  count(class) %>%\n  ggplot(aes(x = fct_reorder(class, n), y = n)) +\n  geom_col()\nmpg %>%\n  count(class) %>%\n  ggplot(aes(x = fct_reorder(class, n, .desc = TRUE), y = n)) +\n  geom_col()\nggplot(mpg, aes(x = cyl)) +\n  geom_bar()"},{"path":"graf.html","id":"gráfico-de-barras-para-duas-variáveis","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.2.2 Gráfico de barras para duas variáveis","text":"O gráfico de barras também pode representar relação entre duas variáveis, sendo uma delas categórica ou numérica discreta (eixo x) e outra numérica (eixo y).Neste primeiro exemplo, vamos plotar relação entre uma variável categórica (class) e outra numérica contínua (displ).\nAqui, é necessário definir uma função para resumir os dados, uma vez que função padrão (stat_count) não é adequada. Uma opção muito comum é representar média de cada grupo. Isso é possível com os argumentos stat = \"summary\"e fun = \"mean\" dentro da geometria geom_bar. Assim, calculamos média da variável displ em cada classe.\nFigura 5.14: Cilindradas (média) dos motores de automóveis em cada classe.\nPara plotar este mesmo gráfico com ordenação das colunas, devemos trabalhar data.frame original. Assim, definimos uma nova variável (media_displ) calculada partir das médias agrupamento das classes de automóveis. função fct_reorder faz ordenação crescente das médias. geometria deve ser modificada para geom_col.\nFigura 5.15: Cilindradas (média) dos motores de automóveis em cada classe. classes estão ordenadas segundo média da cilindrada dos motores.\n","code":"\nggplot(mpg, aes(x = class, y = displ)) +\n  geom_bar(stat = \"summary\", fun = \"mean\")\nmpg %>%\n  group_by(class) %>%\n  summarise(media_displ = mean(displ)) %>%\n  ggplot(aes(x = fct_reorder(class, media_displ), y = media_displ)) +\n  geom_col()"},{"path":"graf.html","id":"gráfico-de-barras-para-três-variáveis.","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.2.3 Gráfico de barras para três variáveis.","text":"É possível mapear uma terceira variável categórica ou numérica discreta em um gráfico de barras. terceira variável é passada para o argumento fill, que atribui uma cor diferente para cada nível.\nDevemos explicitá-la como fatorizada, por isso necessidade de usar função factor.Nestes exemplo, vamos utilizar o conjunto de dados ToothGrowth.opção position = \"dodge\" evita sobreposição das barras ajustando-lado lado. Uma variação é position = \"dodge2\" que adiciona um pequeno espaço entre barras.\nFigura 5.16: Comprimento de odontoblastos de porquinhos da Índia submetidos diferentes tipos de suplementos e doses de vitamina C.\nInvertendo variáveis eixo x e elemento fill:\nFigura 5.17: Comprimento de odontoblastos de porquinhos da Índia submetidos diferentes tipos de suplementos e doses de vitamina C.\n","code":"\nggplot(ToothGrowth, aes(x = supp, y = len, fill = factor(dose))) +\n  geom_bar(stat = \"summary\", fun = \"mean\", position = \"dodge\") +\n  scale_fill_viridis_d()\nggplot(ToothGrowth, aes(x = (dose), y = len, fill = supp)) +\n  geom_bar(stat = \"summary\", fun = \"mean\", position = \"dodge\") +\n  scale_fill_viridis_d()"},{"path":"graf.html","id":"dispersao","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.3 Gráficos de dispersão","text":"São utilizados para mostrar relação entre duas variáveis numéricas contínuas. Para isso, são utilizados pontos que representam cada observação. geometria para este tipo de gráfico é geom_point. Veja este exemplo com os dados conjunto iris.\nFigura 5.18: Relação entre o comprimento e largura de flores de espécies de Iris. Este é um gráfico de dispersão em que cada ponto representa um par de valores.\nQuando é bem clara distinção entre variáveis, sendo uma variável preditora (independente) e outra variável resposta (dependente), estas devem ser organizadas da seguinte forma: variável preditora é mapeada eixo x e variável resposta é mapeada para o eixo y. Veja este exemplo com dados conjunto BOD\nFigura 5.19: Relação entre demanda bioquímica de oxigênio (BOD) e o tempo na avaliação da qualidade da água. Neste exemplo, o tempo é usado como um preditor para demanda bioquímica oxigênio. Por isso, o tempo está mapeado eixo x e BOD está mapeada eixo y.\n","code":"\nggplot(iris, aes(x = Petal.Length, y = Petal.Width)) +\n  geom_point()\nggplot(BOD, aes(x = Time, y = demand)) +\n  geom_point()"},{"path":"graf.html","id":"linha-de-tendência","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.3.1 Linha de tendência","text":"É bastante comum que seja traçada uma linha para os valores preditos baseados em algum modelo estatístico\nPra isso, utilizaremos função geom_smooth, que já realiza o ajuste estatístico modelo linear. Vamos definir o método (method = \"lm\") para lm de modelo linear (ou linear model em inglês). O argumento se = FALSE impede de traçar o intervalo de confiança.\nFigura 5.20: Relação entre o comprimento e largura de flores de espécies de Iris. Neste gráfico existe uma linha de tendência linear ajustada por geom_smooth.\nPor padrão, é adicionado uma região de confiança de 95% para regressão. probabilidade pode ser alterada modificando o argumento level, ou pode ser suprimida com o argumento se = FALSE.\nFigura 5.21: Relação entre o comprimento e largura de flores de espécies de Iris. linha de tendência linear é acompanhada de um intervalo de confiança de 99%. O nível de confiança é ajustado pelo argumento level.\n\nFigura 5.22: Relação entre o comprimento e largura de flores de espécies de Iris. O intervalo de confiança é suprimido com o argumento se = FALSE.\nNeste mesmo exemplo, é possível ajustar uma linha para cada espécie de Iris, mapeando espécies para cor.\nFigura 5.23: Relação entre o comprimento e largura de flores de espécies de Iris. linhas de tendência são ajustadas para cada espécie que foram mapeadas para color.\n","code":"\nggplot(iris, aes(x = Petal.Length, y = Petal.Width)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", formula = y ~ x)\niris_disp_plot <- ggplot(iris, aes(x = Petal.Length, y = Petal.Width)) +\n  geom_point()\n\niris_disp_plot + \n  geom_smooth(method = \"lm\", formula = y ~ x, level =0.99)\niris_disp_plot + \n  geom_smooth(method = \"lm\", formula = y ~ x, se = FALSE)\nggplot(iris, aes(x = Petal.Length, y = Petal.Width, color = Species)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", formula = y ~ x)"},{"path":"graf.html","id":"sobreposição-de-elementos","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.4 Sobreposição de elementos","text":"Existem algumas situações em que, ao plotar os pontos, estes aparecem sobrepostos entre si. É mais comum quando ambas variáveis são discretas, pois pode ocorrer sobreposição perfeita.\nFigura 5.24: Gráfico de dispersão entre o ano de fabricação e o número de cilindros de automóveis. duas variáveis são numéricas discretas e os pontos são mostrados com sobreposição “perfeita”.\nPara contornar este problema, pode-se fazer uso da geometria geom_jitter. Ela adiciona uma pequena quantidade de variação aleatória à localização dos pontos, o que evita sobreposição. Funciona melhor em conjuntos de dados pequenos.\nFigura 5.25: Gráfico de dispersão entre o ano de fabricação e o número de cilindros de automóveis. Ao utilizar geom_jitter, localização dos pontos é alterada aleatoriamente, evitando sobreposição. Assim, é possível ter uma melhor noção da quantidade de pontos em cada nível das variáveis.\nOutra forma de lidar com sobreposição é alterar o elemento alpha, que determina transparência dos pontos. É melhor para conjuntos de dados grandes e variáveis contínuas. exemplo seguir utilizamos o conjunto de dados diamonds.\nFigura 5.26: Relação entre o peso (quilates) de diamantes e seu preço. O conjunto de dados contém um número grande de observações que causa uma grande sobreposição em algumas regiões. Ao determinar transparência (alpha), é possível melhorar observação da distribuição e verificar em quais regiões gráfico há maior concentração de pontos.\n\nFigura 5.27: Relação entre o peso (quilates) de diamantes e seu preço. O conjunto de dados contém um número grande de observações que causa uma grande sobreposição em algumas regiões. Ao determinar transparência (alpha), é possível melhorar observação da distribuição e verificar em quais regiões gráfico há maior concentração de pontos.\n","code":"\nggplot(mpg, aes(x = year, y = cyl)) +\n  geom_point()\nggplot(mpg, aes(x = year, y = cyl)) +\n  geom_jitter(width = 0.2, height = 0.2)\ndiamonds_plot <- ggplot(diamonds, aes(x = carat, y = price))\n\ndiamonds_plot + geom_point()\ndiamonds_plot + geom_point(alpha = 0.1)"},{"path":"graf.html","id":"gráficos-de-linhas","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.5 Gráficos de linhas","text":"Os gráficos de linhas são utilizados quando queremos representar uma variável numérica contínua eixo x. Em alguns casos, também podem ser utilizados para variáveis categóricas ou discretas, mas desde que tenham uma ordenação natural.Voltamos ao conjunto de dados ToothGrowth. dose, por ser uma variável numérica, pode ser representada eixo x. Os valores de comprimento foram resumidos para cada observação.\nFigura 5.28: Gráfico de linhas entre dose de vitamina C e comprimento de odontoblastos de porquinhos da Índia. dose, por ser uma variável numérica, é plotada eixo x e é possível utilizar linhas para ligar os pontos.\nÉ bastante comum sobreposição dos pontos observados às linhas, com adição de uma camada geom_point.\nFigura 5.29: Gráfico de linhas entre dose de vitamina C e comprimento de odontoblastos de porquinhos da Índia. adição de uma camada geom_point mostra os pontos observados.\nAinda há possibilidade de mapear uma terceira variável para o elemento color.\nFigura 5.30: Gráfico de linhas entre dose de vitamina C, comprimento de odontoblastos de porquinhos da Índia e forma de suplementação. terceira variável é mapeada para diferentes cores e mostrada mesmo gráfico.\n","code":"\nToothGrowth %>%\n  group_by(dose) %>%\n  summarise(len_mean = mean(len)) %>%\n  ggplot(aes(x = dose, y = len_mean)) +\n  geom_line()\nToothGrowth %>%\n  group_by(dose) %>%\n  summarise(len_mean = mean(len)) %>%\n  ggplot(aes(x = dose, y = len_mean)) +\n  geom_line() +\n  geom_point()\nToothGrowth %>%\n  group_by(supp, dose) %>%\n  summarise(len_mean = mean(len)) %>%\n  ggplot(aes(x = dose, y = len_mean, color = supp)) +\n  geom_line()## `summarise()` has grouped output by 'supp'. You can override using the\n## `.groups` argument."},{"path":"graf.html","id":"gráficos-de-linhas-para-séries-temporais","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.5.1 Gráficos de linhas para séries temporais","text":"É bastante comum que variável eixo x de uma gráfico de linhas seja uma medida de tempo. Neste caso, o gráfico estará representando uma série temporal. geometria utilizada é geom_line. Para exemplificar, vamos utilizar o conjunto de dados economics.\nFigura 5.31: Gráfico de linhas com tendência temporal para Número de desemprego. linhas são ótimas para mostrar tendências temporais, inclusive variações sazonais.\n\nFigura 5.32: Gráfico de linhas com tendência temporal para Despesas de consumo pessoal (US$ Bi). linhas são ótimas para mostrar tendências temporais, inclusive algumas anomalias pontuais.\n","code":"\nggplot(economics, aes(x = date, y = unemploy)) +\n  geom_line()\nggplot(economics, aes(x = date, y = pce)) +\n  geom_line()"},{"path":"graf.html","id":"gráficos-para-distribuição-graf_dist","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.6 Gráficos para distribuição (#graf_dist)","text":"Uma distribuição de frequência é uma forma de resumir uma quantidade de dados distribuídos em classes ou intervalos. frequência é o número de observações que pertencem cada classe.Nesta seção, serão apresentados vários tipos de gráficos utilizados para esta finalidade.","code":""},{"path":"graf.html","id":"histograma","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.6.1 Histograma","text":"O histograma é um tipo especial gráfico de barras. histograma, largura de cada barra representa uma classe, e altura das barras representa frequência ou proporção dos valores contidos em cada classe.\nVia de regra, barras histograma devem ser apresentadas sem espaço entre elas.geometria para construção histograma é geom_histogram.Vamos exemplificar com o conjunto de dados faithful.\nFigura 5.33: Histograma da distribuição de frequência tempo de espera entre erupções gêiser Old Faithful.\ncor padrão histograma ggplot dificulta separação das classes. É possível aprimorar este aspecto definindo uma cor para o contorno das barras.\nFigura 5.34: Histograma da distribuição de frequência tempo de espera entre erupções gêiser Old Faithful. Foi definida uma cor para o contorno das barras (color = \"black\") afim de melhorar visualização destas.\nPor padrão, o histograma feito com o ggplot é dividido em 30 classes (bins = 30. Este é um valor aleatório e não serve para maioria dos casos. 20\nPara alterar quantidade de classes representada, há duas opções:Determinar o número de classes diretamente, modificando o argumento bins.Determinar dimensão das classes, modificando o argumento binwidth.\nFigura 5.35: Histograma da distribuição de frequência tempo de espera entre erupções gêiser Old Faithful. Este histograma foi contruído com 20 classes (bins = 20).\n\nFigura 5.36: Histograma da distribuição de frequência tempo de espera entre erupções gêiser Old Faithful. Este histograma foi contruído com 10 classes (bins = 10).\n\nFigura 5.37: Histograma da distribuição de frequência tempo de espera entre erupções gêiser Old Faithful. Este histograma foi contruído com o intervalo das classes igual 1 minuto (binwidth = 1).\n\nFigura 5.38: Histograma da distribuição de frequência tempo de espera entre erupções gêiser Old Faithful. Este histograma foi contruído com o intervalo das classes igual 6 minutos (binwidth = 6).\nQuando temos vários grupos, podemos criar os histogramas separadamente para cada grupo coma função fecet_grid. O argumento scales='free' permite que escala eixo y seja redimensionada independentemente para cada grupo.\nFigura 5.39: Histograma para distribuição comprimento das pétalas de três espécies de Iris.\n","code":"\nggplot(faithful, aes(x = waiting)) +\n  geom_histogram()## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\nggplot(faithful, aes(x = waiting)) +\n  geom_histogram(color = \"black\")## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\nff_plot <- ggplot(faithful, aes(x = waiting))\nff_plot + geom_histogram(bins = 20, color = \"black\")\nff_plot + geom_histogram(bins = 10, color = \"black\")\nff_plot + geom_histogram(binwidth = 1, color = \"black\")\nff_plot + geom_histogram(binwidth = 6, color = \"black\")\nggplot(iris, aes(x = Petal.Length)) +\n  geom_histogram(color = \"black\") +\n  facet_grid(Species ~ ., scales = \"free\")## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`."},{"path":"graf.html","id":"gráfico-de-densidade-da-distribuição","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.6.2 Gráfico de densidade da distribuição","text":"O gráfico de densidade da distribuição é uma versão suavizada histograma. Para isso, este gráfico utiliza uma linha lugar de barras (compare com Figura 5.33).\nFigura 5.40: Densidade da distribuição tempo de espera entre erupções gêiser Old Faithful.\nUma forma popular de apresentar este gráfico é preenchendo área abaixo da linha. Isto é possível ajustando o argumento fill.\nFigura 5.41: Densidade da distribuição tempo de espera entre erupções gêiser Old Faithful. Ao ajustar o argumento fill é adicionada uma área preenchida abaixo da curva.\n","code":"\nggplot(faithful, aes(x = waiting)) +\n  geom_density()\nggplot(faithful, aes(x = waiting)) +\n  geom_density(fill = \"green\", alpha = 0.5)"},{"path":"graf.html","id":"box-plot","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.6.3 Box Plot","text":"O Box plot, também conhecido como diagrama de caixa, representa uma distribuição por meio resumo de cinco números:Limite inferiorPrimeiro quartilMedianaTerceiro quartilLimite superiorA figura abaixo mostra como estes valores formam o gráfico Box plot. “caixa” (box) tem como limites o 1° e 3° quartis, medida que também é conhecida como Amplitude Interquartil (AIQ). Neste intervalo estão presentes 50% das observações. linha dentro da caixa representa mediana. Os “bigodes” (whiskers) se estendem até uma medida predeterminada, que pode ser:O mínimo e o máximo entre todos os valores;Os valores mais próximos um limite inferior e um limite superior calculados por: \\(L_i=Q_1-c \\times AIQ\\) e \\(L_s=Q_3+c \\times AIQ\\), em que AIQ é amplitude interquartil e c é um coeficiente cujo valor padrão é 1,5 21.Os valores discrepantes, mais extremos que os limites, são plotados como pontos individuais.O Box plot utiliza geometria geom_boxplot. direção gráfico (horizontal ou vertical) é ajustada mapeando variável para o eixo x ou y\nFigura 5.42: Box plot tempo de espera entre erupções gêiser Old Faithful. Mapear variável para o eixo y resulta boxplot vertical.\n\nFigura 5.43: Box plot tempo de espera entre erupções gêiser Old Faithful. Mapear variável para o eixo y resulta boxplot horizontal.\nUma utilização bastante comum Box plot é para comparar diferentes grupos. Para isso, plotamos o Boxplot para cada grupo dentro mesmo gráfico.\nFigura 5.44: Consumo de combustível na rodovia segundo classe dos automóveis. O Box plot é uma excelente alternativa para comparação entre diferentes classes.\nO argumento coef ajusta o comprimentos dos bigodes como um múltiplo da AIQ. Por padrão, seu valor é de 1,5. Para que os bigodes se estendam até os valores máximos/mínimos, modificamos o argumento coef para NULL. Outros valores numéricos são possíveis para coef.\nFigura 5.45: Consumo de combustível na rodovia segundo classe dos automóveis. O comprimento dos bigodes alcança os valores mais extremos com o argumento coef = NULL.\n\nFigura 5.46: Consumo de combustível na rodovia segundo classe dos automóveis. O argumento coef = 2.0 ajusta o comprimento dos bigodes para 2 vezes AIQ.\n\nFigura 5.47: Consumo de combustível na rodovia segundo classe dos automóveis. O argumento coef = 1.0 ajusta o comprimento dos bigodes para 1 vez AIQ.\nÉ possível adicionar uma marca para média ao Boxplot. Para isso, utilizamos stat_summary para calcular média e ajustamos um formato para marca. O argumento shape=23 adiciona um losango (diamante), já que esse formato é bastante comum na representaçao da média.\nFigura 5.48: Consumo de combustível na rodovia segundo classe dos automóveis. Uma marca em forma de losango foi adicionada para representar média dos valores.\n","code":"\nggplot(faithful, aes(y = waiting)) +\n  geom_boxplot()\nggplot(faithful, aes(x = waiting)) +\n  geom_boxplot()\nggplot(mpg, aes(x = class, y = hwy)) +\n  geom_boxplot()\nggplot(mpg, aes(x = class, y = hwy)) +\n  geom_boxplot(coef = NULL)\nggplot(mpg, aes(x = class, y = hwy)) +\n  geom_boxplot(coef = 2.0)\nggplot(mpg, aes(x = class, y = hwy)) +\n  geom_boxplot(coef = 1.0)\nggplot(mpg, aes(x = class, y = hwy)) +\n  geom_boxplot() +\n  stat_summary(fun = \"mean\", shape = 23)"},{"path":"graf.html","id":"gráficos-interativos","chapter":"Capítulo 5 Gráficos estatísticos","heading":"5.7 Gráficos interativos","text":"O pacote plotly 22 permite criação de gráficos interativos para web.","code":"\np <- ggplot(iris, aes(x = Petal.Length, y = Petal.Width, color = Species)) +\n  geom_point()\nplotly::ggplotly(p)"},{"path":"estbas.html","id":"estbas","chapter":"Capítulo 6 Estatística Básica","heading":"Capítulo 6 Estatística Básica","text":"Neste capítulo, iremos estudar alguns itens que podem ser compreendidos como base das análises estatísticas, pois são usados transversalmente em muitos outros assuntos tratados posteriormente.Para facilitar o entendimento, alguns dos próximos exemplos (deste e dos próximos capítulos) utilizarão os dados obtidos em uma população conforme descrito seguir.Considere uma população com 150 árvores pertencente um reflorestamento de Mogno Africano. O DAP destas árvores foi medido aos 5 anos após o plantio e os dados são mostrados na tabela abaixo:Os dados também podem ser acessados arquivo dap.csv.","code":""},{"path":"estbas.html","id":"medidas-de-centro","chapter":"Capítulo 6 Estatística Básica","heading":"6.1 Medidas de centro","text":"MédiaA média aritmética é medida de centro mais comum.MedianaÉ o ponto meio de uma distribuição, o número em relação ao qual metade das observações é menor, e metade, maior.Exemplo 6.1  (Medidas de centro) Considere o conjunto de dados dap.csv.Qual média e qual mediana destes dados?","code":"\n# média\nmean(dap)## [1] 12.94553\n# mediana\nmedian(dap)## [1] 12.815"},{"path":"estbas.html","id":"medidas-de-dispersão","chapter":"Capítulo 6 Estatística Básica","heading":"6.2 Medidas de dispersão","text":"medidas de dispersão descrevem variabilidade dos dados.","code":""},{"path":"estbas.html","id":"quartil","chapter":"Capítulo 6 Estatística Básica","heading":"6.2.1 Quartil","text":"Os quartis delimitam metade central.O primeiro quartil (Q1) cai em um quarto caminho da lista.O terceiro quartil (Q3) cai em três quartos caminho na lista.Amplitude interquartil (AIQ) é diferença entre o 3º e 1º quartilConhecendo os quartis, podemos descrever uma distribuição com um Resumo de cinco números. São eles:menor observaçãoprimeiro quartilmedianaterceiro quartilmaior observaçãoExemplo 6.2  (Resumo dos cinco números) Considere o conjunto de dados dap.csv.Qual o Resumo de cinco números para estes dados?","code":"\nquantile(dap)##     0%    25%    50%    75%   100% \n##  7.920 11.620 12.815 14.325 16.830"},{"path":"estbas.html","id":"variância-e-desvio-padrão","chapter":"Capítulo 6 Estatística Básica","heading":"6.2.2 Variância e desvio-padrão","text":"São descrições numéricas mais comuns de uma distribuição.variância s2 de um conjunto de observações é média dos quadrados dos desvios das observações partir de sua média.O desvio-padrão s é raiz quadrada da variância s2.Exemplo 6.3  (Variância e desvio-padrão) Considere o conjunto de dados dap.csv.Qual variância e o desvio-padrão destes dados?23","code":"\n# Variância\nvar(dap)## [1] 3.168652\n# Desvio-padrão\nsd(dap)## [1] 1.780071"},{"path":"estbas.html","id":"descrição-de-uma-distribuição","chapter":"Capítulo 6 Estatística Básica","heading":"6.3 Descrição de uma distribuição","text":"Qualquer conjunto de dados pode (e deve) ser descrito por meio dos resumos numéricos juntamente com análise gráfica (Seção @ref(graf_dist).Essa descrição visa também verificar assimetria dos dados e presença de valores discrepantes.Exemplo 6.4  (Descrição de uma distribuição simétrica) Considere o conjunto de dados dap.csv.Descreva esta distribuição com o uso de gráficos e resumos numéricos.Esta é uma distribuição simétrica e que não possui valores atípicos.O DAP média da população é de 12.95 cm com desvio-padrão de 1.78.Vejamos outro exemplo com uma distribuição bastante diferenteExemplo 6.5  (Descrição de uma distribuição assimétrica) Considere os dados tempo de sobrevivência de porquinhos-da-índia após terem recebido uma injeção de bactéria infecciosa em um experimento médico.Os dados podem ser encontrados arquivo porquinho.xlsxA distribuição é assimétrica á direita. mediana da distribuição é 102.5.O resumo de cinco números é 43, 82.75, 102.5, 149.25, 598Metade dos porquinhos-da-índia morrem dentro dos primeiros 102 dias. Quase todos não sobrevivem até 149 dias.entanto, alguns poucos animais sobrevivem mais, de modo que o gráfico se estende mais para direita pico, até o valor mais alto de 598 dias.Tempos de sobrevivência, seja de máquinas sob esforço ou de pacientes depois de um tratamento, em geral, são assimétricos à direita.Muitas vezes, uma distribuição pode apresentar dois (ou mais) picos. existência de mais de um pico sugere que indívíduos de vários tipos estão misturados conjunto de dados.Exemplo 6.6  (Descrição de uma distribuição bimodal) Considere o conjunto de dados peixe.csv que contém o comprimento (em cm) de vários peixes apanhados em um rio.Esta é uma distribuição bimodal, ou seja, tem dois picos, que representam peixes menores e maiores.média da distribuição é 29.67 cm. Veja que este valor pouco representa distribuição, pois média está “vale” entre os picos, ou seja, uma região que contém poucos valores.Os dois picos podem refletir um dimorfismo sexual (machos maiores que fêmeas ou vice-versa) ou presença de duas raças de peixes rio.descrição separada das duas distribuições pode ser bem mais útil. Veja o arquivo peixe2.csvA média tamanho dos peixes machos é 39.1 cm e dos peixes fêmeas é 20.3 cm.Por fim, pode haver nas distribuições um ou alguns poucos valores discrepantes, ou seja, valores que diferem consideravelmente dos demais. Muito frequentemente, também são chamados de outliers.Exemplo 6.7  (Descrição de uma distribuição com valores discrepantes) Considere os dados de produção de morango (em g/planta) contidos arquivo morango.csv.Esta distribuição apresenta claramente um valor discrepante: 6870 g na posição 10 conjunto de dados.média da distribuição é 883.8 g e mediana é 670 g.O desvio-padrão é 1095.4 e o resumo de cinco números é 568, 628.25, 670, 772.25, 6870.Ao se excluir este valor discrepante (outlier), veja como fica distribuição.Agora, conseguimos ver que distribuição é simétrica.média é 690.7 g e mediana é 664 g.O desvio-padrão é 83.4 e o resumo de cinco números é 568, 626.5, 664, 771.5, 829.","code":"\n# Histograma\n hist(dap)\n# Diagrama de ramo e folhas\nstem(dap)## \n##   The decimal point is at the |\n## \n##    7 | 9\n##    8 | \n##    8 | 8\n##    9 | \n##    9 | 89\n##   10 | 002344\n##   10 | 667889999\n##   11 | 0001111223444\n##   11 | 5556667777888889\n##   12 | 000000111122334\n##   12 | 5555666688888999999\n##   13 | 0133\n##   13 | 5555556678888888999\n##   14 | 11122233444\n##   14 | 55666788899\n##   15 | 000012234\n##   15 | 5666668\n##   16 | 02\n##   16 | 55778\n# Box-plot\nboxplot(dap)\n# Histograma\n hist(porq)\n# Diagrama de ramo e folhas\nstem(porq)## \n##   The decimal point is 2 digit(s) to the right of the |\n## \n##   0 | 455666677778888888888999999\n##   1 | 0000000000011111222334444556678889\n##   2 | 01145\n##   3 | 38\n##   4 | 0\n##   5 | 12\n##   6 | 0\n# Box-plot\nboxplot(porq)\n# Histograma\n hist(peixe)\n# Diagrama de ramo e folhas\nstem(peixe)## \n##   The decimal point is at the |\n## \n##    8 | 5\n##   10 | \n##   12 | 646\n##   14 | 013467789114579\n##   16 | 0122557900144577\n##   18 | 1277780145566788\n##   20 | 0822222458999\n##   22 | 022389125668999\n##   24 | 4579900348\n##   26 | 02456135\n##   28 | 072356\n##   30 | 15\n##   32 | 012591234\n##   34 | 336801236\n##   36 | 000344678901145556679\n##   38 | 00159001335577\n##   40 | 025682556899\n##   42 | 03555578012356\n##   44 | 02475569\n##   46 | 456815\n##   48 | 6\n##   50 | 2\n# Histograma para peixes machos\nhist(peixe2$m)\n# Histograma para peixes fêmeas\nhist(peixe2$f)\n# Histograma\n hist(morango)\n# Diagrama de ramo e folhas\nstem(morango)## \n##   The decimal point is 3 digit(s) to the right of the |\n## \n##   0 | 6666666666666777777778888888888\n##   1 | \n##   2 | \n##   3 | \n##   4 | \n##   5 | \n##   6 | 9\n# Box-plot\nboxplot(morango)\nmorango2 <- morango \nmorango2[10] <- NA\n\n# Histograma\n hist(morango2)\n# Diagrama de ramo e folhas\nstem(morango2)## \n##   The decimal point is 2 digit(s) to the right of the |\n## \n##   5 | 79999\n##   6 | 0023334\n##   6 | 556689\n##   7 | 344\n##   7 | 6777899\n##   8 | 233\n# Box-plot\nboxplot(morango2)"},{"path":"estbas.html","id":"comparação-médiamediana","chapter":"Capítulo 6 Estatística Básica","heading":"6.4 Comparação média/mediana","text":"O exemplo 6.7 ilustra um fato importante sobre média como medida de centro: ela é muito sensível observações extremas, como em uma distribuição assimétrica ou na presença de valores atípicos.Como média não pode resistir à influência de observações extremas, dizemos que ela não é uma medida resistente de centro.Ao contrário, mediana é influenciada apenas pelo número total de pontos de dados e pelo valor numérico ponto, ou pontos, localizado centro da distribuição.média e mediana de uma distribuição razoavelmente simétrica estão bem próximas uma da outra.Se distribuição exatamente simétrica, média e mediana serão exatamente iguais.Em uma distribuição assimétrica, média está, em geral, numa posição mais extrema na cauda longa que mediana.Assim como média, o desvio-padrão s não é resistente. Algumas observações atípicas podem tornar s bastante grande.Como o desvio-padrão mede dispersão em torno da média, deve ser usado apenas quando média escolhida como medida de centro.","code":""},{"path":"introdução-à-inferência.html","id":"introdução-à-inferência","chapter":"Capítulo 7 Introdução à inferência","heading":"Capítulo 7 Introdução à inferência","text":"inferência estatística fornece métodos para se tirarem conclusões sobre uma população partir de dados amostrais.Intervalos de confiança: para se estimar o valor de um parâmetro de uma população;Testes de significância ou Teste de hipóteses: para se avaliar evidência favor ou contra uma afirmativa sobre uma população.Assim, o objetivo de uma amostragem é inferirmos, partir dos dados amostrais, alguma conclusão sobre população mais ampla que amostra representa, associada uma probabilidade.Nos exemplos deste capítulo, utilizaremos população descrita início capítulo 6. Também iremos utilizar um processo de amostragem aleatório para extrair amostra(s) desta população.","code":""},{"path":"introdução-à-inferência.html","id":"intervalo-de-confiança-para-a-média-populacional","chapter":"Capítulo 7 Introdução à inferência","heading":"7.1 Intervalo de Confiança para a média populacional","text":"O Intervalo de Confiança (IC) é uma estimativa de um intervalo que contém um parâmetro populacional.Utilizaremos função t.test para calcular um Intervalo de Confiança para média.Exemplo 7.1  (Intervalo de Confiança para média) Considere o conjunto de dados dap.csv. Por serem dados de uma população, vamos fazer uma amostragem (sample) de 10 indivíduos e calcular o IC de 95% 24.O output da função t.test contém muitas informções, mas por hora, vamos nos focar apenas intervalo de confiança, indicado pelo texto 95 percent confidence intervalAssim, o intervalo de confiança para média populacional desta amostra está entre 12.02 e 14.63. Em outras palavras, estamos 95% confiantes que média populacional DAP de árvores de Mogno Africano está compreendidade entre 12.02 cm e 14.63 cm.O valor da média amostral, 13.33 cm, é estimativa central e pode ser entendida como uma estimativa não enviesada da média populacional.amostra deste exemplo vem de uma população conhecida, cuja média populacional é 12.95 cm. Vejam que média amostral e média populacional diferem entre si, mas o IC calculado contém média populacional.interpretação que devemos fazer IC de 95% é que 95 em 100 amostras feitas na população irão conter média populacional. Vejamos explicação exemplo 7.2 com o uso de simulação.Exemplo 7.2  (Intervalo de Confiança para média - simulações) Considere o conjunto de dados dap.csv.Inicialmente, criamos uma função que faz uma amostragem de n elementos e retorna os valores inferior e superior IC calculado.Em seguida, com o uso da função replicate, realizamos 10025 simulações deste processo:Quantos dos IC simulados não contém verdadeira média26 populacional?Por meio de uma análise gráfica:\nFigura 7.1: Intervalos de confiança simulados para várias amostragens de uma população. média populacional é representada pela linha vertical violeta.\nCalculando proporção de ICs que não contém média populacional:Estes resultados mostram que 6 dos 100 ICs simulados não contém média populacional. Para um IC de 95%, está\nbem próximo valor esperado.Também é possível alterar probabilidade IC, com o argumento conf.level da função t.test.O Intervalo de confiança para média com 99% de probabilidade está entre 11.45 e 15.2. Estamos 99% confiantes de que o valor da média populacional esteja entre 11.45 e 15.2. Observe que o intervalo IC é maior quando aumentamos o nível de significância.","code":"\nsample(dap, 10) %>% t.test()## \n##  One Sample t-test\n## \n## data:  .\n## t = 23.04, df = 9, p-value = 2.598e-09\n## alternative hypothesis: true mean is not equal to 0\n## 95 percent confidence interval:\n##  12.01668 14.63332\n## sample estimates:\n## mean of x \n##    13.325\n## Função que amostra n elementos e retorna os valores inferior e superior do IC calculado\n## data = conjunto de dados de onde será retirada a amostra\n## n_sample = tamanho da amostra\nic_amostr <- function(data, n_sample, ...) {\n  ic_sample <- sample(data, n_sample) %>% t.test(...)\n  return(ic_sample$conf.int)\n}\n## 100 simulações com a função replicate\nic_simul <- replicate(100, ic_amostr(dap, 10))\n\n## mostrar apenas os primeiros valores do resultado\nic_simul %>%\n  t() %>%\n  head()##          [,1]     [,2]\n## [1,] 12.01668 14.63332\n## [2,] 11.91541 14.35859\n## [3,] 11.74785 14.71015\n## [4,] 11.66021 14.33979\n## [5,] 11.34152 14.68648\n## [6,] 13.02743 15.27057\n(ic_simul[1, ] > mean(dap) | ic_simul[2, ] < mean(dap)) %>% mean()## [1] 0.06\nsample(dap, 10) %>% t.test(conf.level=0.99)## \n##  One Sample t-test\n## \n## data:  .\n## t = 23.04, df = 9, p-value = 2.598e-09\n## alternative hypothesis: true mean is not equal to 0\n## 99 percent confidence interval:\n##  11.44546 15.20454\n## sample estimates:\n## mean of x \n##    13.325"},{"path":"introdução-à-inferência.html","id":"o-teste-t-para-uma-amostra","chapter":"Capítulo 7 Introdução à inferência","heading":"7.2 O teste t para uma amostra","text":"O teste t para uma amostra compara uma média amostral com um valor sob hipótese nula.O teste é planejado para se avaliar força da evidência contra hipótese nula, ou seja, hipótese nula é verdadeira até que se prove o contrário.Como regra de decisão, comparamos o p-valor teste com um valor de probabilidade definido anteriormente, formalmente conhecido como α.Se p-valor < α então rejeito hipótese H0Se p-valor >= α então não rejeito hipótese H0O p-valor é definido como probabilidade calculada de que, supondo hipótese nula verdadeira, o teste assuma um valor tão ou mais extremo que o valor realmente observado. Em outras palavras, é o menor valor de α para o qual ainda rejeitamos hipótese H0.O valor de α mais comumente utilizado é de 0,05 ou 5%. entanto, dependendo da área de conhecimento, este valor pode ser maior ou menor.Antes de realizar qualquer teste de hipóteses, como o teste t, hipóteses devem ser claramente descritas.Hipóteses:\n* H0: hipótese nula, ou seja, afirmativa ser testada.H1 ou Ha: hipótese alternativa, ou seja, uma afirmativa que contradiz hipótese nula.hipóteses alternativas podem ter três configurações, conforme o tipo teste:Teste bilateral: quando H1 afirma que o valor é diferente valor da hipótese nula;Teste unilateral à direita: quando H1 afirma que o valor é maior que o valor da hipótese nula;Teste unilateral à esquerda: quando H1 afirma que o valor é menor que o valor da hipótese nula.Exemplo 7.3  (Teste t para uma amostra) Considere o conjunto de dados dap.csv. Faça uma amostra de 10 indivíduos da população e verifique hipótese de que média amostral difere da média populacional.Primeiramente, devemos estabelecer hipóteses:H0: esta amostra vem de uma população cuja média populacional é igual 12.95H1: esta amostra vem de uma população cuja média populacional é diferente de 12.95Na função t.test, passamos o valor da média da hipótese H0 para o argumento mu. Neste exemplo, vamos passar na forma de uma função mean(dap) para evitar arredondamentos.média desta amostra é 13.33 cm. Este valor difere (numericamente) da média populacional de 12.95 cm. entanto, o p-valor teste de 0.528 nos leva não rejeitar hipótese H0, ou seja, não há evidências de que média amostral seja estatisticamente diferente da média populacional, como esperado.Vejamos como podemos interpretar o teste t com o uso de simulações:Exemplo 7.4  (Teste t para uma amostra - simulações) Considere o conjunto de dados dap.csv.Criamos uma função que faz uma amostragem de n elementos e retorna o p-valor teste t.Em seguida, procedemos com 100 simulações teste t como descrito Exemplo 7.3.Em quantas amostras o valor da média amostral é estatisticamente diferente que o valor da média sob hipótese nula? Utilize 5% de probabilidade.Por meio de uma análise gráfica:\nFigura 5.15: p-valores simulados para várias amostragens de uma população. probabilidade de 5% é representada pela linha vertical verde.\nCalculando proporção de p-valores menores que o α pré-estabelecido de 5%:Os resultados mostram que em 6 de 100 amostras o teste t rejeitou hipótese nula, ou seja, indicou uma diferença significativa entre média amostral e média populacional.","code":"\nsample(dap, 10) %>% t.test(mu = mean(dap))## \n##  One Sample t-test\n## \n## data:  .\n## t = 0.65612, df = 9, p-value = 0.5282\n## alternative hypothesis: true mean is not equal to 12.94553\n## 95 percent confidence interval:\n##  12.01668 14.63332\n## sample estimates:\n## mean of x \n##    13.325\n## Função que amostra n elementos e retorna o p-valor do teste t\n## data = conjunto de dados de onde será retirada a amostra\n## n_sample = tamanho da amostra\nt1_amostr <- function(data, n_sample, ...) {\n  ic_sample <- sample(data, n_sample) %>% t.test(...)\n  return(ic_sample$p.value)\n}\n## 100 simulações com a função replicate\nt1_simul <- replicate(100, t1_amostr(dap, 10, mu = 12.94553))\n\n## mostrar apenas os primeiros valores do resultado\nhead(t1_simul)## [1] 0.52816007 0.73107989 0.67524680 0.92873704 0.92824148 0.03814826\nmean(t1_simul < 0.05)## [1] 0.06"},{"path":"produção-de-dados.html","id":"produção-de-dados","chapter":"Capítulo 8 Produção de dados","heading":"Capítulo 8 Produção de dados","text":"produção de dados, contexto da bioestatística, nos ajuda responder questões científicas de interesse. Assim, podemos considerar uma das etapas mais importantes método científico, pois mesmo análises mais modernas e rebuscadas não serão capazes de “melhorar” os dados oriundos de estudos mal planejados ou mal executados.Para um planejamento bem elaborado, precisamos responder várias perguntas:Qual o objetivo estudo?Quem é população e quem é amostra?Quais variáveis de interesse?Quais os possíveis resultados?Quais os métodos estatísticos serão utilizados?Quais possíveis fontes de viés destes estudo?Exemplo 8.1  (Mosca das frutas) Pesquisadores da evolução desejam estudar o impacto de diferentes dietas sobre fecundidade de moscas de frutas.O primeiro passo da produção de dados para essa questão é especificação da população que desejamos descrever. Os pesquisadores estão interessados na relação entre dieta e fecundidade, mais que na descrição da espécie de moscas de frutas.Assim, população realmente amostrada poderia ser todas moscas de frutas selvagens mundo ou qualquer subpopulação de moscas de frutas não essencialmente diferente das de frutas selvagens.Os pesquisadores nesse estudo escolheram obter moscas de frutas de uma colônia de reprodução em Massachusetts. vantagem é que população de interesse, nesse caso, é semelhante à usada por outros pesquisadores da área que também encomendaram moscas de frutas dessa mesma colônia. desvantagem é que essas podem não ser representativas da população de moscas de frutas selvagens.O segundo passo envolve escolha que queremos medir: Como quantificamos “fecundidade”?Aqui, fecundidade é definida como habilidade da fêmea de pôr ovos. Para acompanhar essas pequenas criaturas, os pesquisadores mantiveram-nas em frascos que continham um suprimento de alimento representativo das dietas em estudo. O número de ovos postos por fêmea então foi contado, examinando-se o conteúdo de cada frasco.Esses exemplo apresenta um importante problema: nem todos os estudos estatísticos usam amostras extraídas diretamente da população inteira de interesse. Experimentos, em particular, raramente o fazem, devido considerações práticas e éticas.\nOs pesquisadores experimento da mosca de fruta realmente não podiam capturar moscas de todo o mundo. consequência é que conclusões experimento não podem ser estendidas diretamente todas moscas de frutas.Se os resultados podem também se aplicar uma população maior de moscas de frutas (colônia inteira em Massachusetts ou mesmo toda população de moscas de frutas selvagens), é um argumento biológico, não estatístico.","code":""},{"path":"produção-de-dados.html","id":"amostras-e-estudos-observacionais","chapter":"Capítulo 8 Produção de dados","heading":"8.1 Amostras e estudos observacionais","text":"","code":""},{"path":"produção-de-dados.html","id":"planejamentos-amostrais-ruins","chapter":"Capítulo 8 Produção de dados","heading":"8.1.1 Planejamentos amostrais ruins","text":"Antes de tudo, vamos demonstrar alguns planejamentos amostrais ruins. O planejamento amostral mais fácil — mas não o melhor — apenas escolhe os indivíduos mais à mão. Essa é chamada amostra de conveniência e, em geral, produz dados não representativos.Exemplo 8.2  (Amostra de conveniência) Se estivéssemos interessados em descobrir o percentual de adultos que tomam vitaminas e suplementos minerais, por exemplo, poderíamos ir um shopping e perguntar às pessoas que encontrássemos. entanto, uma amostra em um shopping certamente super-representará classe média e pessoas aposentadas e sub-representará pessoas mais pobres. Isto acontecerá em quase todas vezes que extrairmos tal amostra, ou seja, é um erro sistemático causado por um planejamento amostral ruim, não apenas por má sorte em uma amostra.Outro planejamento amostral viesado, amostra de resposta voluntária, permite que os indivíduos escolham se participam ou não.Todas pesquisas de resposta escrita, telefonemas ou online são exemplos de amostras de resposta voluntária.Esses tipos de amostra são viesados porque pessoas com opiniões fortes tendem responder mais. questão é que pessoas que se dão o trabalho de responder um convite aberto não são, em geral, representativas de qualquer população claramente definida.Infelizmente, amostras de conveniência e de resposta voluntária tornaram-se muito populares na mídia, porque são baratas e, em geral, (equivocadamente) sensacionalistas.","code":""},{"path":"produção-de-dados.html","id":"amostragem-aleatória","chapter":"Capítulo 8 Produção de dados","heading":"8.1.2 Amostragem aleatória","text":"Uma amostra aleatória, ou seja, escolhida pelo acaso, não permite nem o favoritismo por quem faz amostra, nem autosseleção por parte de quem responde. escolha de uma amostra aleatória ataca o viés, ao atribuir todos os indivíduos mesma chance de serem escolhidos.Amostra Aleatória Simples Consiste em n indivíduos da população, escolhidos de tal maneira que todos os conjuntos de n indivíduos tenham mesma chance de serem selecionados.Amostra Aleatória EstratificadaFazer amostras de grupos importantes dentro da população e, então, combiná-las. Os indivíduos selecionados de cada grupo devem ser proporcionais à sua participação na população.Por exemplo, podemos amostrar grupos étnicos em um primeiro nível e depois amostrar homens e mulheres separadamente em um segundo nível.Este processo garante inclusão tanto de grupos majoritários quanto minoritários.Amostra Aleatória de Múltiplos EstágiosEnvolve escolha de Amostras Aleatórias Simples (AAS) dentro de Amostras Aleatórias Simples.Por exemplo, deseja-se amostrar estudantes ensino fundamental de todo o Brasil para um estudo. Primeiro, escolhe-se uma AAS dos Estados Brasil. Para cada Estado, escolhe-se uma AAS das escolas. Para cada escola, extrai-se uma AAS de estudantes.Isso é mais prático que seleção direta de uma AAS de estudantes de todas partes.","code":""},{"path":"produção-de-dados.html","id":"estudos-observacionais","chapter":"Capítulo 8 Produção de dados","heading":"8.2 Estudos observacionais","text":"Nos estudos observacionais, o pesquisador mede mas não intervém estudo, ou seja, apenas observa os acontecimentos naturais.\nOs principais tipos de estudos observacionais são o Controle de caso e Coorte.","code":""},{"path":"produção-de-dados.html","id":"estudo-de-controle-de-caso","chapter":"Capítulo 8 Produção de dados","heading":"8.2.1 Estudo de Controle de Caso","text":"Em um estudo observacional de controle de caso, sujeitos-caso são selecionados com base em um resultado definido, e um grupo de controle de sujeitos é selecionado separadamente para servir como linha de base com qual o grupo-caso é comparado.Os estudos de controle de caso começam com duas amostras de indivíduos, selecionados por seus diferentes resultados, e procura por fatores de exposição passado dos indivíduos que difiram entre os dois grupos. É chamada de abordagem retrospectiva, pois o estudo se inicia já como resultado observado.O principal desafio está na identificação de uma amostra aleatória de indivíduos-controle similares, tanto quanto possível, aos sujeitos-caso.É bastante utiliizado quando resposta observada é rara na população. Por exemplo, um traço encontrado em cerca de um em mil indivíduos exigiria uma amostra aleatória de dez mil para se observar, talvez, cerca de dez indivíduos com o traço de interesse.Exemplo 8.3  (Aflatoxicose Quênia) Aflatoxinas são compostos tóxicos secretados por um fungo encontrado em cultivos doentes. aflatoxicose é um raro, mas grave envenenamento, que resulta da ingestão de aflatoxinas em alimento contaminado.O Quênia teve um surto de aflatoxicose em 2004, que resultou em mais de três mil casos de falência de fígado. O Ministério da Saúde Quênia suspeitou que armazenagem imprópria milho fosse, em parte, responsável pelo surto.\nPerguntou-se 40 pacientes-caso e 80 controles saudáveis como tinham armazenado e preparado o milho.Os pacientes-caso foram selecionados aleatoriamente de uma lista de indivíduos admitidos em um hospital durante o surto de 2004, devido à icterícia aguda inexplicada.seleção dos controles foi cuidadosamente pensada, de modo que fossem tão semelhantes quanto possível aos pacientes-caso, de forma relevante: indivíduos da mesma aldeia paciente que não haviam tido qualquer história de sintomas de icterícia.seleção de indivíduos que viviam na mesma aldeia garantia que os sujeitos-controle partilhassem o mesmo solo, microclima e práticas agrícolas que os pacientes-caso.Uma análise descritiva preliminar dos dados surto sugeria que o solo, o microclima e práticas agrícolas poderiam ser fatores influentes, mas não idade e o gênero.Uma conclusão estudo foi que armazenagem imprópria milho estava associada uma taxa mais alta de aflatoxicose.O estudo da aflatoxicose teve controles cuidadosamente selecionados, permitindo ao pesquisador encontrar causas plausíveis para epidemia.Na abordagem retrospectiva, deve-se tomar muito cuidado pois memórias não são sempre precisas, e o viés de lembrança pode ser um fator de confundimento. Por exemplo, os indivíduos hospitalizados por falência aguda fígado podem ter lembranças diferentes das dos sujeitos-controle, possivelmente porque o assunto interessa mais eles.","code":""},{"path":"produção-de-dados.html","id":"estudo-de-coorte","chapter":"Capítulo 8 Produção de dados","heading":"8.2.2 Estudo de Coorte","text":"Em um estudo de coorte, sujeitos semelhantes são arrolados e observados em intervalos regulares, durante um longo período.Esses são estudos prospectivos, que registram, em intervalos regulares, toda espécie de informação relevante sobre os participantes estudo.Quando o estudo termina, os indivíduos que desenvolveram uma condição são, então, comparados com os não afetados.Diferentemente dos estudos de controle de caso, os estudos de coorte são muito caros e se adaptam melhor à investigação de resultados comuns.Exemplo 8.4  (Estudo da Saúde de Enfermeiras) O Estudo da Saúde de Enfermeiras é um dos maiores estudos observacionais prospectivos, destinado ao exame de fatores que possam afetar principais doenças crônicas femininas.Desde 1976, o estudo acompanhou uma coorte de mais de 100.000 enfermeiras registradas, com ideia de que enfermeiras seriam capazes de responder com precisão questionários com formulação médica.cada dois anos, enfermeiras que participavam estudo recebiam um questionário de acompanhamento sobre doenças e tópicos relativos à saúde, como dieta e estilo de vida. taxas de resposta ao questionário são de cerca de 90%, para cada ciclo de dois anos.Uma das descobertas estudo foi de que prática de caminhada, quando tinham entre 50 e 60 anos, melhorou sua memória aos 70 anos.Apesar pedido para que essas mulheres fizessem um teste cognitivo, o planejamento estudo ainda era observacional, porque todas mulheres amostradas faziam o teste, e os pesquisadores não alocavam aleatoriamente diferentes regimes de caminhada.Na verdade, eles observaram que mulheres que caminharam mais durante seus 50 e 60 anos terminavam com melhor memória na idade de 70 anos ou mais.Por exemplo, pode ser que mulheres com melhor saúde fossem também mais capazes de caminhar e menos propensas à perda de memória. Portanto, não podemos concluir, sem ambiguidade, que caminhar tenha efeito de proteção contra perda de memória.","code":""},{"path":"produção-de-dados.html","id":"planejamento-de-experimentos","chapter":"Capítulo 8 Produção de dados","heading":"8.3 Planejamento de Experimentos","text":"Os indivíduos estudados em um experimento são, em geral, chamados sujeitosAs variáveis explicativas em um experimento são chamadas fatores.Um tratamento é uma condição experimental específica aplicada aos sujeitos.Se um experimento tiver vários fatores, um tratamento será uma combinação de valores específicos de cada fator.Exemplo 8.5  (Efeito protetor da dieta Mediterrâneo) populações mediterrâneas são conhecidas por terem menos doenças coração e alguns tipos de câncer. Sua dieta, rica em fibras naturais, vitaminas e ácido oleico, tem sido apontada como uma explicação desse fenômeno.Para testar essa hipótese, um experimento associou 605 sobreviventes de um primeiro ataque cardíaco para seguirem, por cinco anos, uma dieta tipo Mediterrâneo ou uma dieta da Associação Americana Coração.Os pacientes foram avaliados regularmente, e uma variedade de resultados foi registrada, desde níveis de ácido graxo plasma até ocorrências de câncer ou ataque coração ou morte (cardíaca, câncer ou outra).associação uma ou outra dieta foi aleatória, e os dois grupos não diferiam substancialmente nos aspectos demográficos. Possíveis fatores de confundimento, como fumo e níveis de atividade, foram monitorados de perto e incluídos na análise estatística, mas não foram restringidos ou impostos.Há um único fator: “dieta”.Há um único fator: “dieta”.Esse experimento compara dois tratamentos: dieta Mediterrâneo e dieta AAC.Esse experimento compara dois tratamentos: dieta Mediterrâneo e dieta AAC.Os sujeitos são sobreviventes de um primeiro ataque cardíaco,Os sujeitos são sobreviventes de um primeiro ataque cardíaco,Há muitas variáveis resposta, registradas durante cinco anos, como câncer e ataque coração.Há muitas variáveis resposta, registradas durante cinco anos, como câncer e ataque coração.Exemplo 8.6  (Efeito da variedade milho e teor proteico crescimento de pintinhos) Novas variedades de milho, com conteúdo de aminoácido alterado, podem ter maior valor nutricional que o milho padrão, que tem baixa quantidade de aminoácido lisina.Um experimento compara duas novas variedades, chamadas opaque-2 e floury-2, com o milho normal.Os pesquisadores misturaram dietas de milho-soja, usando cada tipo de milho em cada um de três níveis de proteína: 12%, 16% e 20%.Eles deram cada dieta 10 pintinhos machos com um dia de nascidos e registraram seus ganhos de peso depois de 21 dias. O ganho de peso dos pintinhos é uma medida valor nutricional da dieta.Esse experimento tem dois fatores: variedade milho, com três níveis (opaque-2, floury-2 e normal), e nível de proteína, com três níveis (12%, 16%, 20%).Esse experimento tem dois fatores: variedade milho, com três níveis (opaque-2, floury-2 e normal), e nível de proteína, com três níveis (12%, 16%, 20%).nove combinações de ambos os fatores formam nove tratamentos.nove combinações de ambos os fatores formam nove tratamentos.Os indivíduos são os pintinhos machos com um diaOs indivíduos são os pintinhos machos com um diaA variável resposta é o ganho de peso depois de 21 dias sob dieta de tratamento.variável resposta é o ganho de peso depois de 21 dias sob dieta de tratamento.","code":""},{"path":"produção-de-dados.html","id":"vantagem-dos-experimentos","chapter":"Capítulo 8 Produção de dados","heading":"8.3.1 Vantagem dos experimentos","text":"Experimentos são o método preferido para o exame efeito de uma variável sobre outra. Pela imposição de um tratamento específico de interesse e controle de outras influências, podemos localizar causa e efeito. Planejamentos estatísticos são, em geral, essenciais para experimentos eficazes. Para entendermos por quê, vamos começar com um exemplo de um mau planejamento.Exemplo 8.7  (Um experimento não controlado) O congelamento gástrico foi introduzido nos anos 1960 por um proeminente cirurgião como método para aliviar dor da úlcera.Os pacientes deviam engolir um balão vazio, posteriormente enchido com um líquido refrigerado, para esfriar o revestimento estômago e reduzir produção de ácido e reduzir dor.Um grupo de sujeitos (os pacientes) foi exposto ao tratamento (congelamento gástrico), e o resultado (redução da dor) foi observado.Sujeitos → Congelamento gástrico → Redução da dorOs procedimentos realizados mostraram que o congelamento gástrico realmente reduzia dor da úlcera, e o tratamento foi recomendado com base nessa evidência.Mas, o que teria acontecido se tivéssemos deixado os pacientes em paz? dor deles teria diminuído mesmo sem intervenção?E se os pacientes fossem inclinados dizer que estavam se sentindo melhor (talvez porque esperassem melhorar ou para agradar o experimentador)?E se os pacientes realmente se sentissem melhor, mas devido ao cuidado e à atenção que recebiam e que os faziam se sentir bem geral, não às condições congelamento revestimento estômago?Essa é uma possibilidade real, e melhoras psicológicas semelhantes foram documentadas em muitos experimentos humanos.Chamamos isso de efeito placebo.O efeito congelamento gástrico é confundido com o de duas variáveis ocultas:melhora natural, espontânea,melhora natural, espontânea,melhora psicológica devido ao cuidado médico.melhora psicológica devido ao cuidado médico.Devido ao confundimento, melhora sujeito não pode ser inequivocamente atribuída ao efeito congelamento gástrico.","code":""},{"path":"produção-de-dados.html","id":"experimentos-comparativos","chapter":"Capítulo 8 Produção de dados","heading":"8.3.2 Experimentos comparativos","text":"solução para o confundimento exemplo anterior é realização de um experimento comparativo:Alguns pacientes fazem o tratamento de congelamento gástricoOutros pacientes semelhantes realizam um processo simulado\nControle em relação ao efeito placebo\nControle em relação ao efeito placeboOutros realizam nenhum procedimento\nControle em relação ao efeito de melhora natural\nControle em relação ao efeito de melhora naturalA maioria dos experimentos bem planejados compara dois ou mais tratamentos.Um grupo experimental é um grupo de indivíduos que recebe um tratamento cujo efeito desejamos entender.Um controle ou testemunha é um tratamento que se destina servir como parâmetro com o qual o grupo experimental é comparado.Um placebo é um tratamento de controle falso (por exemplo, uma pílula de açúcar), mas que não se distingue tratamento grupo experimental.O efeito placebo é documentado apenas em experimentos humanos, em contextos tão diversos como estudo da asma ou pressão sanguínea alta. O efeito é particularmente forte quando variável resposta é dor. Os mecanismos desse efeito mente-corpo são desconhecidos, mas não sem fundamentação biológica. Sabemos que o sistema nervoso interage com o imunológico e que depressão, por exemplo, suprime resposta imune.Exemplo 8.8  (Um experimento controlado) O experimento simples, exemplo anterior, foi seguido, muitos anos depois, por um experimento controlado aleatorizadoPacientes que se submetiam ao congelamento gástrico eram comparados com pacientes semelhantes que se submetiam tratamento semelhante, exceto pelo fato de o líquido bombeado não ser refrigerado (placebo).34% de melhora – congelamento gástrico38% de melhora - placeboEsse experimento comparativo demonstrou que o resfriamento revestimento estômago não era mais eficaz para redução da dor de úlcera que um procedimento falso. O tratamento foi, então, abandonado.","code":""},{"path":"produção-de-dados.html","id":"planejamento-completamente-aleatorizado","chapter":"Capítulo 8 Produção de dados","heading":"8.3.3 Planejamento completamente aleatorizado","text":"Em um planejamento experimental completamente aleatorizado, todos os sujeitos são distribuídos aleatoriamente entre os tratamentos. associação aleatória dos sujeitos forma grupos que devem ser semelhantes em todos os aspectos antes de ser aplicado o tratamento.O planejamento comparativo garante que outras influências, diferentes dos tratamentos experimentais, operem igualmente em todos os grupos. Assim, diferenças na resposta média se devem aos tratamentos ou ao papel acaso na alocação aleatória dos sujeitos aos tratamentos.Essa última afirmativa merece mais reflexão. Mesmo com um excelente planejamento experimental, nunca podemos dizer que qualquer diferença entre dois grupos seja inteiramente devida ao tratamento aplicado. Variáveis, por definição, variam de indivíduo para indivíduo, e, portanto, um grupo de indivíduos certamente fornecerá um resultado diferente de outro grupo, mesmo nas mesmas condições.","code":""},{"path":"produção-de-dados.html","id":"princípios-do-planejamento-experimental","chapter":"Capítulo 8 Produção de dados","heading":"8.3.4 Princípios do planejamento experimental","text":"Os princípios básicos planejamento de experimentos são:Controle os efeitos de variáveis ocultas na resposta de modo mais simples, pela comparação de dois ou mais tratamentos.Controle os efeitos de variáveis ocultas na resposta de modo mais simples, pela comparação de dois ou mais tratamentos.Aleatorize – use o acaso impessoal para associar os sujeitos aos tratamentos.Aleatorize – use o acaso impessoal para associar os sujeitos aos tratamentos.Repita - use sujeitos suficientes em cada grupo para reduzir variação acaso nos resultados.Repita - use sujeitos suficientes em cada grupo para reduzir variação acaso nos resultados.","code":""},{"path":"produção-de-dados.html","id":"planejamentos-de-dados-emparelhados","chapter":"Capítulo 8 Produção de dados","heading":"8.3.5 Planejamentos de dados emparelhados","text":"Um planejamento de dados emparelhados compara exatamente dois tratamentos, usando uma série de indivíduos proximamente relacionados dois dois, ou cada indivíduo duas vezes.Escolha pares de sujeitos que sejam, tanto quanto possível, comparáveis. Esses podem ser indivíduos mesmo gênero, idade, peso e altura ou geneticamente relacionados, como gêmeos ou animais nascidos da mesma ninhada. alocação aleatória dos sujeitos aos tratamentos é feita dentro de cada par, e não para todos os sujeitos ao mesmo tempo. Use o acaso para decidir qual dos sujeitos par recebe o primeiro tratamento. O outro daquele par recebe o outro tratamento. ordem dos tratamentos pode influenciar resposta sujeito, de modo que aleatorizamos ordem para cada sujeito.Às vezes, cada “par” em um planejamento de dados emparelhados consiste em apenas um sujeito, que recebe ambos os tratamentos, um após o outro. Cada sujeito serve como seu próprio controle.Planejamentos completamente aleatorizados são os planejamentos estatísticos mais simples para experimentos. Eles ilustram claramente os princípios de controle, aleatorização e número adequado de sujeitos. Contudo, eles frequentemente são inferiores planejamentos estatísticos mais elaborados. Em particular, emparelhar os sujeitos de várias formas pode produzir resultados mais precisos que uma simples aleatorização.Planejamentos de dados emparelhados usam os princípios de comparação de tratamento e aleatorização. entanto, aleatorização não é completa – não alocamos aleatoriamente todos os sujeitos de uma vez aos dois tratamentos. Em vez disso, aleatorizamos apenas dentro de cada par. Isso permite que o emparelhamento reduza o efeito da variação entre os sujeitos. Ser capaz de distinguir um planejamento de dados emparelhados de um completamente aleatorizado é crítico, pois impacta análise estatística e conclusões.","code":""},{"path":"produção-de-dados.html","id":"planejamento-em-blocos","chapter":"Capítulo 8 Produção de dados","heading":"8.3.6 Planejamento em blocos","text":"Um bloco é um grupo de indivíduos semelhantes em algum aspecto que se espera poder afetar resposta aos tratamentos. Em um planejamento em blocos, alocação aleatória dos indivíduos aos tratamentos é feita separadamente dentro de cada bloco. Um planejamento em blocos combina ideia da criação de grupos de tratamento equivalentes pelo emparelhamento com o princípio de formação aleatória de grupos de tratamento.Blocos são outra forma de controle. Eles controlam os efeitos de algumas variáveis externas ao trazê-las para o experimento na forma de blocos.Exemplo 8.9  (Diferenças de gênero) O progresso de um tipo de câncer difere em mulheres e homens. Assim, um experimento clínico para comparação de três terapias para esse câncer trata gênero como uma variável de bloco. São feitas duas aleatorizações separadas, uma que associa os sujeitos mulheres aos tratamentos e outra que associa os homens.Os blocos permitem que se extraiam conclusões separadas sobre cada um deles, por exemplo, sobre homens e mulheres. Também permitem conclusões gerais mais precisas, porque diferenças sistemáticas entre homens e mulheres podem ser removidas quando estudamos os efeitos gerais das três terapias.Um pesquisador experiente formará blocos com base nas mais importantes e inevitáveis fontes de variabilidade entre unidades experimentais. aleatorização, então, fará média dos efeitos da variação restante e permitirá uma comparação não viesada dos tratamentos.","code":""},{"path":"produção-de-dados.html","id":"cuidados-com-a-experimentação","chapter":"Capítulo 8 Produção de dados","heading":"8.3.7 Cuidados com a experimentação","text":"O sucesso de um experimento depende de nossa capacidade de tratar todos os sujeitos de forma idêntica em todos os aspectos, exceto pelos tratamentos que, de fato, estão sendo comparados. Viés experimentador ou sujeito são problemas reais, que podem prejudicar experimentos e estudos observacionais. Viés pessoal pode desviar nossas percepções e coleta de dados em observações de campoUma forma de evitar estes vieses é utiliação dos experimentos duplos-cegos.\nNestes experimentos, nem os sujeitos e nem pessoas que interagem com eles sabem qual tratamento cada um está recebendo. Na prática, entanto, controles ótimos não são sempre alcançáveis. Há situações em que o uso de um placebo é antiético.O cegamento nem sempre é prático. Imagine complexidade de se manter o acompanhamento de pílulas ativas e inativas para vários tratamentos diferentes sob condições de duplo-cego, envolvendo centenas de sujeitos, durante vários anos. O cegamento nem sempre é uma opção se os pacientes são capazes de diferenciar o tratamento de um falso.Contudo, fraqueza potencial mais séria de experimentos é falta de realismo. Os sujeitos, tratamentos ou contexto de um experimento podem não duplicar realisticamente condições que, de fato, desejamos estudar.Exemplo 8.10  (Carcinogenicidade da sacarina) carcinogenicidade de um produto é sua propensão induzir o câncer quando usado, ingerido ou simplesmente presente ambiente. sacarina tem sido usada como adoçante artificial por quase um século.Devido à evidência experimental de carcinogenicidade em ratos, sacarina foi incluída Relatório sobre cancerígenos dos Estados Unidos em 1981, como potencial cancerígeno em humanos.entanto, exames mais detalhados de cânceres de bexiga urinária observados em ratos indicam que o mecanismo biológico desse câncer é específico para o sistema urinário de ratos e relacionado com o consumo de sacarina em concentrações improváveis de representar consumo humano realista.sacarina foi oficialmente retirada da lista em 2005, com conclusão: “os fatores que se pensava contribuir para indução de tumor pela sacarina sódica em ratos não têm ocorrência esperada em humanos”.falta de realismo pode limitar nossa capacidade de aplicar conclusões de um experimento contextos de maior interesse. Muitos pesquisadores desejam generalizar suas conclusões algum contexto mais amplo que o experimento real.análise estatística de um experimento não pode nos dizer até que ponto os resultados podem ser generalizados. capacidade de se estender conclusões para além contexto experimental depende de uma profunda discussão dos méritos biológicos experimento e da representatividade dos sujeitos usados.","code":""},{"path":"produção-de-dados.html","id":"ética-na-experimentação","chapter":"Capítulo 8 Produção de dados","heading":"8.3.8 Ética na experimentação","text":"Desde humanos animais e ecossistemas, experimentação precisa ser cuidadosamente pensada, não apenas para ser estatisticamente poderosa e elegante, mas também para ser responsável. ética experimental trata de todas questões que devemos fazer antes, durante e depois da experimentação.","code":""},{"path":"testes-para-duas-amostras.html","id":"testes-para-duas-amostras","chapter":"Capítulo 9 Testes para duas amostras","heading":"Capítulo 9 Testes para duas amostras","text":"","code":""},{"path":"testes-para-duas-amostras.html","id":"teste-t-para-dados-emparelhados","chapter":"Capítulo 9 Testes para duas amostras","heading":"9.1 Teste t para dados emparelhados","text":"Para comparar respostas aos dois tratamentos em um planejamento de dados emparelhados, determine diferença entre respostas em cada par. Em seguida, aplique o procedimento t de uma amostra essas diferenças.Exemplo 9.1  (Teste t para dados emparelhados) Pesquisadores perguntaram se odores agradáveis teriam o efeito de melhorar o desempenho de estudantes.Vinte e um sujeitos trabalharam em um labirinto com lápis e papel, usando uma máscara inodora ou com perfume floral, em ordem aleatória.Há evidência de que os sujeitos resolveram o labirinto mais depressa usando máscara com perfume?Os dados podem ser encontrados arquivo floral.xlsxAlternativamente, o teste t pode ser aplicado às diferenças entre respostas de cada par.Os dados não apoiam afirmativa (p-valor = 0,73) de que perfumes florais melhorem o desempenho.média tempo de execução labirinto com perfume foi de 49.06A média tempo de execução labirinto sem perfume foi de 50.01O IC para diferença foi de -4,75 +6,66 segundos.melhora média (amostral) foi de apenas 0,95 segundos.","code":"\nfloral <- readxl::read_excel(\"data/floral.xlsx\")\n\nt.test(floral$sem, floral$com, paired=TRUE)## \n##  Paired t-test\n## \n## data:  floral$sem and floral$com\n## t = 0.34938, df = 20, p-value = 0.7305\n## alternative hypothesis: true mean difference is not equal to 0\n## 95 percent confidence interval:\n##  -4.755061  6.668394\n## sample estimates:\n## mean difference \n##       0.9566667\nt.test(floral$sem - floral$com)## \n##  One Sample t-test\n## \n## data:  floral$sem - floral$com\n## t = 0.34938, df = 20, p-value = 0.7305\n## alternative hypothesis: true mean is not equal to 0\n## 95 percent confidence interval:\n##  -4.755061  6.668394\n## sample estimates:\n## mean of x \n## 0.9566667"},{"path":"testes-para-duas-amostras.html","id":"teste-t-para-duas-amostras","chapter":"Capítulo 9 Testes para duas amostras","heading":"9.2 Teste t para duas amostras","text":"O fato de uma diferença observada entre duas médias amostrais ser surpreendente depende da dispersão das observações, bem como das duas médias.Médias muito diferentes podem ocorrer apenas devido ao acaso, se observações individuais variarem bastante.Exemplo 9.2  (Teste t para duas amostras) Latas de alumínio são feitas partir de grandes lingotes sólidos, prensados sob rolos de alta pressão e cortados como biscoitos partir de folhas finas.Uma companhia afirma que um novo processo de fabricação diminui quantidade de alumínio necessária para se fazer uma lata e, portanto, diminui o peso.Obtiveram-se amostras aleatórias independentes de latas de alumínio feitas pelos processos velho e novo, e o peso (em gramas) de cada uma é dado arquivo lata.xlsx.Há alguma evidência de que latas de alumínio feitas pelo novo processo tenham um peso médio populacional menor?Há evidências (p-valor = 0,013) de que latas de alumínio fabricadas pelo processo novo sejam mais leves que fabricadas pelo processo antigo.O Intervalo de Confiança de 95% para diferença de peso entre latas fabricadas pelo processo novo e antigo é de 0,10 0,82 gramas mais leve pelo processo novo.","code":"\nlata <- readxl::read_excel(\"data/lata.xlsx\")\n\nt.test(lata$antigo, lata$novo)## \n##  Welch Two Sample t-test\n## \n## data:  lata$antigo and lata$novo\n## t = 2.587, df = 39.742, p-value = 0.01345\n## alternative hypothesis: true difference in means is not equal to 0\n## 95 percent confidence interval:\n##  0.1002432 0.8168996\n## sample estimates:\n## mean of x mean of y \n##  14.30857  13.85000"},{"path":"anova.html","id":"anova","chapter":"Capítulo 10 Análise de Variância","heading":"Capítulo 10 Análise de Variância","text":"Os procedimentos t de duas amostras comparam médias de duas populações ou respostas médias dois tratamentos em um experimento.Naturalmente, os estudos nem sempre comparam apenas dois grupos. Precisamos de um método que compare qualquer quantidade de médias.","code":""},{"path":"anova.html","id":"comparação-de-várias-médias","chapter":"Capítulo 10 Análise de Variância","heading":"10.1 Comparação de várias médias","text":"Os métodos estatísticos para lidar com comparações múltiplas geralmente apresentam dois passos:1.Um teste geral para verificarmos se há boa evidência de quaisquer diferenças entre os parâmetros que desejamos comparar.2.Uma análise de acompanhamento detalhada para decidirmos quais parâmetros são diferentes e estimarmos o tamanho das diferenças.","code":""},{"path":"anova.html","id":"a-ideia-da-análise-de-variância","chapter":"Capítulo 10 Análise de Variância","heading":"10.2 A ideia da Análise de Variância","text":"Considere população com 150 árvores pertencente um reflorestamento de Mogno Africano (Capítulo 6).Suponha que retiremos 5 amostras aleatórias desta população com 8 indivíduos em cada amostra.Estes dados podem ser encontrados arquivo dap5.csvUma Análise de Variância pode ser executada com funções lm e anova, como seguir:Queremos testar hipótese nula de que não há diferenças entre os diâmetros médios das cinco populações de onde amostras foram retiradas:H0:μ1 = μ2 = μ3 = μ~~4 = μ5A hipótese alternativa é de que há alguma diferença, isto é, nem todas três médias populacionais são iguais:H1: nem todas médias μ são iguaisA priori, sabemos que cinco amostras foram aleatoriamente retiradas da mesma população. Logo, o teste F da Análise de Variância é não significativo (como esperado). Seu p-valor foi de 0.73 e, por isso, não rejeitamos hipótese H0, ou seja, não há evidências que os diâmetros médios das amostras sejam diferentes ou que venham de populações diferentes.Mas o que occoreria se houvesse um efeito aditivo em cada uma das amostras?\nVamos supor que amostra 1 tenha um efeito aditivo de +5 unidades DAP. amostra 2 de -5, amostra 3 de +3, amostra 4 de +2 e, por fim, amostra 5 não tenha nenhum efeito aditivo. O resultado é este mostrado arquivo dap5p.csvA Análise de Variância, com estes valores atualizados, fica assim:Para mesmas hipóteses anteriores, o teste F da Análise de Variância é significativo (p-valor ~ 0). Neste caso, rejeitamos hipótese H0 e podemos concluir que há evidências de que amostras tenham médias de diâmetro diferentes ou que seja oriundas de populações diferentes.","code":"\naov_dap5 <- lm(dap ~ amostra, data = dap5)\n\nanova(aov_dap5)## Analysis of Variance Table\n## \n## Response: dap\n##           Df  Sum Sq Mean Sq F value Pr(>F)\n## amostra    4   7.371  1.8428  0.5075 0.7305\n## Residuals 35 127.091  3.6312\naov_dap5p <- lm(dap ~ amostra, data = dap5p)\nanova(aov_dap5p)## Analysis of Variance Table\n## \n## Response: dap\n##           Df Sum Sq Mean Sq F value    Pr(>F)    \n## amostra    4 482.71 120.678  33.234 1.791e-11 ***\n## Residuals 35 127.09   3.631                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"anova.html","id":"análise-de-variância-para-um-fator","chapter":"Capítulo 10 Análise de Variância","heading":"10.3 Análise de Variância para um fator","text":"Exemplo 10.1  (Análise de Variância para um fator) Pesquisadores estudaram relação entre variedades da flor tropical Heliconia, na ilha de Dominica, e diferentes espécies de beija-flores que fertilizam essas flores.Acredita-se que os comprimentos das flores e formas dos bicos dos beija-flores evoluíram juntos e se adaptaram uns aos outros.Se isso verdade, variedades de flores fertilizadas por diferentes espécies de beija-flores devem ter diferentes distribuições de comprimentos.O arquivo bflor.xlsx fornece medidas de comprimentos (em milímetros, mm) para amostras de três variedades de Heliconia, cada uma fertilizada por uma espécie diferente de beija-flor. espécies são:Heliconia bihaiHeliconia caribaea vermelhaHeliconia caribaea amarelaEm particular, os comprimentos médios de suas flores são diferentes?três variedades têm distribuições com comprimentos diferentes?Queremos testar hipótese nula de que não há diferenças entre os comprimentos médios das três populações de flores:H0: μ1 = μ2 = μ3A hipótese alternativa é de que há alguma diferença, isto é, nem todas três médias populacionais são iguais:H1: nem todas μ1, μ2 e μ3 são iguaisIniciemos com uma análise exploratória:Efetuamos Análise de Variância propriamente dita:CONCLUSÃO: Há forte evidência de que três variedades de flores não tenham, todas, o mesmo comprimento médio.O teste F não diz quais das três médias são significantemente diferentes. Aparentemente, pela nossa análise de dados preliminar, flores da bihai são visivelmente maiores que da vermelha ou da amarela.flores vermelhas e amarelas são muito próximas, mas vermelhas tendem ser mais compridas.","code":"\nbflor <- readxl::read_excel(\"data/bflor.xlsx\") %>%\n  mutate(especie = factor(especie))\n\n\nbflor %>%\n  group_by(especie) %>%\n  summarise(\n    n = n(),\n    media = mean(comprimento),\n    desvpad = sd(comprimento),\n    var = var(comprimento)\n  )## # A tibble: 3 × 5\n##   especie     n media desvpad   var\n##   <fct>   <int> <dbl>   <dbl> <dbl>\n## 1 Hb         16  47.6   1.21  1.47 \n## 2 Hca        15  36.2   0.975 0.951\n## 3 Hcv        23  39.7   1.80  3.24\nboxplot(comprimento ~ especie, data = bflor)\naov_bflor <- lm(comprimento ~ especie, data = bflor)\nanova(aov_bflor)## Analysis of Variance Table\n## \n## Response: comprimento\n##           Df  Sum Sq Mean Sq F value    Pr(>F)    \n## especie    2 1082.87  541.44  259.12 < 2.2e-16 ***\n## Residuals 51  106.57    2.09                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"anova.html","id":"condições-para-a-anova","chapter":"Capítulo 10 Análise de Variância","heading":"10.4 Condições para a ANOVA","text":"Temos k AASs independentes, uma de cada uma das k populações.Como de costume, o planejamento da produção dos dados é condição mais importante para inferência. Uma amostragem viesada ou confundimento pode tornar qualquer inferência sem sentido.Cada uma das k populações tem uma distribuição Normal com média desconhecidaProcedimentos para comparação de médias não são muito sensíveis à falta de Normalidade. Anova torna-se mais segura à medida que os tamanhos das amostras aumentam. Quando não houver valores atípicos e distribuições forem aproximadamente simétricas, podemos usar Anova com segurança.Todas populações têm o mesmo desvio-padrão \\(\\sigma\\), de valor desconhecido.terceira condição é problemática. Não é fácil verificar condição de igualdade dos desvios-padrão populacionais.\nTestes estatísticos de igualdade dos desvios-padrão são tão sensíveis à ausência de Normalidade que, na prática, têm pouco valor.Mas, qual é gravidade de os desvios-padrão serem desiguais?Anova não é muito sensível violações da condição, particularmente quando todas amostras têm tamanhos iguais ou semelhantes e nenhuma delas é muito pequena.\nAo planejar um estudo, tente tomar amostras mesmo tamanho aproximado de todos os grupos que pretende comparar e não utilize amostras muito pequenas.Certifique-se, antes de fazer Anova, de que os desvios-padrão amostrais sejam, pelo menos, semelhantes entre si.\nComo regra prática: maior desvio-padrão não seja o dobro (ou triplo) menor.Exemplo 10.2  (Verificação pressuposto da Normalidade) ..Pela análise conjunto dos resultados acima, não há evidência de desvio severo da Normalidade.Exemplo 10.3  (Verificação pressuposto da homogeneidade das variâncias) .Pela análise conjunto dos resultados acima, não há evidência de não homogeneidade das variâncias.","code":"\n## curtose\naov_bflor %>% residuals() %>% moments::kurtosis()## [1] 2.349862\n## assimetria\naov_bflor %>% residuals() %>% moments::skewness()## [1] 0.5223018\n## Teste de Shapiro-Wilk\naov_bflor %>% residuals() %>% shapiro.test()## \n##  Shapiro-Wilk normality test\n## \n## data:  .\n## W = 0.94889, p-value = 0.02227\n## Gráfico dos quantis normais\naov_bflor %>% residuals() %>% qqnorm()\naov_bflor %>% residuals() %>% qqline()\n## Histograma\naov_bflor %>% residuals() %>% hist()\n## Ramo e folhas\naov_bflor %>% residuals() %>% stem()## \n##   The decimal point is at the |\n## \n##   -2 | 3\n##   -1 | 98776666553200\n##   -0 | 9988877655522111\n##    0 | 1355666788999\n##    1 | 8\n##    2 | 00223557\n##    3 | 4\n## razão maior/menor desvio-padrão\nbflor %>% group_by(especie) %>% summarise(desvpad=sd(comprimento)) %>%\nmutate(razao=max(desvpad)/desvpad)## # A tibble: 3 × 3\n##   especie desvpad razao\n##   <fct>     <dbl> <dbl>\n## 1 Hb        1.21   1.48\n## 2 Hca       0.975  1.84\n## 3 Hcv       1.80   1\n## boxplot condicional dos resíduos\nboxplot(residuals(aov_bflor)~especie, data = bflor)\n## resíduos vs ajustados\nplot(aov_bflor,1)\n## teste de Bartlett\nbartlett.test(residuals(aov_bflor)~especie, data=bflor)## \n##  Bartlett test of homogeneity of variances\n## \n## data:  residuals(aov_bflor) by especie\n## Bartlett's K-squared = 6.4839, df = 2, p-value = 0.03909\n## teste de Levene\ncar::leveneTest(residuals(aov_bflor)~especie, data=bflor)## Levene's Test for Homogeneity of Variance (center = median)\n##       Df F value  Pr(>F)  \n## group  2  4.3722 0.01768 *\n##       51                  \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"anova.html","id":"testes-de-acompanhamento","chapter":"Capítulo 10 Análise de Variância","heading":"10.5 Testes de acompanhamento","text":"Para sabermos quais tratamentos diferem entre si, utilizamos um teste de acompanhamento (teste post hoc).Entre os mais utilizados, serão tratados neste capítulo os seguintes testes:Teste de DunnettTeste de TukeyContrastes ortogonais","code":""},{"path":"anova.html","id":"teste-de-dunnett","chapter":"Capítulo 10 Análise de Variância","heading":"10.5.1 Teste de Dunnett","text":"Testa os contrastes envolvendo o(s) tratamento(s) testemunha (ou controle ou placebo).Exemplo 10.4  (Teste de Dunnett) homeopatia procura utilizar pequenas doses de substâncias altamente diluídas e geralmente perigosas. Cientistas advertem que há pouca evidência que apoie homeopatia como tratamento eficaz para qualquer condição específica, exceto para uns poucos estudos.Em um desses estudos, os pesquisadores fizeram e suturaram uma incisão muscular profunda em ratos anestesiados e, então, associaram-nos aleatoriamente um de cinco tratamentos:Arnica - dose altaArnica - dose baixaEstafisagria - dose altaEstafisagria - dose baixaPlaceboAs feridas eram examinadas diariamente para se determinar o tempo (em dias) até sua completa cicatrização. Os valores estão arquivo homeopatia.xlsxHá evidência significante de que o tempo de cicatrização dependa tratamento recebido?Após efetuada Análise de Variância e verificados os pressupostos27, segue-se com o teste de DunnettPelo teste de Dunnett, verifica-se que todos os remédios homeopáticos levaram um tempo de cicatrização menor que o tratamento placebo.","code":"\ndn_remedio <- emmeans::emmeans(aov_hom, ~remedio, contr=\"dunnett\", \n                                ref=which(names(table(hom$remedio))==\"Placebo\"))\n\n\n## contrastes\ndn_remedio$contrasts##  contrast                       estimate    SE df t.ratio p.value\n##  (Arnica-alta) - Placebo           -5.67 0.442 70 -12.831  <.0001\n##  (Arnica-baixa) - Placebo          -5.87 0.442 70 -13.284  <.0001\n##  (Estafisagria-alta) - Placebo     -5.73 0.442 70 -12.982  <.0001\n##  (Estafisagria-baixa) - Placebo    -5.53 0.442 70 -12.529  <.0001\n## \n## P value adjustment: dunnettx method for 4 tests\n## intervalo de confiança\ndn_remedio$contrasts %>% confint()##  contrast                       estimate    SE df lower.CL upper.CL\n##  (Arnica-alta) - Placebo           -5.67 0.442 70    -6.78    -4.56\n##  (Arnica-baixa) - Placebo          -5.87 0.442 70    -6.98    -4.76\n##  (Estafisagria-alta) - Placebo     -5.73 0.442 70    -6.84    -4.62\n##  (Estafisagria-baixa) - Placebo    -5.53 0.442 70    -6.64    -4.42\n## \n## Confidence level used: 0.95 \n## Conf-level adjustment: dunnettx method for 4 estimates\n## plot\ndn_remedio$emmeans %>% plot()"},{"path":"anova.html","id":"teste-de-tukey","chapter":"Capítulo 10 Análise de Variância","heading":"10.5.2 Teste de Tukey","text":"Criado por John Tukey (1915–2000), realiza todos os contrastes (comparações) possíveis entre médias populacionais mantendo o nível de significância.Em lugar teste t, utiliza o valor crítico m, que depende número de populações, número de observações e nível de significância.hipóteses testadas são:H0: μi = μjH1: μi ≠ μjpara todas médias populacionaisAinda, há muitos outros teste de comparações múltiplas similares ao teste de Tukey. Se você é capaz de interpretar os resultado deste teste, será capaz de entender os resultados de muitos outros.Exemplo 10.5  (Teste de Tukey) Voltando ao exemplo anterior das Flores de Heliconia 28.Utilizaremos o pacote emmeans para o cálculo teste de Tukey.Tabela abaixo mostra um exemplo de como os resultados teste podem ser apresentados.Podemos concluir que flores da variedade H. bihai tem maior comprimento que demais. flores de H. caribaea vermelha são maiores que H. caribaea amarela. Esta última tem o menor comprimento entre todas.","code":"\ntk_especie <- emmeans::emmeans(aov_bflor, ~especie, contr = \"tukey\")\n\n## contrastes\ntk_especie$contrasts##  contrast  estimate    SE df t.ratio p.value\n##  Hb - Hca     11.42 0.520 51  21.977  <.0001\n##  Hb - Hcv      7.89 0.471 51  16.759  <.0001\n##  Hca - Hcv    -3.53 0.480 51  -7.361  <.0001\n## \n## P value adjustment: tukey method for comparing a family of 3 estimates\n## Intervalo de confiança\ntk_especie$contrasts %>% confint()##  contrast  estimate    SE df lower.CL upper.CL\n##  Hb - Hca     11.42 0.520 51    10.16    12.67\n##  Hb - Hcv      7.89 0.471 51     6.75     9.02\n##  Hca - Hcv    -3.53 0.480 51    -4.69    -2.37\n## \n## Confidence level used: 0.95 \n## Conf-level adjustment: tukey method for comparing a family of 3 estimates\n## letras (CLD)\ntk_especie$emmeans %>% multcomp::cld(Letters = letters)##  especie emmean    SE df lower.CL upper.CL .group\n##  Hca       36.2 0.373 51     35.4     36.9  a    \n##  Hcv       39.7 0.301 51     39.1     40.3   b   \n##  Hb        47.6 0.361 51     46.9     48.3    c  \n## \n## Confidence level used: 0.95 \n## P value adjustment: tukey method for comparing a family of 3 estimates \n## significance level used: alpha = 0.05 \n## NOTE: Compact letter displays can be misleading\n##       because they show NON-findings rather than findings.\n##       Consider using 'pairs()', 'pwpp()', or 'pwpm()' instead.\n## plot\ntk_especie$emmeans %>% plot()"},{"path":"anova.html","id":"teste-de-scott-knott","chapter":"Capítulo 10 Análise de Variância","heading":"10.5.3 Teste de Scott Knott","text":"É um teste de agrupamento que evita ambiguidade causada em algumas situações pelo teste de Tukey, principalmente nos estudos com uma grande quantidade de tratamentos.Utiliza-se o pacote ScottKnott29 para realização teste.Exemplo 10.6  (Teste de Scott Knott) Exemplo de utilização teste de Scott Knott exemplo das flores de Heliconia\n.","code":"\nsk_bflor <- ScottKnott::SK(aov_bflor) \nsk_bflor$out## $Result\n##     Means G1 G2 G3\n## Hb  47.60  a      \n## Hcv 39.71     b   \n## Hca 36.18        c\n## \n## $Sig.level\n## [1] 0.05\n## \n## $Replicates\n## [1] 16 23 15"},{"path":"anova.html","id":"contrastes-ortogonais","chapter":"Capítulo 10 Análise de Variância","heading":"10.5.4 Contrastes ortogonais","text":"O teste de Tukey (e outros testes de comparações múltiplas) fornecem conclusões sobre todos os contrastes possíveis. Alguns (ou muitos) destes contrastes podem não ser de nosso interesse. Outros contrastes de nosso interesse podem ser deixados de lado.Se você tiver questões específicas em mente antes de produzir os dados, é muito mais eficiente planejar análise para responder estas questões.Não use os contrastes para testar todas comparações possíveis!Contrastes só serão válidos se você tiver alguma razão científica para testar uma hipótese em particular antes mesmo de você coletar os dados.Exemplo 10.7  (Contrastes ortogonais) Para detectarmos presença de insetos nocivos nos campos de plantações, podemos colocar cartões cobertos com um material pegajoso e examinar os insetos presos nos cartões.Quais cores mais atraem os insetos?Pesquisadores colocaram seis cartões de quatro cores (Amarelo, Azul, Branco e Verde) em locais aleatórios de um campo de aveia e contaram o número de besouros de folhas de cereal apanhados. Os resultados estão arquivo besouro.xlsx.Podemos executar o teste de Tukey, mas, antes de coletar os dados, já tínhamos questões específicas em mente:Suspeitamos que cores quentes (amarelo e verde) são mais atrativas que cores frias (azul e branco)Branco e azul devem ter respostas semelhantesVerde e amarelo devem ter respostas semelhantesAssim, testamos três hipóteses:Hipótese 1:H0: μAz = μBrH1: μAz ≠ μBrHipótese 2:H0: μAm = μVeH1: μAm ≠ μVeHipótese 3:H0:(μAm+μVe)=(μAz+μBr)H~1:(μAm+μVe)>(μAz+μBr~)Duas hipóteses envolvem comparações aos pares.\nterceira é mais complexa e unilateral.Reescrevemos três hipóteses em termos de três contrastes:C1 = (0)(μAm) + (+1)(μAz) + (−1)(μBr) + (0)(μVe)C2 = (−1)(μAm) + (0)(μAz) + (0)(μBr) + (+1)(μVe)C3 = (+1)(μAm) + (−1)(μAz) + (−1)(μBr) + (+1)(μVe)Verifique que soma dos coeficientes em cada linha deve ser igual 0 (zero) (senão não é um contraste).Para verificar ortogonalidade entre os contrastes, soma produtos dos coeficientes também deve ser igual 0 (zero).hipóteses para estes contrastes são:Hipótese 1:H0: C1 = 0H1: C1 ≠ 0Hipótese 2:H0: C2 = 0H1: C2 ≠ 0Hipótese 3:H0: C3 = 0H1: C3 > 0Estamos 95% confiantes de que o número médio de besouros atraídos pelas cores Verde e Amarelo é superior ao número de besouros atraídos pelas cores Branco e Azul.Há grande evidência que o contraste C3 é maior que zero.Os outros contrastes mostram que:Azul e Branco não diferem entre siVerde e Amarelo diferem entre si","code":"\n#Contrastes\nK.bes <- rbind(\"C1\"=c(  0, +1, -1, 0),\n            \n               \"C2\"=c( -1,  0,  0, +1),\n           \n               \"C3\"=c( +1, -1, -1, +1))\n\n#verificar se contrastes são ortogonais (soma=0)\nsum(K.bes[1,]*K.bes[2,])## [1] 0\nsum(K.bes[1,]*K.bes[3,])## [1] 0\nsum(K.bes[2,]*K.bes[3,])## [1] 0\nlibrary(multcomp)\nctr_besouro <- glht(aov_bes, linfct=mcp(cor=K.bes))\nsummary(ctr_besouro)## \n##   Simultaneous Tests for General Linear Hypotheses\n## \n## Multiple Comparisons of Means: User-defined Contrasts\n## \n## \n## Fit: lm(formula = numero ~ cor, data = bes)\n## \n## Linear Hypotheses:\n##         Estimate Std. Error t value Pr(>|t|)    \n## C1 == 0   -1.333      3.274  -0.407 0.967629    \n## C2 == 0  -16.000      3.274  -4.886 0.000255 ***\n## C3 == 0   47.333      4.631  10.221  < 1e-04 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## (Adjusted p values reported -- single-step method)\n## Intervalo de confiança\nctr_besouro %>% confint()## \n##   Simultaneous Confidence Intervals\n## \n## Multiple Comparisons of Means: User-defined Contrasts\n## \n## \n## Fit: lm(formula = numero ~ cor, data = bes)\n## \n## Quantile = 2.5958\n## 95% family-wise confidence level\n##  \n## \n## Linear Hypotheses:\n##         Estimate lwr      upr     \n## C1 == 0  -1.3333  -9.8332   7.1666\n## C2 == 0 -16.0000 -24.4999  -7.5001\n## C3 == 0  47.3333  35.3127  59.3540"},{"path":"análise-de-variância-para-2-fatores.html","id":"análise-de-variância-para-2-fatores","chapter":"Capítulo 11 Análise de Variância para 2 fatores","heading":"Capítulo 11 Análise de Variância para 2 fatores","text":"Também conhecida como 2-way Anova, é utilizada quando um estudo ou experimento é desenhado para responder mais questões que uma Anova para 1 fator é capaz de responder.É muito comum comparar tratamentos que são combinações de dois fatores independentes.inferência para uma Anova de dois fatores é feita da seguinte forma:Faça gráficos das médias dos gruposProcure por interaçãoProcure por efeitos principaisFaça o teste F para três questões:Há interação?Há efeito principal para o primeiro fator?Há efeito principal para o segundo fator?seguir veremos três exemplos que ilustram várias situações da Anova de 2 fatores.Exemplo 11.1  (Análise de Variância para dois fatores - interação não significativa) reprodução tem um custo fisiológico alto. Uma dieta rica em proteínas pode aumentar capacidade reprodutiva de moscas das frutas.Um experimento avaliou porcentagem de gordura corporal em 40 fêmeas de mosca das frutas alimentadas com 4 dietas enriquecidas com proteínas (ou não) nas doses de 0, 1, 3 e 7 g.O experimento usou moscas selvagens e mutantes com ciclo reprodutivo mais longo.resposta foi porcentagem de gordura corporal após duas semanas da dieta, contidas arquivo mosca.xlsx.São três grupos de hipóteses serem testadas:H0: não há interação entre os genótipos e quantidade de proteína na porcentagem de gordura corporal de moscas.H0: não há interação entre os genótipos e quantidade de proteína na porcentagem de gordura corporal de moscas.H1: há interação entre os genótipos e quantidade de proteína na porcentagem de gordura corporal de moscas.H1: há interação entre os genótipos e quantidade de proteína na porcentagem de gordura corporal de moscas.H0: quantidade de proteína não influencia na porcentagem de gordura corporal de moscas.H0: quantidade de proteína não influencia na porcentagem de gordura corporal de moscas.H1:quantidade de proteína influencia na porcentagem de gordura corporal de moscas.H1:quantidade de proteína influencia na porcentagem de gordura corporal de moscas.H0: o genótipo não influencia na porcentagem de gordura corporal de moscas.H0: o genótipo não influencia na porcentagem de gordura corporal de moscas.H1: o genótipo influencia na porcentagem de gordura corporal de moscas.H1: o genótipo influencia na porcentagem de gordura corporal de moscas.Análise exploratória:Efetuamos Análise de Variância para os efeitos principais e para interação:interação (p-valor=0,395) e o efeito principal para genótipo (p-valor=0,86) são pequenos (não significativos). O efeito principal para proteína (p-valor < 0,001) é grande (significativo).Verificação presuposto da Normalidade.Verificação presuposto da homogeneidade das variânciasPela análise conjunto dos resultados acima, não há evidência de violação dos pressupostos.Teste de comparação de médias para o efeito principal fator proteína:Teste de comparação de médias para o efeito principal fator genótipo:Conclusão: Maiores quantidade de proteína na dieta levam menores taxas de gordura corporal. O genótipo da mosca das frutas tem um efeito pequeno na gordura corporal para qualquer quantidade de proteína.O próximo exemplo ilustra uma situação em que interação é significativa, mas os efeitos principais são grandes e mais importantes.Exemplo 11.2  (Análise de Variância para dois fatores - interação significativa mas com efeitos principais grandes e mais importantes) Fungos micorrízicos estão presentes nas raízes de muitas plantas. Eles tem uma relação simbiótica com planta.Um experimento comparou o efeito da adição de nitrogênio em dois genótipos de tomate, um selvagem suscetível micorrizas e um mutante não suscetível.O nitrogênio foi adicionado nas doses de 0, 28 e 10 kg/ha.Seis plantas foram aleatoriamente designadas cada grupo.variável resposta é porcentagem de fósforo nas plantas depois de 19 semanas (tomate.xlsx).São três grupos de hipóteses serem testadas:H0 : não há interação entre os genótipos e doses de nitrogênio na porcentagem de fósforo em plantas de tomate.H0 : não há interação entre os genótipos e doses de nitrogênio na porcentagem de fósforo em plantas de tomate.H1: há interação entre os genótipos e doses de nitrogênio na porcentagem de fósforo em plantas de tomate.H1: há interação entre os genótipos e doses de nitrogênio na porcentagem de fósforo em plantas de tomate.H0: o genótipo não influencia na porcentagem de fósforo em plantas de tomate.H0: o genótipo não influencia na porcentagem de fósforo em plantas de tomate.H1: o genótipo influencia na porcentagem de fósforo em plantas de tomate.H1: o genótipo influencia na porcentagem de fósforo em plantas de tomate.H0: doses de nitrogênio não influenciam na porcentagem de fósforo em plantas de tomate.H0: doses de nitrogênio não influenciam na porcentagem de fósforo em plantas de tomate.H1: doses de nitrogênio influenciam na porcentagem de fósforo em plantas de tomate.H1: doses de nitrogênio influenciam na porcentagem de fósforo em plantas de tomate.Análise exploratória:Efetuamos Análise de Variância para os efeitos principais e para interação:interação é significativa (p-valor = 0,0077), mas ela é pequena comparada com os efeitos principais.O efeito principal para genótipos (p-valor < 0,001) nos mostra que tomates selvagens com micorrizas tem maiores níveis de fósforo para todas doses de nitrogênio, devido ao benefício da simbiose.O efeito principal para nitrogênio (p-valor < 0,001) mostra que os níveis de fósforo diminuem com o aumento da dose de nitrogênio.Verificação dos presupostos da Normalidade e Homogeneidade das Variâncias (análise não mostrada): não há evidência de violação dos pressupostos.Teste de comparação de médias para o efeito principal fator nitrogênio:Teste de comparação de médias para o efeito principal fator genótipo:Conclusão:Tomates selvagens com micorrizas tem níveis maiores de fósforo que mutantes sem micorrizas.O nitrogênio reduz o nível de fosforo nas plantas.redução é maior nas plantas selvagens, mas esta interação não é muito grande em termos práticos.Por último, temos um exemplo em que há uma forte interação que faz os efeitos principais sem sentido. Uma Anova de dois fatores com um efeito de interação forte é frequentemente mais difícil de interpretar.Exemplo 11.3  (Análise de Variância para dois fatores - interação significativa) Milho com maior conteúdo de aminoácidos pode ser vantajoso na alimentação animal. Nove tratamentos foram arranjados em um fatorial 3x3:Milho normal e duas variedades alteradas: opaque-2 e floury-2Doses de proteína na dieta: 20, 16 e 12%dietas milho+proteína foram usadas na alimentação de 90 pintinhos machos de 1 dia. variável resposta é o peso (em gramas) após 21 dias milho.xlsx.Qual combinação de milho e proteína leva ao maior aumento de peso?Há três grupos de hipóteses serem testadas:H0 : não há interação entre variedade de milho e quantidade de proteína.H0 : não há interação entre variedade de milho e quantidade de proteína.H1: há interação entre variedade de milho e quantidade de proteína.H1: há interação entre variedade de milho e quantidade de proteína.H0: quantidade de proteína não influencia peso dos pintinhos.H0: quantidade de proteína não influencia peso dos pintinhos.H1: quantidade de proteína influencia peso dos pintinhos.H1: quantidade de proteína influencia peso dos pintinhos.H0: variedade de milho não influencia peso dos pintinhos.H0: variedade de milho não influencia peso dos pintinhos.H1: variedade de milho influencia peso dos pintinhos.H1: variedade de milho influencia peso dos pintinhos.Análise exploratória:Efetuamos Análise de Variância para os efeitos principais e para interação:Verificação dos presupostos da Normalidade e Homogeneidade das Variâncias (análise não mostrada): não há evidência de violação dos pressupostos.Desdobramento da interação: variedade dentro de cada nível de proteína.Desdobramento da interação: proteína dentro de cada nível de variedade.Há um efeito importante da interação:O milho normal é o pior para 12% de proteína e o melhor para 20%. Floury é o melhor para 12% e 16% de proteína. Opaque é sempre inferior ao Floury, mas melhor que o normal somente para 12% de proteína.Apesar de haver um efeito principal para variedade e proteína, estes são menos importantes devido interação.Conclusão:Maior dose de proteína ajuda acelerar o ganho de peso.Os três tipos de milho não diferem quando dieta tem 20% de proteína.Floury é melhor quando dose de proteína é de 16% e 20%.","code":"\nmosca <- readxl::read_excel(\"data/mosca.xlsx\") %>%\n  mutate(\n    genotipo = factor(genotipo),\n    proteina = factor(proteina)\n  )\n\n\nmosca %>%\n  group_by(genotipo, proteina) %>%\n  summarise(\n    n = n(),\n    media = mean(gordura),\n    desvpad = sd(gordura),\n    var = var(gordura)\n  )## `summarise()` has grouped output by 'genotipo'. You can override using the\n## `.groups` argument.## # A tibble: 8 × 6\n## # Groups:   genotipo [2]\n##   genotipo proteina     n media desvpad    var\n##   <fct>    <fct>    <int> <dbl>   <dbl>  <dbl>\n## 1 mutante  0            5  24.2   1.76   3.09 \n## 2 mutante  1            5  23.3   2.51   6.32 \n## 3 mutante  3            5  14.6   3.17  10.1  \n## 4 mutante  7            5  13.0   2.71   7.33 \n## 5 selvagem 0            5  25.6   1.50   2.24 \n## 6 selvagem 1            5  22.3   1.72   2.96 \n## 7 selvagem 3            5  15.1   0.691  0.477\n## 8 selvagem 7            5  11.6   1.06   1.13\n## Boxplot - Efeito principal fator A\nboxplot(gordura ~ genotipo, data = mosca)\n## Boxplot - Efeito principal fator B\nboxplot(gordura ~ proteina, data = mosca)\n## Boxplot - Interação\nboxplot(gordura ~ genotipo * proteina, data = mosca)\n## Gráfico da interação\nwith(mosca, interaction.plot(genotipo, proteina, gordura))\nwith(mosca, interaction.plot(proteina, genotipo, gordura))\naov_mosca <- lm(gordura ~ genotipo * proteina, data = mosca)\n\nanova(aov_mosca)## Analysis of Variance Table\n## \n## Response: gordura\n##                   Df  Sum Sq Mean Sq F value    Pr(>F)    \n## genotipo           1    0.13    0.13  0.0315    0.8602    \n## proteina           3 1113.37  371.12 88.3984 1.429e-15 ***\n## genotipo:proteina  3   12.91    4.30  1.0247    0.3947    \n## Residuals         32  134.35    4.20                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## curtose\naov_mosca %>%\n  residuals() %>%\n  moments::kurtosis()## [1] 2.495927\n## assimetria\naov_mosca %>%\n  residuals() %>%\n  moments::skewness()## [1] 0.3766119\n## Teste de Shapiro-Wilk\naov_mosca %>%\n  residuals() %>%\n  shapiro.test()## \n##  Shapiro-Wilk normality test\n## \n## data:  .\n## W = 0.97295, p-value = 0.444\n## Gráfico dos quantis normais\naov_mosca %>%\n  residuals() %>%\n  qqnorm()\naov_mosca %>%\n  residuals() %>%\n  qqline()\n## Histograma\naov_mosca %>%\n  residuals() %>%\n  hist()\n## Ramo e folhas\naov_mosca %>%\n  residuals() %>%\n  stem()## \n##   The decimal point is at the |\n## \n##   -3 | 5\n##   -2 | 66410\n##   -1 | 965443310\n##   -0 | 95333\n##    0 | 0134466779\n##    1 | 3799\n##    2 | 146\n##    3 | 68\n##    4 | 0\n## razão maior/menor desvio-padrão\nmosca %>%\n  group_by(genotipo, proteina) %>%\n  summarise(desvpad = sd(gordura)) %>%\n  mutate(razao = max(desvpad) / desvpad)## `summarise()` has grouped output by 'genotipo'. You can override using the\n## `.groups` argument.## # A tibble: 8 × 4\n## # Groups:   genotipo [2]\n##   genotipo proteina desvpad razao\n##   <fct>    <fct>      <dbl> <dbl>\n## 1 mutante  0          1.76   1.80\n## 2 mutante  1          2.51   1.26\n## 3 mutante  3          3.17   1   \n## 4 mutante  7          2.71   1.17\n## 5 selvagem 0          1.50   1.15\n## 6 selvagem 1          1.72   1   \n## 7 selvagem 3          0.691  2.49\n## 8 selvagem 7          1.06   1.62\n## boxplot condicional dos resíduos\nboxplot(residuals(aov_mosca) ~ genotipo * proteina, data = mosca)\n## resíduos vs ajustados\nplot(aov_mosca, 1)\n## teste de Bartlett\nbartlett.test(residuals(aov_mosca) ~ paste0(genotipo, proteina), data = mosca)## \n##  Bartlett test of homogeneity of variances\n## \n## data:  residuals(aov_mosca) by paste0(genotipo, proteina)\n## Bartlett's K-squared = 10.739, df = 7, p-value = 0.1504\n## teste de Levene\ncar::leveneTest(residuals(aov_mosca) ~ paste0(genotipo, proteina), data = mosca)## Warning in leveneTest.default(y = y, group = group, ...): group coerced to\n## factor.## Levene's Test for Homogeneity of Variance (center = median)\n##       Df F value Pr(>F)\n## group  7  1.3106 0.2773\n##       32\ntk_proteina <- emmeans::emmeans(aov_mosca, ~proteina, contr = \"tukey\")## NOTE: Results may be misleading due to involvement in interactions\n## contrastes\ntk_proteina$contrasts##  contrast              estimate    SE df t.ratio p.value\n##  proteina0 - proteina1     2.06 0.916 32   2.254  0.1307\n##  proteina0 - proteina3    10.03 0.916 32  10.950  <.0001\n##  proteina0 - proteina7    12.61 0.916 32  13.763  <.0001\n##  proteina1 - proteina3     7.97 0.916 32   8.697  <.0001\n##  proteina1 - proteina7    10.55 0.916 32  11.509  <.0001\n##  proteina3 - proteina7     2.58 0.916 32   2.812  0.0395\n## \n## Results are averaged over the levels of: genotipo \n## P value adjustment: tukey method for comparing a family of 4 estimates\n## Intervalo de confiança\ntk_proteina$contrasts %>% confint()##  contrast              estimate    SE df lower.CL upper.CL\n##  proteina0 - proteina1     2.06 0.916 32  -0.4177     4.55\n##  proteina0 - proteina3    10.03 0.916 32   7.5513    12.52\n##  proteina0 - proteina7    12.61 0.916 32  10.1283    15.09\n##  proteina1 - proteina3     7.97 0.916 32   5.4863    10.45\n##  proteina1 - proteina7    10.55 0.916 32   8.0633    13.03\n##  proteina3 - proteina7     2.58 0.916 32   0.0943     5.06\n## \n## Results are averaged over the levels of: genotipo \n## Confidence level used: 0.95 \n## Conf-level adjustment: tukey method for comparing a family of 4 estimates\n## letras (CLD)\ntk_proteina$emmeans %>% multcomp::cld(Letters = letters)##  proteina emmean    SE df lower.CL upper.CL .group\n##  7          12.3 0.648 32     11.0     13.6  a    \n##  3          14.9 0.648 32     13.5     16.2   b   \n##  1          22.8 0.648 32     21.5     24.1    c  \n##  0          24.9 0.648 32     23.6     26.2    c  \n## \n## Results are averaged over the levels of: genotipo \n## Confidence level used: 0.95 \n## P value adjustment: tukey method for comparing a family of 4 estimates \n## significance level used: alpha = 0.05 \n## NOTE: Compact letter displays can be misleading\n##       because they show NON-findings rather than findings.\n##       Consider using 'pairs()', 'pwpp()', or 'pwpm()' instead.\n## plot\ntk_proteina$emmeans %>% plot()\ntk_genotipo <- emmeans::emmeans(aov_mosca, ~genotipo, contr = \"tukey\")## NOTE: Results may be misleading due to involvement in interactions\n## contrastes\ntk_genotipo$contrasts##  contrast           estimate    SE df t.ratio p.value\n##  mutante - selvagem    0.115 0.648 32   0.177  0.8602\n## \n## Results are averaged over the levels of: proteina\n## Intervalo de confiança\ntk_genotipo$contrasts %>% confint()##  contrast           estimate    SE df lower.CL upper.CL\n##  mutante - selvagem    0.115 0.648 32     -1.2     1.43\n## \n## Results are averaged over the levels of: proteina \n## Confidence level used: 0.95\n## letras (CLD)\ntk_genotipo$emmeans %>% multcomp::cld(Letters = letters)##  genotipo emmean    SE df lower.CL upper.CL .group\n##  selvagem   18.7 0.458 32     17.7     19.6  a    \n##  mutante    18.8 0.458 32     17.8     19.7  a    \n## \n## Results are averaged over the levels of: proteina \n## Confidence level used: 0.95 \n## significance level used: alpha = 0.05 \n## NOTE: Compact letter displays can be misleading\n##       because they show NON-findings rather than findings.\n##       Consider using 'pairs()', 'pwpp()', or 'pwpm()' instead.\n## plot\ntk_genotipo$emmeans %>% plot()\ntomate <- readxl::read_excel(\"data/tomate.xlsx\") %>%\n  mutate(\n    genotipo = factor(genotipo),\n    nitrogenio = factor(nitrogenio)\n  )\n\n\ntomate %>%\n  group_by(genotipo, nitrogenio) %>%\n  summarise(\n    n = n(),\n    media = mean(fosforo),\n    desvpad = sd(fosforo),\n    var = var(fosforo)\n  )## `summarise()` has grouped output by 'genotipo'. You can override using the\n## `.groups` argument.## # A tibble: 6 × 6\n## # Groups:   genotipo [2]\n##   genotipo nitrogenio     n media desvpad      var\n##   <fct>    <fct>      <int> <dbl>   <dbl>    <dbl>\n## 1 mutante  0              6 0.248  0.0306 0.000937\n## 2 mutante  28             6 0.207  0.0242 0.000587\n## 3 mutante  160            6 0.182  0.0147 0.000217\n## 4 selvagem 0              6 0.512  0.0833 0.00694 \n## 5 selvagem 28             6 0.423  0.0455 0.00207 \n## 6 selvagem 160            6 0.318  0.0462 0.00214\n## Boxplot - Efeito principal fator A\nboxplot(fosforo ~ genotipo, data = tomate)\n## Boxplot - Efeito principal fator B\nboxplot(fosforo ~ nitrogenio, data = tomate)\n## Boxplot - Interação\nboxplot(fosforo ~ genotipo * nitrogenio, data = tomate)\n## Gráfico da interação\nwith(tomate, interaction.plot(genotipo, nitrogenio, fosforo))\nwith(tomate, interaction.plot(nitrogenio, genotipo, fosforo))\naov_tomate <- lm(fosforo ~ genotipo * nitrogenio, data = tomate)\n\nanova(aov_tomate)## Analysis of Variance Table\n## \n## Response: fosforo\n##                     Df  Sum Sq Mean Sq F value    Pr(>F)    \n## genotipo             1 0.38028 0.38028 177.148 4.019e-14 ***\n## nitrogenio           2 0.10140 0.05070  23.618 6.911e-07 ***\n## genotipo:nitrogenio  2 0.02462 0.01231   5.735  0.007777 ** \n## Residuals           30 0.06440 0.00215                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\ntk_nitrogenio <- emmeans::emmeans(aov_tomate, ~nitrogenio, contr = \"tukey\")## NOTE: Results may be misleading due to involvement in interactions\n## contrastes\ntk_nitrogenio$contrasts##  contrast                     estimate     SE df t.ratio p.value\n##  nitrogenio0 - nitrogenio28      0.065 0.0189 30   3.436  0.0048\n##  nitrogenio0 - nitrogenio160     0.130 0.0189 30   6.873  <.0001\n##  nitrogenio28 - nitrogenio160    0.065 0.0189 30   3.436  0.0048\n## \n## Results are averaged over the levels of: genotipo \n## P value adjustment: tukey method for comparing a family of 3 estimates\n## Intervalo de confiança\ntk_nitrogenio$contrasts %>% confint()##  contrast                     estimate     SE df lower.CL upper.CL\n##  nitrogenio0 - nitrogenio28      0.065 0.0189 30   0.0184    0.112\n##  nitrogenio0 - nitrogenio160     0.130 0.0189 30   0.0834    0.177\n##  nitrogenio28 - nitrogenio160    0.065 0.0189 30   0.0184    0.112\n## \n## Results are averaged over the levels of: genotipo \n## Confidence level used: 0.95 \n## Conf-level adjustment: tukey method for comparing a family of 3 estimates\n## letras (CLD)\ntk_nitrogenio$emmeans %>% multcomp::cld(Letters = letters)##  nitrogenio emmean     SE df lower.CL upper.CL .group\n##  160         0.250 0.0134 30    0.223    0.277  a    \n##  28          0.315 0.0134 30    0.288    0.342   b   \n##  0           0.380 0.0134 30    0.353    0.407    c  \n## \n## Results are averaged over the levels of: genotipo \n## Confidence level used: 0.95 \n## P value adjustment: tukey method for comparing a family of 3 estimates \n## significance level used: alpha = 0.05 \n## NOTE: Compact letter displays can be misleading\n##       because they show NON-findings rather than findings.\n##       Consider using 'pairs()', 'pwpp()', or 'pwpm()' instead.\n## plot\ntk_nitrogenio$emmeans %>% plot()\ntk_genotipo <- emmeans::emmeans(aov_tomate, ~genotipo, contr = \"tukey\")## NOTE: Results may be misleading due to involvement in interactions\n## contrastes\ntk_genotipo$contrasts##  contrast           estimate     SE df t.ratio p.value\n##  mutante - selvagem   -0.206 0.0154 30 -13.310  <.0001\n## \n## Results are averaged over the levels of: nitrogenio\n## Intervalo de confiança\ntk_genotipo$contrasts %>% confint()##  contrast           estimate     SE df lower.CL upper.CL\n##  mutante - selvagem   -0.206 0.0154 30   -0.237   -0.174\n## \n## Results are averaged over the levels of: nitrogenio \n## Confidence level used: 0.95\n## letras (CLD)\ntk_genotipo$emmeans %>% multcomp::cld(Letters = letters)##  genotipo emmean     SE df lower.CL upper.CL .group\n##  mutante   0.212 0.0109 30    0.190    0.235  a    \n##  selvagem  0.418 0.0109 30    0.395    0.440   b   \n## \n## Results are averaged over the levels of: nitrogenio \n## Confidence level used: 0.95 \n## significance level used: alpha = 0.05 \n## NOTE: Compact letter displays can be misleading\n##       because they show NON-findings rather than findings.\n##       Consider using 'pairs()', 'pwpp()', or 'pwpm()' instead.\n## plot\ntk_genotipo$emmeans %>% plot()\nmilho <- readxl::read_excel(\"data/milho.xlsx\") %>%\n  mutate(\n    variedade = factor(variedade),\n    proteina = factor(proteina)\n  )\n\n\nmilho %>%\n  group_by(variedade, proteina) %>%\n  summarise(\n    n = n(),\n    media = mean(peso),\n    desvpad = sd(peso),\n    var = var(peso)\n  )## `summarise()` has grouped output by 'variedade'. You can override using the\n## `.groups` argument.## # A tibble: 9 × 6\n## # Groups:   variedade [3]\n##   variedade proteina     n media desvpad   var\n##   <fct>     <fct>    <int> <dbl>   <dbl> <dbl>\n## 1 flou      12          10  271.    32.1 1033.\n## 2 flou      16          10  434.    49.7 2474.\n## 3 flou      20          10  465.    49.2 2416.\n## 4 norm      12          10  195.    50.5 2553.\n## 5 norm      16          10  389.    48.1 2314.\n## 6 norm      20          10  486.    38.7 1496.\n## 7 opaq      12          10  264.    26.0  675.\n## 8 opaq      16          10  339.    54.4 2959.\n## 9 opaq      20          10  438.    61.2 3741.\n## Boxplot - Efeito principal fator A\nboxplot(peso ~ variedade, data = milho)\n## Boxplot - Efeito principal fator B\nboxplot(peso ~ proteina, data = milho)\n## Boxplot - Interação\nboxplot(peso ~ variedade * proteina, data = milho)\n## Gráfico da interação\nwith(milho, interaction.plot(variedade, proteina, peso))\nwith(milho, interaction.plot(proteina, variedade, peso))\naov_milho <- lm(peso ~ variedade * proteina, data = milho)\nanova(aov_milho)## Analysis of Variance Table\n## \n## Response: peso\n##                    Df Sum Sq Mean Sq  F value    Pr(>F)    \n## variedade           2  31137   15568   7.1265   0.00141 ** \n## proteina            2 745621  372810 170.6557 < 2.2e-16 ***\n## variedade:proteina  4  60894   15223   6.9686 7.143e-05 ***\n## Residuals          81 176951    2185                       \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Desdobramento da interação\nphia::testInteractions(aov_milho, fixed=\"proteina\", across=\"variedade\")## F Test: \n## P-value adjustment method: holm\n##           variedade1 variedade2 Df Sum of Sq       F    Pr(>F)    \n## 12              7.66     -68.39  2     35065  8.0256 0.0013218 ** \n## 16             95.47      50.28  2     45616 10.4404 0.0002773 ***\n## 20             27.16      47.48  2     11350  2.5977 0.0806380 .  \n## Residuals                       81    176951                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Teste de Tukey para a interação\ntk_variedade <- emmeans::emmeans(aov_milho, ~proteina|variedade, contr = \"tukey\")\n\n## Contrastes\ntk_variedade$contrasts## variedade = flou:\n##  contrast                estimate   SE df t.ratio p.value\n##  proteina12 - proteina16   -162.8 20.9 81  -7.790  <.0001\n##  proteina12 - proteina20   -193.8 20.9 81  -9.273  <.0001\n##  proteina16 - proteina20    -31.0 20.9 81  -1.483  0.3046\n## \n## variedade = norm:\n##  contrast                estimate   SE df t.ratio p.value\n##  proteina12 - proteina16   -193.7 20.9 81  -9.266  <.0001\n##  proteina12 - proteina20   -290.2 20.9 81 -13.883  <.0001\n##  proteina16 - proteina20    -96.5 20.9 81  -4.617  <.0001\n## \n## variedade = opaq:\n##  contrast                estimate   SE df t.ratio p.value\n##  proteina12 - proteina16    -75.0 20.9 81  -3.589  0.0016\n##  proteina12 - proteina20   -174.3 20.9 81  -8.340  <.0001\n##  proteina16 - proteina20    -99.3 20.9 81  -4.751  <.0001\n## \n## P value adjustment: tukey method for comparing a family of 3 estimates\n## Intervalo de confiança\ntk_variedade$contrasts %>% confint()## variedade = flou:\n##  contrast                estimate   SE df lower.CL upper.CL\n##  proteina12 - proteina16   -162.8 20.9 81   -212.7   -112.9\n##  proteina12 - proteina20   -193.8 20.9 81   -243.7   -143.9\n##  proteina16 - proteina20    -31.0 20.9 81    -80.9     18.9\n## \n## variedade = norm:\n##  contrast                estimate   SE df lower.CL upper.CL\n##  proteina12 - proteina16   -193.7 20.9 81   -243.6   -143.8\n##  proteina12 - proteina20   -290.2 20.9 81   -340.1   -240.3\n##  proteina16 - proteina20    -96.5 20.9 81   -146.4    -46.6\n## \n## variedade = opaq:\n##  contrast                estimate   SE df lower.CL upper.CL\n##  proteina12 - proteina16    -75.0 20.9 81   -124.9    -25.1\n##  proteina12 - proteina20   -174.3 20.9 81   -224.2   -124.4\n##  proteina16 - proteina20    -99.3 20.9 81   -149.2    -49.4\n## \n## Confidence level used: 0.95 \n## Conf-level adjustment: tukey method for comparing a family of 3 estimates\n## letras (CLD)\ntk_variedade$emmeans %>% multcomp::cld(Letters = letters)## variedade = flou:\n##  proteina emmean   SE df lower.CL upper.CL .group\n##  12          271 14.8 81      242      301  a    \n##  16          434 14.8 81      405      464   b   \n##  20          465 14.8 81      436      495   b   \n## \n## variedade = norm:\n##  proteina emmean   SE df lower.CL upper.CL .group\n##  12          195 14.8 81      166      225  a    \n##  16          389 14.8 81      360      418   b   \n##  20          486 14.8 81      456      515    c  \n## \n## variedade = opaq:\n##  proteina emmean   SE df lower.CL upper.CL .group\n##  12          264 14.8 81      234      293  a    \n##  16          339 14.8 81      309      368   b   \n##  20          438 14.8 81      409      467    c  \n## \n## Confidence level used: 0.95 \n## P value adjustment: tukey method for comparing a family of 3 estimates \n## significance level used: alpha = 0.05 \n## NOTE: Compact letter displays can be misleading\n##       because they show NON-findings rather than findings.\n##       Consider using 'pairs()', 'pwpp()', or 'pwpm()' instead.\n## plot\ntk_variedade$emmeans %>% plot()\n## Desdobramento da interação\nphia::testInteractions(aov_milho, fixed=\"variedade\", across=\"proteina\")## F Test: \n## P-value adjustment method: holm\n##           proteina1 proteina2 Df Sum of Sq      F    Pr(>F)    \n## flou        -193.82    -30.99  2    216801 49.621 1.708e-14 ***\n## norm        -290.19    -96.50  2    436794 99.972 < 2.2e-16 ***\n## opaq        -174.32    -99.30  2    152920 35.000 1.109e-11 ***\n## Residuals                     81    176951                     \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## Teste de Tukey para a interação\ntk_proteina <- emmeans::emmeans(aov_milho, ~variedade|proteina, contr = \"tukey\")\n\n## Contrastes\ntk_proteina$contrasts## proteina = 12:\n##  contrast    estimate   SE df t.ratio p.value\n##  flou - norm    76.05 20.9 81   3.638  0.0014\n##  flou - opaq     7.66 20.9 81   0.366  0.9287\n##  norm - opaq   -68.39 20.9 81  -3.272  0.0044\n## \n## proteina = 16:\n##  contrast    estimate   SE df t.ratio p.value\n##  flou - norm    45.19 20.9 81   2.162  0.0840\n##  flou - opaq    95.47 20.9 81   4.567  0.0001\n##  norm - opaq    50.28 20.9 81   2.405  0.0479\n## \n## proteina = 20:\n##  contrast    estimate   SE df t.ratio p.value\n##  flou - norm   -20.32 20.9 81  -0.972  0.5965\n##  flou - opaq    27.16 20.9 81   1.299  0.3997\n##  norm - opaq    47.48 20.9 81   2.271  0.0657\n## \n## P value adjustment: tukey method for comparing a family of 3 estimates\n## Intervalo de confiança\ntk_proteina$contrasts %>% confint()## proteina = 12:\n##  contrast    estimate   SE df lower.CL upper.CL\n##  flou - norm    76.05 20.9 81   26.144    126.0\n##  flou - opaq     7.66 20.9 81  -42.246     57.6\n##  norm - opaq   -68.39 20.9 81 -118.296    -18.5\n## \n## proteina = 16:\n##  contrast    estimate   SE df lower.CL upper.CL\n##  flou - norm    45.19 20.9 81   -4.716     95.1\n##  flou - opaq    95.47 20.9 81   45.564    145.4\n##  norm - opaq    50.28 20.9 81    0.374    100.2\n## \n## proteina = 20:\n##  contrast    estimate   SE df lower.CL upper.CL\n##  flou - norm   -20.32 20.9 81  -70.226     29.6\n##  flou - opaq    27.16 20.9 81  -22.746     77.1\n##  norm - opaq    47.48 20.9 81   -2.426     97.4\n## \n## Confidence level used: 0.95 \n## Conf-level adjustment: tukey method for comparing a family of 3 estimates\n## letras (CLD)\ntk_proteina$emmeans %>% multcomp::cld(Letters = letters)## proteina = 12:\n##  variedade emmean   SE df lower.CL upper.CL .group\n##  norm         195 14.8 81      166      225  a    \n##  opaq         264 14.8 81      234      293   b   \n##  flou         271 14.8 81      242      301   b   \n## \n## proteina = 16:\n##  variedade emmean   SE df lower.CL upper.CL .group\n##  opaq         339 14.8 81      309      368  a    \n##  norm         389 14.8 81      360      418   b   \n##  flou         434 14.8 81      405      464   b   \n## \n## proteina = 20:\n##  variedade emmean   SE df lower.CL upper.CL .group\n##  opaq         438 14.8 81      409      467  a    \n##  flou         465 14.8 81      436      495  a    \n##  norm         486 14.8 81      456      515  a    \n## \n## Confidence level used: 0.95 \n## P value adjustment: tukey method for comparing a family of 3 estimates \n## significance level used: alpha = 0.05 \n## NOTE: Compact letter displays can be misleading\n##       because they show NON-findings rather than findings.\n##       Consider using 'pairs()', 'pwpp()', or 'pwpm()' instead.\n## plot\ntk_proteina$emmeans %>% plot()"},{"path":"correlação-e-regressão.html","id":"correlação-e-regressão","chapter":"Capítulo 12 Correlação e Regressão","heading":"Capítulo 12 Correlação e Regressão","text":"Muitos estudos estatísticos analisam relação entre duas variáveis. relações estatísticas são tendências gerais, não regras rígidas, e permitem exceções individuais. Por exemplo, embora os fumantes, em média, morram mais jovens que os não fumantes, algumas pessoas vivem até os 90 anos fumando três maços de cigarros por dia.","code":""},{"path":"correlação-e-regressão.html","id":"variável-resposta-e-variável-explicativa","chapter":"Capítulo 12 Correlação e Regressão","heading":"12.1 Variável resposta e Variável explicativa","text":"Uma variável resposta mede o resultado de um estudo.Uma variável explicativa esclarece ou influencia mudanças em uma variável resposta.Muitas vezes, variáveis explicativas são chamadas de variáveis independentes e variáveis resposta são chamadas de variáveis dependentes.Estudantes voluntários beberam números diferentes de latas de cerveja. Trinta minutos depois, um policial mediu o teor de álcool sangue dos voluntários. O número de latas consumidas é variável explicativa, e o percentual de álcool sangue é variável resposta.Uma pesquisa coletou informações sobre altura, idade, gênero e uma longa lista de atributos, com o objetivo de documentar características da população. Não há variável reposta ou explicativa nesse contexto.Um pediatra observou os mesmos dados anteriores com foco em idade e gênero, juntamente com outras variáveis, como etnia, para discutir o crescimento de uma criança. Neste caso, idade e gênero são variáveis explicativas, e altura é variável resposta.Nem sempre fica claro quais são variáveis explicativa e resposta em um estudo. Pode depender da forma como o estudo foi montado e como variávveis foram coletadas. Muitas vezes, somente é possível explorar relação entre variáveis consideradas.","code":""},{"path":"correlação-e-regressão.html","id":"diagrama_dispersao","chapter":"Capítulo 12 Correlação e Regressão","heading":"12.2 Diagrama de dispersão","text":"maneira mais eficiente de se mostrar relação entre duas variáveis quantitativas é por meio de um diagrama de dispersão.Um diagrama de dispersão mostra relação entre duas variáveis quantitativas, medidas nos mesmos indivíduos.Os valores de uma variável aparecem eixo horizontal, e os valores da outra, eixo vertical.Cada indivíduo nos dados aparece como um ponto gráfico determinado pelos valores de ambas variáveis para tal indivíduo.Sempre represente graficamente variável explicativa, se houver, eixo horizontal (eixo x) de um diagrama de dispersão.Exemplo 12.1  (Diagrama de dispersão) Os peixes-boi são mamíferos aquáticos grandes e herbívoros, encontrados principalmente nos rios e estuários da Flórida. Essa espécie ameaçada sofre com coabitação com populações humanas, e muitos peixes-boi morrem cada ano em consequência de colisões com barcos motor.O arquivo pboi.xlsx traz o número de barcos motor resgistrados, entre 1977 e 2008, e sua influência nas mortes de peixes-boi em consequência de colisões.O “número de barcos registrados” é variável explicativa.O “número de mortes de peixes-boi por colisão” é variável resposta.O tempo (ano em que os dados foram coletados) não é uma variável relevante aqui (indivíduos).O diagrama acima mostra uma direção nítida: uma subida, da parte de baixo, à esquerda, para parte de cima, à direita.Os anos com maior registro de barcos tendem ter contagem mais alta de mortes de peixes-boi por colisões. Chamamos de associação positiva entre duas variáveis 30.forma da relação é linear, isto é, o padrão geral segue uma reta, da esquerda para direita, de baixo para cima.intensidade de uma relação em um diagrama de dispersão é determinada pela proximidade com que os pontos seguem uma forma clara. relação geral é forte.O número de registros de barcos motor explica grande parte da variação entre mortes de peixes-boi por colisões. Anos com menos barcos registrados tendem ter menos mortes de peixes-boi. Para preservar essa espécie ameaçada, restrição número de barcos registrados pode ser útil.entanto, não consideramos outros fatores, como limites de velocidade, multas ou educação dos pilotos, que poderiam também ser influentes. Nossas conclusões se limitam aos dados disponíveis e ao que eles dizem sobre relação entre registros de barcos motor e acidentes com peixes-boi.","code":"\npboi <- readxl::read_excel(\"data/pboi.xlsx\")\n\nlibrary(ggplot2)\nggplot(pboi, aes(x = barco, y = morte)) +\n  geom_point(colour = \"darkblue\") +\n  labs(\n    x = \"Barcos a motor registrados (x 1000)\",\n    y = \"Mortes por colisão\"\n  )"},{"path":"correlação-e-regressão.html","id":"correlação","chapter":"Capítulo 12 Correlação e Regressão","heading":"12.3 Correlação","text":"É uma medida de associação linear que elimina subjetividade da interpretação gráfica. Alguns programas se referem r como coeficiente de correlação de Pearson, ou r de Pearson.Os dois diagramas de dispersão representam exatamente os mesmos dados, porém o gráfico à direita foi desenhado em tamanho menor em um grande espaço. O gráfico à direita parece mostrar uma relação linear mais forte.Exemplo 12.2  (Correlação) Qual correlação entre número de barcos e morte de peixe-boi?correlação é de 0,95 ou 95%.Fatos sobre correlação:Não faz distinção entre variáveis explicativa e resposta.\nNão se altera quando mudamos unidades de medida de x, de y ou de ambas.\ncorrelação r é sempre um número entre –1 e 1.\nPositiva indica uma associação positiva.\nNegativa indica uma associação negativa.\nValores próximos de zero indicam uma relação linear muito fraca.\nintensidade da relação linear cresce à medida que r se afasta de zero em direção -1 ou 1.","code":"\nwith(pboi, cor(morte, barco))## [1] 0.9501555"},{"path":"correlação-e-regressão.html","id":"regressão","chapter":"Capítulo 12 Correlação e Regressão","heading":"12.4 Regressão","text":"Uma reta de regressão resume relação entre duas variáveis. Usamos uma reta de regressão para predizer o valor de y para determinado valor de x.reta da regressão linear simples tem o seguinte formato:\\[y = + b \\cdot x\\]Nessa equação, b é inclinação, ou seja, alteração de y quando x aumenta uma unidade. O número é o intercepto, ou seja, o valor de y quando x = 0.Exemplo 12.3  (Regressão) Qual é reta de regressão linear simples que descreve relação entre o número de barcos e quantidade de barcos motor rsgistrados?\\[\nmorte = -41.2047 + 0.1261 \\cdot barcos\n\\]Cuidado com extrapolação! O que aconteceria se tivéssemos 0 (zero) barcos registrados?Uma forma muito comum de representar regressão é por meio de uma reta ajustada diagrama de dispersão, junto com equação ajustada e o coeficiente de detemrinação ajustado (R2adj31)","code":"\nreg_pboi <- lm(morte ~ barco, data = pboi)\ncoef(reg_pboi)## (Intercept)       barco \n##  -41.204687    0.126052\nlibrary(ggplot2)\nggplot(pboi, aes(x = barco, y = morte)) +\n  geom_point(colour = \"darkblue\") +\n  labs(\n    x = \"Barcos a motor registrados (x 1000)\",\n    y = \"Mortes por colisão\"\n  ) +\n  geom_smooth(method = \"lm\", formula = y ~ x) +\n  ggpmisc::stat_poly_eq(aes(label = paste0(\"atop(\", ..eq.label.., \",\", ..adj.rr.label.., \")\")))"},{"path":"correlação-e-regressão.html","id":"inferência-para-regressão","chapter":"Capítulo 12 Correlação e Regressão","heading":"12.5 Inferência para Regressão","text":"O estudo da inferência para regressão pode responder algumas questões:Há realmente uma relação entre x e y na população ou pode ser que o padrão que vemos diagrama de dispersão tenha surgido apenas pelo acaso?Há realmente uma relação entre x e y na população ou pode ser que o padrão que vemos diagrama de dispersão tenha surgido apenas pelo acaso?Qual é inclinação (taxa de variação) que relaciona y com x na população, incluindo margem de erro para nossa estimativa da inclinação?Qual é inclinação (taxa de variação) que relaciona y com x na população, incluindo margem de erro para nossa estimativa da inclinação?Se usarmos reta de mínimos quadrados para predizer y para dado valor de x, quão precisa será nossa predição (novamente, com margem de erro)?Se usarmos reta de mínimos quadrados para predizer y para dado valor de x, quão precisa será nossa predição (novamente, com margem de erro)?reta de regressão para população assume o seguinte formato:\\[y = \\alpha + \\beta \\cdot x\\]inferencia testa hipótesesH0: β = 0H1: β ≠ 0Uma reta de regressão com inclinação zero é horizontal.Exemplo 12.4  (Inferência para Regressão) .Há evidência muito forte de que mortes de peixe-boi aumentam à medida que o número de barcos aumenta.","code":"\nsummary(reg_pboi)## \n## Call:\n## lm(formula = morte ~ barco, data = pboi)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -15.2507  -5.7731   0.2498   4.3090  18.5815 \n## \n## Coefficients:\n##               Estimate Std. Error t value Pr(>|t|)    \n## (Intercept) -41.204687   5.679767  -7.255 4.47e-08 ***\n## barco         0.126052   0.007552  16.692  < 2e-16 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 7.864 on 30 degrees of freedom\n## Multiple R-squared:  0.9028, Adjusted R-squared:  0.8996 \n## F-statistic: 278.6 on 1 and 30 DF,  p-value: < 2.2e-16"},{"path":"correlação-e-regressão.html","id":"inferência-sobre-predição","chapter":"Capítulo 12 Correlação e Regressão","heading":"12.6 Inferência sobre predição","text":"Outro contexto para inferência na regressão é quando desejamos não simplesmente uma predição, mas uma com margem de erro que descreva quão precisa, provavelmente, predição é.Exemplo 12.5  (Inferência sobre predição) Dezesseis estudantes voluntários consumiram um número de latas de cerveja aleatoriamente designado. Trinta minutos depois, um oficial de polícia mediu o teor alcoólico sangue (TAS) deles, em gramas de álcool por decilitro de sangue cerveja.xlsx. O limite legal para direção é TAS 0,08. Desejamos predizer o TAS de uma pessoa usando apenas informação de que bebeu cinco cervejas.Conclusão: Estamos 95% confiantes de que o TAS, depois de beber cinco cervejas, está entre 0,032 e 0,122.","code":"\ncerv <- readxl::read_excel(\"data/cerveja.xlsx\")\n\nreg_cerv <- lm(TAS~numero, data=cerv)\nsummary(reg_cerv)## \n## Call:\n## lm(formula = TAS ~ numero, data = cerv)\n## \n## Residuals:\n##       Min        1Q    Median        3Q       Max \n## -0.027118 -0.017350  0.001773  0.008623  0.041027 \n## \n## Coefficients:\n##              Estimate Std. Error t value Pr(>|t|)    \n## (Intercept) -0.012701   0.012638  -1.005    0.332    \n## numero       0.017964   0.002402   7.480 2.97e-06 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 0.02044 on 14 degrees of freedom\n## Multiple R-squared:  0.7998, Adjusted R-squared:  0.7855 \n## F-statistic: 55.94 on 1 and 14 DF,  p-value: 2.969e-06\nlibrary(ggplot2)\nggplot(cerv, aes(x = numero, y = TAS)) +\n  geom_point(colour = \"gold2\") +\n  labs(\n    x = \"Número de cervejas\",\n    y = \"TAS (g/dL)\"\n  ) +\n  geom_smooth(method = \"lm\", formula = y ~ x) +\n  ggpmisc::stat_poly_eq(aes(label = paste0(\"atop(\", ..eq.label.., \",\", ..adj.rr.label.., \")\")))\n#intervalo de confiança dos parâmetros\nconfint(reg_cerv)##                   2.5 %     97.5 %\n## (Intercept) -0.03980535 0.01440414\n## numero       0.01281262 0.02311490\n#predição para 5 cervejas\npredict(reg_cerv, data.frame(numero=5), interval=\"predict\") ##          fit        lwr       upr\n## 1 0.07711821 0.03191712 0.1223193"},{"path":"dados-categóricos.html","id":"dados-categóricos","chapter":"Capítulo 13 Dados categóricos","heading":"Capítulo 13 Dados categóricos","text":"Algumas variáveis – como gênero, espécie e cor – são categóricas por natureza. Outras variáveis categóricas são criadas pelo agrupamento em classes dos valores de uma variável quantitativa – como grupos etários.relação entre duas variáveis categóricas é frequentemente demonstrada em uma Tabela de dupla entrada, que também é conhecida por Tabela de contingência.Para analisar dados categóricos, usamos contagens ou percentuais de indivíduos que pertencem cada uma das várias categorias.Exemplo 13.1  (Tabela de dupla entrada - teste qui-quadrado) Tabela abaixo apresenta os resultados de um estudo da recorrência de infecções trato urinário (ITU) em mulheres que acabaram de se curar de uma ITU com antibióticos e que, então, passam usar um de três tratamentos por um período de seis meses (suco de uva--monte diariamente, bebida diária com lactobacilos ou nenhuma bebida).Ambas variáveis, tratamento e resultado, são agrupados em categorias. O resultado é categórico aqui porque uma ou mais recorrências de ITU durante o período de seis meses constituem uma única categoria, “Recorrência”.Essa é uma tabela de dupla entrada porque descreve relação entre duas variáveis categóricas. Tratamento é variável linha, porque cada linha na tabela descreve mulheres que receberam um dos três tratamentos. Resultado é variável coluna, porque cada coluna descreve um possível resultado conforme classificado estudo. entradas na tabela são contagens de participantes estudo em cada classe de tratamento por resultado.estatística qui-quadrado é X2 = 7,29. O valor P é pequeno, cerca de 0,026.Há evidência bastante forte de que recorrência de ITU seja diferente conforme o tipo de bebida utilizada tratamento.Há menor recorrência em mulheres que beberam suco de uva--monte, pois recorrência para o Suco de uva--monte apresentou o maior valor de contribuição para o qui-quadrado (3,339). O valor esperado era de 15,1 recorrências, enquanto que foi observado um valor bem menor, de apenas 8 recorrências.","code":"\nBebida <- c(\"1.Suco de uva-do-monte\", \"2.Bebida de lactobacilos\", \"3.Nenhuma bebida\")\nITU <- rep(c(\"1.Recorrencia\", \"2.Sem recorrencia\"), e = 3)\nfreq1 <- c(8, 19, 18, 42, 30, 32)\ndf1 <- data.frame(Bebida, ITU, freq1)\ntab1 <- xtabs(freq1 ~ Bebida + ITU, data = df1)\n\ngmodels::CrossTable(tab1, expected = TRUE, prop.chisq = TRUE)## \n##  \n##    Cell Contents\n## |-------------------------|\n## |                       N |\n## |              Expected N |\n## | Chi-square contribution |\n## |           N / Row Total |\n## |           N / Col Total |\n## |         N / Table Total |\n## |-------------------------|\n## \n##  \n## Total Observations in Table:  149 \n## \n##  \n##                          | ITU \n##                   Bebida |     1.Recorrencia | 2.Sem recorrencia |         Row Total | \n## -------------------------|-------------------|-------------------|-------------------|\n##   1.Suco de uva-do-monte |                 8 |                42 |                50 | \n##                          |            15.101 |            34.899 |                   | \n##                          |             3.339 |             1.445 |                   | \n##                          |             0.160 |             0.840 |             0.336 | \n##                          |             0.178 |             0.404 |                   | \n##                          |             0.054 |             0.282 |                   | \n## -------------------------|-------------------|-------------------|-------------------|\n## 2.Bebida de lactobacilos |                19 |                30 |                49 | \n##                          |            14.799 |            34.201 |                   | \n##                          |             1.193 |             0.516 |                   | \n##                          |             0.388 |             0.612 |             0.329 | \n##                          |             0.422 |             0.288 |                   | \n##                          |             0.128 |             0.201 |                   | \n## -------------------------|-------------------|-------------------|-------------------|\n##         3.Nenhuma bebida |                18 |                32 |                50 | \n##                          |            15.101 |            34.899 |                   | \n##                          |             0.557 |             0.241 |                   | \n##                          |             0.360 |             0.640 |             0.336 | \n##                          |             0.400 |             0.308 |                   | \n##                          |             0.121 |             0.215 |                   | \n## -------------------------|-------------------|-------------------|-------------------|\n##             Column Total |                45 |               104 |               149 | \n##                          |             0.302 |             0.698 |                   | \n## -------------------------|-------------------|-------------------|-------------------|\n## \n##  \n## Statistics for All Table Factors\n## \n## \n## Pearson's Chi-squared test \n## ------------------------------------------------------------\n## Chi^2 =  7.290006     d.f. =  2     p =  0.02612133 \n## \n## \n## "},{"path":"dados-categóricos.html","id":"o-paradoxo-de-simpson","chapter":"Capítulo 13 Dados categóricos","heading":"13.1 O paradoxo de Simpson","text":"Como caso de variáveis quantitativas, os efeitos de variáveis ocultas podem mudar ou mesmo inverter relações entre duas variáveis categóricas. Aqui está um exemplo que demonstra surpresas com quais um usuário de dados desavisado pode se defrontar.Exemplo 13.2  (Helicópteros médicos salvam vidas?) Vítimas de acidentes são, algumas vezes, transportadas por helicóptero local acidente para um hospital. Helicópteros economizam tempo. Eles também salvam vidas?Vamos comparar os percentuais de vítimas de acidentes que morrem quando resgatadas por helicóptero e por transporte usual, por rodovia, e levadas um hospital. seguir, estão dados hipotéticos que ilustram uma dificuldade prática:Vemos que 32% (64 dentre 200) dos pacientes transportados por helicóptero morreram, comparados com apenas 24% (260 dentre 1100) dos outros. Essa estatística parece desencorajadora.explicação é que o helicóptero é enviado, na maior parte das vezes, para acidentes graves; logo, vítimas transportadas por helicópteros, com maior frequência, estão mais gravemente feridas que outras vítimas. Elas têm mais chance de morrer despeito tipo de transporte resgate.seguir, estão os mesmos dados decompostos segundo gravidade acidente.\nPrimeiro, para os acidentes graves:E para os acidentes menos graves:Entre vítimas de acidentes graves, o helicóptero salva 52% (52 dentre 100), comparadas 40% para transporte rodoviário.Se examinarmos apenas os acidentes de menor gravidade, 84% da vítimas transportadas por helicóptero sobrevivem versus 80% das transportadas por rodovia.Ambos os grupos de vítimas têm maior taxa de sobrevivência quando resgatados por helicóptero.Em princípio, parece paradoxal que o helicóptero seja melhor para ambos os grupos de vítimas, mas pior quando vítimas são consideradas em conjunto.gravidade acidente era uma variável oculta que, antes de ser revelada, escondia verdadeira relação entre sobrevivência e meio de transporte para um hospital.Uma associação ou comparação que vale para cada um de vários grupos pode ter sua direção invertida quando os dados são combinados para formar um grupo único. Essa inversão é chamada de paradoxo de Simpson.O exame cuidadoso dos dados fornece explicação. Metade dos pacientes transportados por helicóptero é de acidentes graves, comparada com apenas 100 dentre 1100 pacientes transportados por rodovia. Logo, o helicóptero conduz pacientes com mais chance de morrer.","code":"## \n##  \n##    Cell Contents\n## |-------------------------|\n## |                       N |\n## |           N / Col Total |\n## |-------------------------|\n## \n##  \n## Total Observations in Table:  1300 \n## \n##  \n##                  | transporte \n##           sobrev | 1.Helicóptero |     2.Rodovia |     Row Total | \n## -----------------|---------------|---------------|---------------|\n## 1.Não sobreviveu |            64 |           260 |           324 | \n##                  |         0.320 |         0.236 |               | \n## -----------------|---------------|---------------|---------------|\n##     2.Sobreviveu |           136 |           840 |           976 | \n##                  |         0.680 |         0.764 |               | \n## -----------------|---------------|---------------|---------------|\n##     Column Total |           200 |          1100 |          1300 | \n##                  |         0.154 |         0.846 |               | \n## -----------------|---------------|---------------|---------------|\n## \n## ## \n##  \n##    Cell Contents\n## |-------------------------|\n## |                       N |\n## |           N / Col Total |\n## |-------------------------|\n## \n##  \n## Total Observations in Table:  200 \n## \n##  \n##                  | transporte \n##           sobrev | 1.Helicóptero |     2.Rodovia |     Row Total | \n## -----------------|---------------|---------------|---------------|\n## 1.Não sobreviveu |            48 |            60 |           108 | \n##                  |         0.480 |         0.600 |               | \n## -----------------|---------------|---------------|---------------|\n##     2.Sobreviveu |            52 |            40 |            92 | \n##                  |         0.520 |         0.400 |               | \n## -----------------|---------------|---------------|---------------|\n##     Column Total |           100 |           100 |           200 | \n##                  |         0.500 |         0.500 |               | \n## -----------------|---------------|---------------|---------------|\n## \n## ## \n##  \n##    Cell Contents\n## |-------------------------|\n## |                       N |\n## |           N / Col Total |\n## |-------------------------|\n## \n##  \n## Total Observations in Table:  1100 \n## \n##  \n##                  | transporte \n##           sobrev | 1.Helicóptero |     2.Rodovia |     Row Total | \n## -----------------|---------------|---------------|---------------|\n## 1.Não sobreviveu |            16 |           200 |           216 | \n##                  |         0.160 |         0.200 |               | \n## -----------------|---------------|---------------|---------------|\n##     2.Sobreviveu |            84 |           800 |           884 | \n##                  |         0.840 |         0.800 |               | \n## -----------------|---------------|---------------|---------------|\n##     Column Total |           100 |          1000 |          1100 | \n##                  |         0.091 |         0.909 |               | \n## -----------------|---------------|---------------|---------------|\n## \n## "},{"path":"conjunto-de-dados-do-r.html","id":"conjunto-de-dados-do-r","chapter":"Apêndice A Conjunto de dados do R","heading":"Apêndice A Conjunto de dados do R","text":"Existe uma variedade de base de dados (datasets) incluídos com o R. Segue uma breve descrição de alguns destes datasets que serão utilizados neste curso.","code":""},{"path":"conjunto-de-dados-do-r.html","id":"gapminder","chapter":"Apêndice A Conjunto de dados do R","heading":"A.1 gapminder","text":"Este conjunto de dados contém um recorte dos dados Instituto Gapminder. São 1704 linhas com 6 variáveis:country: país, com 142 níveiscontinent: continente, com 5 níveisyear: ano, entre 1952 e 2007 com incremente de 5 anoslifeExp: expectativa de vida ao nascer, em anospop: populaçãogdpPercap: PIB per capita, em US Dollar (ajustado para inflação)Para acessá-lo, antes é preciso instalar o pacote gapminder e carregá-lo.","code":"\ninstall.packages(\"gapminder\")\nlibrary(gapminder)"},{"path":"conjunto-de-dados-do-r.html","id":"mpg","chapter":"Apêndice A Conjunto de dados do R","heading":"A.2 mpg","text":"Este conjunto de dados é parte pacote ggplot2 e contém dados relacionados à economia de combustível (https://fueleconomy.gov/) de 38 modelos de carros nos anos de 1999 e 2008. São 234 linhas com 11 variáveis:manufacturer: nome da montadoramodel: nome modelodispl: cilindrada motor, em litrosyear: ano de fabricaçãocyl: número de cilindrostrans: tipo de transmissãodrv: tipo de tração, em que f = tração dianteira, r = tração traseira, 4 = tração 4x4cty: consumo na cidade em milhas por galãohwy: consumo na rodovia milhas por galãofl: tipo de combustívelclass: categoria carroPara acessá-lo, é preciso ter o pacote ggplot2 instalado e carregado.","code":"\ninstall.packages(\"ggplot2\") #caso não esteja instalado\nlibrary(ggplot2)"},{"path":"conjunto-de-dados-do-r.html","id":"tooth","chapter":"Apêndice A Conjunto de dados do R","heading":"A.3 ToothGrowth","text":"Este conjunto contém dados de um experimento em que foi medido o comprimento de odontoblastos (células responsáveis pelo crescimento dos dentes) em 60 porquinhos da Índia 32. Cada animal recebeu uma dose diferente de vitamina C (0,5, 1,0 ou 2,0 mg/dia) por um tipo de suplemento: suco de laranja (OJ) ou ácido ascórbico (VC). São 60 linhas com 3 variáveis:len: comprimento de odontoblastossupp: tipo de suplemento de vitamina Cdose: dose de vitamina C","code":""},{"path":"conjunto-de-dados-do-r.html","id":"economics","chapter":"Apêndice A Conjunto de dados do R","heading":"A.4 economics","text":"Este conjunto de dados traz uma série temporal de dados econômicos dos Estados Unidos 33. São 574 linhas com 6 variáveisdate: Mês de aquisição dos dadospce: despesas de consumo pessoal, em bilhões de dólarespop: população total, em milharespsavert: taxa de poupança pessoaluempmed: duração mediana desemprego, em semanasunemploy: número de desempregados, em milhares","code":""},{"path":"conjunto-de-dados-do-r.html","id":"iris","chapter":"Apêndice A Conjunto de dados do R","heading":"A.5 iris","text":"Este dataset contém medidas, em centímetros, comprimento e largura das pétalas e sépalas de três espécies de plantas: Iris setosa, . versicolor e . virginica. São 150 linhas com 5 variáveis.Sepal.Length: comprimento das sépalasSepal.Width: largura das sépalasPetal.Length: comprimento das pétalasPetal.Width: largura das sépalasSpecies: espécies de Iris","code":""},{"path":"conjunto-de-dados-do-r.html","id":"bod","chapter":"Apêndice A Conjunto de dados do R","heading":"A.6 BOD","text":"Este dataset contém demanda bioquímica de oxigênio em função tempo em uma avaliação da qualidade da água.Time: tempo em diasdemand: BOD em mg/L","code":""},{"path":"conjunto-de-dados-do-r.html","id":"diamonds","chapter":"Apêndice A Conjunto de dados do R","heading":"A.7 diamonds","text":"Este conjunto de dados contém atributos de aproximadamento 54.000 diamantes. variáveis são:price: preço em dólarescarat: peso em quilatescut: qualidade corte (Razoável, Bom, Muito Bom, Premium, Ideal)color: cor diamante, de D (melhor) J (pior)clarity: uma medida de quão claro é o diamante (I1 (pior), SI2, SI1, VS2, VS1, VVS2, VVS1, (melhor))x: comprimento em mmy: largura em mmz: profundidade em mmdepth: porcentagem de profundidade total = z / média (x, y) = 2 * z / (x + y)table: largura topo diamante em relação ao ponto mais largo","code":"## Warning in instance$preRenderHook(instance): It seems your data is too big\n## for client-side DataTables. You may consider server-side processing: https://\n## rstudio.github.io/DT/server.html"},{"path":"conjunto-de-dados-do-r.html","id":"faithful","chapter":"Apêndice A Conjunto de dados do R","heading":"A.8 faithful","text":"Descreve o tempo entre erupções e duração das erupções gêiser Old Faithful Parque Yellowstone. São 272 observações de 2 variáveis.eruptions: duração da erupção, em minutoswaiting: tempo de epera até próxima erupção, em minutos","code":""}]
